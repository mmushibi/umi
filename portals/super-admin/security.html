<!DOCTYPE html>
<html lang="en" x-data="analytics()">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>System Analytics | UmiHealthInformationSystems Pharmacy Management</title>
  <link rel="icon" href="../../logo.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Glacial+Indifference:wght@400;500;600;700&family=Material+Symbols+Rounded:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/tailwind.output.css">
  <!-- Include API and Data Sync Services -->
  <script src="../shared/js/data-sync.js"></script>
  <script src="../shared/js/role-based-access.js"></script>
  <script src="../admin/js/admin-api.js"></script>
  <script src="js/super-admin-api.js"></script>
  <style>
    :root {
      --color-primary-blue: #2563EB;
      --color-accent-teal: #14B8A6;
      --color-text-white: #FFFFFF;
      --color-subtle-blue: #EFF6FF;
      --font-primary: 'Glacial Indifference', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: #0a0a0a;
      color: var(--color-text-white);
      font-family: 'Glacial Indifference', sans-serif;
      line-height: 1.5;
      min-height: 100vh;
      position: relative;
      background-image: 
        linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
    }

    /* Custom scrollbar styles */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* Firefox scrollbar */
    * {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.2) rgba(255, 255, 255, 0.05);
    }

    .dashboard-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 280px;
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      text-align: center;
    }

    .sidebar-title {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      color: var(--color-accent-teal);
    }

    .sidebar-menu {
      flex: 1;
      padding: 1rem 0;
      overflow-y: auto;
    }

    .menu-section {
      margin-bottom: 2rem;
    }

    .menu-title {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      opacity: 0.6;
      padding: 0 1.5rem;
      margin-bottom: 0.5rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      color: var(--color-text-white);
      text-decoration: none;
      transition: all 0.3s ease;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .menu-item:hover {
      background: rgba(255, 255, 255, 0.1);
      opacity: 1;
    }

    .menu-item.active {
      background: rgba(20, 184, 166, 0.2);
      border-left: 3px solid var(--color-accent-teal);
      opacity: 1;
    }

    .menu-icon {
      font-size: 1.25rem;
      color: var(--color-accent-teal);
    }

    .sidebar-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Main Content Area */
    .main-content {
      flex: 1;
      margin-left: 280px;
      display: flex;
      flex-direction: column;
    }

    /* Header Styles */
    .header {
      height: 70px;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      position: sticky;
      top: 0;
      z-index: 999;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .header-logo {
      display: flex;
      align-items: center;
    }

    .header-logo img {
      width: 100px;
      height: 100px;
      object-fit: contain;
    }

    .page-title {
      font-size: 1.5rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .user-menu:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .user-avatar {
      width: 35px;
      height: 35px;
      background: var(--color-accent-teal);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
    }

    .user-info {
      display: flex;
      flex-direction: column;
    }

    .user-name {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .user-role {
      font-size: 0.75rem;
      opacity: 0.8;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .search-container {
      position: relative;
      width: 350px;
    }

    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .search-container .search-input {
      width: 100%;
      padding: 0.75rem 1rem 0.75rem 2.5rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      transition: all 0.3s ease;
    }

    .search-container .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-container .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--color-accent-teal);
      box-shadow: 0 0 0 2px rgba(20, 184, 166, 0.2);
    }

    .search-icon {
      position: absolute;
      left: 0.75rem;
      color: rgba(255, 255, 255, 0.6);
      font-size: 1.2rem;
      pointer-events: none;
    }

    .search-suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      margin-top: 0.5rem;
      max-height: 400px;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .suggestion-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .suggestion-item:last-child {
      border-bottom: none;
    }

    .suggestion-item:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .suggestion-icon {
      width: 40px;
      height: 40px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: var(--color-accent-teal);
    }

    .suggestion-content {
      flex: 1;
    }

    .suggestion-title {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.25rem;
    }

    .suggestion-description {
      font-size: 0.8rem;
      opacity: 0.7;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .suggestion-type {
      padding: 0.25rem 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      text-transform: uppercase;
    }

    /* Content Area */
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }

    /* Analytics Cards */
    .analytics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .analytics-card {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .card-title {
      font-size: 1.1rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .card-icon {
      font-size: 1.5rem;
      color: var(--color-accent-teal);
    }

    .card-value {
      font-size: 2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.5rem;
    }

    .card-change {
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .change-positive {
      color: #10B981;
    }

    .change-negative {
      color: #FCA5A5;
    }

    /* Chart Container */
    .chart-container {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      min-height: 400px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .chart-placeholder {
      text-align: center;
      opacity: 0.7;
    }

    .chart-icon {
      font-size: 3rem;
      color: var(--color-accent-teal);
      margin-bottom: 1rem;
    }

    /* Mobile Responsiveness */
    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      color: var(--color-text-white);
      font-size: 1.5rem;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .header {
        padding: 0 1rem;
      }

      .content {
        padding: 1rem;
      }

      .analytics-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>

    <!-- Backend Integration Libraries -->
    <script src="../../js/api-client.js"></script>
    <script src="../../js/auth-manager.js"></script>
    <script src="../shared/js/backend-integration-helper.js"></script>
    <script src="../shared/js/page-integration-template.js"></script>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" :class="{ 'open': mobileMenuOpen }">
      <div class="sidebar-header">
        <div class="sidebar-title">Umi Admin</div>
      </div>
      
      <nav class="sidebar-menu">
        <div class="menu-section">
          <div class="menu-title">Main</div>
          <a href="home.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">dashboard</span>
            Home
          </a>
          <a href="pharmacies.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">store</span>
            Pharmacies
          </a>
          <a href="users.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">people</span>
            Users
          </a>
          <a href="transactions.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">receipt_long</span>
            Transactions
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Management</div>
          <a href="analytics.html" class="menu-item active">
            <span class="material-symbols-rounded menu-icon">analytics</span>
            Analytics
          </a>
          <a href="reports.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">assessment</span>
            Reports
          </a>
          <a href="settings.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">account_circle</span>
            Account
          </a>
          <a href="security.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">security</span>
            Security
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Support</div>
          <a href="help.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">help_center</span>
            Help Center
          </a>
          <a href="logs.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">history</span>
            System Logs
          </a>
        </div>
      </nav>
      
      <div class="sidebar-footer">
        <a href="../../public/signin.html" class="menu-item" @click.prevent="handleLogout">
          <span class="material-symbols-rounded menu-icon">logout</span>
          Sign Out
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen">
            <span class="material-symbols-rounded">menu</span>
          </button>
          <div class="header-logo">
            <!-- Logo removed per request -->
          </div>
          <h1 class="page-title">System Analytics</h1>
        </div>
        
        <div class="header-right">
          <div class="search-container" x-data="searchComponent()">
            <div class="search-input-wrapper">
              <input 
                type="text" 
                class="search-input" 
                placeholder="Search pharmacies, users, transactions..."
                x-model="query"
                @input="handleSearch"
                @focus="showSuggestions = true"
                @blur="hideSuggestions"
              >
              <span class="material-symbols-rounded search-icon">search</span>
            </div>
            
            <!-- Search Suggestions Dropdown -->
            <div 
              class="search-suggestions" 
              x-show="showSuggestions && suggestions.length > 0"
              x-transition
            >
              <template x-for="suggestion in suggestions" :key="suggestion.id">
                <div class="suggestion-item" @click="selectSuggestion(suggestion)">
                  <div class="suggestion-icon">
                    <span class="material-symbols-rounded" x-text="suggestion.icon"></span>
                  </div>
                  <div class="suggestion-content">
                    <div class="suggestion-title" x-text="suggestion.title"></div>
                    <div class="suggestion-description" x-text="suggestion.description"></div>
                  </div>
                  <div class="suggestion-type" x-text="suggestion.type"></div>
                </div>
              </template>
            </div>
          </div>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content">
        <!-- Analytics Overview -->
        <div class="analytics-grid">
          <div class="analytics-card">
            <div class="card-header">
              <div class="card-title">Total Revenue</div>
              <span class="material-symbols-rounded card-icon">trending_up</span>
            </div>
            <div class="card-value">K0</div>
            <div class="card-change change-positive">+0% from last month</div>
          </div>
          
          <div class="analytics-card">
            <div class="card-header">
              <div class="card-title">Active Users</div>
              <span class="material-symbols-rounded card-icon">people</span>
            </div>
            <div class="card-value">0</div>
            <div class="card-change change-positive">+0% from last month</div>
          </div>
          
          <div class="analytics-card">
            <div class="card-header">
              <div class="card-title">Transactions</div>
              <span class="material-symbols-rounded card-icon">receipt_long</span>
            </div>
            <div class="card-value">0</div>
            <div class="card-change change-negative">-0% from last month</div>
          </div>
          
          <div class="analytics-card">
            <div class="card-header">
              <div class="card-title">Active Pharmacies</div>
              <span class="material-symbols-rounded card-icon">store</span>
            </div>
            <div class="card-value">0</div>
            <div class="card-change change-positive">+0% from last month</div>
          </div>
        </div>

        <!-- Revenue Chart -->
        <div class="chart-container">
          <div class="chart-placeholder">
            <div class="chart-icon">
              <span class="material-symbols-rounded">bar_chart</span>
            </div>
            <div>Revenue Analytics Chart</div>
            <div style="font-size: 0.9rem; opacity: 0.6; margin-top: 0.5rem;">
              Chart integration coming soon
            </div>
          </div>
        </div>

        <!-- User Growth Chart -->
        <div class="chart-container">
          <div class="chart-placeholder">
            <div class="chart-icon">
              <span class="material-symbols-rounded">show_chart</span>
            </div>
            <div>User Growth Analytics</div>
            <div style="font-size: 0.9rem; opacity: 0.6; margin-top: 0.5rem;">
              Chart integration coming soon
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    function searchComponent() {
      return {
        // Initialize backend integration
        const pageIntegration = new PageIntegrationTemplate('super-admin-analytics', {
            requireAuth: true,
            enableRealTime: false,
            enableCaching: true
        });
        
        return {
            ...pageIntegration,
            backendHelper: window.backendHelper,
            apiClient: window.apiClient,
            authManager: window.authManager,
            isAuthenticated: false,
            loading: false,
            error: null,
        query: '',
        showSuggestions: false,
        suggestions: [],
        allSuggestions: [
          { id: 1, title: 'Pharmacies', description: 'Manage pharmacy tenants', type: 'page', icon: 'store', url: 'pharmacies.html' },
          { id: 2, title: 'Users', description: 'User management', type: 'page', icon: 'people', url: 'users.html' },
          { id: 3, title: 'Transactions', description: 'Transaction history', type: 'page', icon: 'receipt_long', url: 'transactions.html' },
          { id: 4, title: 'Analytics', description: 'System analytics', type: 'page', icon: 'analytics', url: 'analytics.html' },
          { id: 5, title: 'Reports', description: 'Reports & insights', type: 'page', icon: 'assessment', url: 'reports.html' },
          { id: 6, title: 'Security', description: 'Security center', type: 'page', icon: 'security', url: 'security.html' },
          { id: 7, title: 'Settings', description: 'Account & system settings', type: 'page', icon: 'settings', url: 'settings.html' },
          { id: 8, title: 'Help Center', description: 'Support and documentation', type: 'page', icon: 'help_center', url: 'help.html' },
          { id: 9, title: 'System Logs', description: 'System activity logs', type: 'page', icon: 'history', url: 'logs.html' }
        ],

        handleSearch() {
          const q = (this.query || '').trim().toLowerCase();
          if (q.length < 2) {
            this.suggestions = [];
            return;
          }

          this.suggestions = this.allSuggestions
            .filter(s =>
              (s.title && s.title.toLowerCase().includes(q)) ||
              (s.description && s.description.toLowerCase().includes(q)) ||
              (s.type && s.type.toLowerCase().includes(q))
            )
            .slice(0, 8);
        },

        selectSuggestion(suggestion) {
          this.query = suggestion.title;
          this.showSuggestions = false;
          if (suggestion && suggestion.url) {
            window.location.href = suggestion.url;
          }
        },

        hideSuggestions() {
          setTimeout(() => {
            this.showSuggestions = false;
          }, 200);
        }
      }
    }

    function analytics() {
      return {
        userName: '',
        userEmail: '',
        mobileMenuOpen: false,
        showUserMenu: false,

        async init() {
            try {
                // Check authentication
                this.isAuthenticated = this.authManager?.isAuthenticated() || false;
                
                if (!this.isAuthenticated) {
                    this.error = 'Please login to access this page';
                    return;
                }
                
                // Initialize backend integration
                await this.backendHelper.initPage('super-admin-analytics', {
                    enableRealTime: false,
                    initialData: this.getInitialDataConfig()
                });
                
                // Load page data
                await this.loadPageData();
                
                // Set up event listeners
                this.setupEventListeners();
                
                console.log('super-admin-analytics page initialized with backend integration');
            } catch (error) {
                console.error('Failed to initialize super-admin-analytics page:', error);
                this.error = 'Failed to initialize page';
            }
        },
            if (!e.target.closest('.user-menu')) {
              this.showUserMenu = false;
            }
          });
        },

        async loadAnalytics() {
          try {
            const data = await window.superAdminDataSync.getAnalytics({
              startDate: this.startDate,
              endDate: this.endDate,
              period: this.period
            });
            this.analyticsData = data.data || [];
            this.updateCharts();
          } catch (error) {
            console.error('Error loading analytics:', error);
            this.showError('Failed to load analytics data');
          }
        },

        async generateAnalytics() {
          try {
            const data = await window.superAdminDataSync.generateAnalytics(new Date());
            this.showSuccess('Analytics data generated successfully');
            this.loadAnalytics();
          } catch (error) {
            this.showError('Failed to generate analytics');
          }
        },

        async exportAnalytics() {
          try {
            await window.superAdminDataSync.exportSystemData('analytics', {
              startDate: this.startDate,
              endDate: this.endDate,
              period: this.period
            });
            this.showSuccess('Analytics data exported successfully');
          } catch (error) {
            this.showError('Failed to export analytics');
          }
        },

        updateCharts() {
          // Update chart visualizations with analytics data
          console.log('Updating charts with:', this.analyticsData);
        },

        showError(message) {
          if (window.showToast) {
            window.showToast(message, 'error');
          } else {
            alert(message);
          }
        },

        showSuccess(message) {
          if (window.showToast) {
            window.showToast(message, 'success');
          }
        },

        handleLogout() {
          if (confirm('Are you sure you want to sign out?')) {
            // Clear session
            sessionStorage.clear();
            
            // Redirect to signin
            window.location.href = '../../public/signin.html';
          }
        }
      }
    }
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script></body>
</html>




<!DOCTYPE html>
<html lang="en" x-data="help()">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Help Center | UmiHealthInformationSystems Pharmacy Management</title>
  <link rel="icon" href="../../logo.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Glacial+Indifference:wght@400;500;600;700&family=Material+Symbols+Rounded:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/tailwind.output.css">
  <style>
    :root {
      --color-primary-blue: #2563EB;
      --color-accent-teal: #14B8A6;
      --color-text-white: #FFFFFF;
      --color-subtle-blue: #EFF6FF;
      --font-primary: 'Glacial Indifference', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: #0a0a0a;
      color: var(--color-text-white);
      font-family: 'Glacial Indifference', sans-serif;
      line-height: 1.5;
      min-height: 100vh;
      position: relative;
      background-image: 
        linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
    }

    /* Custom scrollbar styles */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* Firefox scrollbar */
    * {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.2) rgba(255, 255, 255, 0.05);
    }

    /* Fallback for browsers that don't support scrollbar styling */
    *::-webkit-scrollbar {
      width: 8px;
    }
    
    *::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }
    
    *::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }
    
    *::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .dashboard-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 280px;
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      text-align: center;
    }

    .sidebar-title {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      color: var(--color-accent-teal);
    }

    .sidebar-menu {
      flex: 1;
      padding: 1rem 0;
      overflow-y: auto;
    }

    .menu-section {
      margin-bottom: 2rem;
    }

    .menu-title {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      opacity: 0.6;
      padding: 0 1.5rem;
      margin-bottom: 0.5rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      color: var(--color-text-white);
      text-decoration: none;
      transition: all 0.3s ease;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .menu-item:hover {
      background: rgba(255, 255, 255, 0.1);
      opacity: 1;
    }

    .menu-item.active {
      background: rgba(20, 184, 166, 0.2);
      border-left: 3px solid var(--color-accent-teal);
      opacity: 1;
    }

    .menu-icon {
      font-size: 1.25rem;
      color: var(--color-accent-teal);
    }

    .sidebar-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Main Content Area */
    .main-content {
      flex: 1;
      margin-left: 280px;
      display: flex;
      flex-direction: column;
    }

    /* Header Styles */
    .header {
      height: 70px;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      position: sticky;
      top: 0;
      z-index: 999;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .header-logo {
      display: flex;
      align-items: center;
    }

    .header-logo img {
      width: 100px;
      height: 100px;
      object-fit: contain;
    }

    .page-title {
      font-size: 1.5rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .user-menu:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .user-avatar {
      width: 35px;
      height: 35px;
      background: var(--color-accent-teal);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
    }

    .user-info {
      display: flex;
      flex-direction: column;
    }

    .user-name {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .user-role {
      font-size: 0.75rem;
      opacity: 0.8;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .search-container {
      position: relative;
      width: 350px;
    }

    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .search-container .search-input {
      width: 100%;
      padding: 0.75rem 1rem 0.75rem 2.5rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      transition: all 0.3s ease;
    }

    .search-container .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-container .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--color-accent-teal);
      box-shadow: 0 0 0 2px rgba(20, 184, 166, 0.2);
    }

    .search-icon {
      position: absolute;
      left: 0.75rem;
      color: rgba(255, 255, 255, 0.6);
      font-size: 1.2rem;
      pointer-events: none;
    }

    .search-suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      margin-top: 0.5rem;
      max-height: 400px;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .suggestion-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .suggestion-item:last-child {
      border-bottom: none;
    }

    .suggestion-item:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .suggestion-icon {
      width: 40px;
      height: 40px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: var(--color-accent-teal);
    }

    .suggestion-content {
      flex: 1;
    }

    .suggestion-title {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.25rem;
    }

    .suggestion-description {
      font-size: 0.8rem;
      opacity: 0.7;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .suggestion-type {
      padding: 0.25rem 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      text-transform: uppercase;
    }

    /* Content Area */
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }

    /* Help Section */
    .help-container {
      max-width: 800px;
      margin: 0 auto;
    }

    .search-section {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      text-align: center;
    }

    .search-title {
      font-size: 1.5rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 1rem;
    }

    .search-input {
      width: 100%;
      max-width: 500px;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 1rem;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 1rem;
    }

    .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.5);
    }

    .help-categories {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .category-card {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .category-card:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-2px);
    }

    .category-icon {
      width: 50px;
      height: 50px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: var(--color-accent-teal);
      margin-bottom: 1rem;
    }

    .category-title {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.5rem;
    }

    .category-description {
      opacity: 0.8;
    }

    .contact-section {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 2rem;
      text-align: center;
    }

    .contact-title {
      font-size: 1.3rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 1rem;
    }

    .contact-info {
      display: flex;
      justify-content: center;
      gap: 2rem;
      flex-wrap: wrap;
    }

    .contact-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-size: 0.9rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-primary {
      background: var(--color-accent-teal);
      color: white;
    }

    .btn-primary:hover {
      background: #0d9486;
      transform: translateY(-2px);
    }

    /* Mobile Responsiveness */
    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      color: var(--color-text-white);
      font-size: 1.5rem;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .header {
        padding: 0 1rem;
      }

      .content {
        padding: 1rem;
      }

      .help-categories {
        grid-template-columns: 1fr;
      }

      .contact-info {
        flex-direction: column;
        gap: 1rem;
      }
    }
  </style>

    <!-- Backend Integration Libraries -->
    <script src="../../js/api-client.js"></script>
    <script src="../../js/auth-manager.js"></script>
    <script src="../shared/js/backend-integration-helper.js"></script>
    <script src="../shared/js/page-integration-template.js"></script>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" :class="{ 'open': mobileMenuOpen }">
      <div class="sidebar-header">
        <div class="sidebar-title">Umi Admin</div>
      </div>
      
      <nav class="sidebar-menu">
        <div class="menu-section">
          <div class="menu-title">Main</div>
          <a href="home.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">dashboard</span>
            Home
          </a>
          <a href="pharmacies.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">store</span>
            Pharmacies
          </a>
          <a href="users.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">people</span>
            Users
          </a>
          <a href="transactions.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">receipt_long</span>
            Transactions
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Management</div>
          <a href="analytics.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">analytics</span>
            Analytics
          </a>
          <a href="reports.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">assessment</span>
            Reports
          </a>
          <a href="settings.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">account_circle</span>
            Account
          </a>
          <a href="security.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">security</span>
            Security
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Support</div>
          <a href="help.html" class="menu-item active">
            <span class="material-symbols-rounded menu-icon">help_center</span>
            Help Center
          </a>
          <a href="logs.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">history</span>
            System Logs
          </a>
        </div>
      </nav>
      
      <div class="sidebar-footer">
        <a href="../../public/signin.html" class="menu-item" @click.prevent="handleLogout">
          <span class="material-symbols-rounded menu-icon">logout</span>
          Sign Out
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen">
            <span class="material-symbols-rounded">menu</span>
          </button>
          <div class="header-logo">
            <!-- Logo removed per request -->
          </div>
          <h1 class="page-title">Help Center</h1>
        </div>
        
        <div class="header-right">
          <div class="search-container" x-data="searchComponent()">
            <div class="search-input-wrapper">
              <input 
                type="text" 
                class="search-input" 
                placeholder="Search pharmacies, users, transactions..."
                x-model="query"
                @input="handleSearch"
                @focus="showSuggestions = true"
                @blur="hideSuggestions"
              >
              <span class="material-symbols-rounded search-icon">search</span>
            </div>
            
            <!-- Search Suggestions Dropdown -->
            <div 
              class="search-suggestions" 
              x-show="showSuggestions && suggestions.length > 0"
              x-transition
            >
              <template x-for="suggestion in suggestions" :key="suggestion.id">
                <div class="suggestion-item" @click="selectSuggestion(suggestion)">
                  <div class="suggestion-icon">
                    <span class="material-symbols-rounded" x-text="suggestion.icon"></span>
                  </div>
                  <div class="suggestion-content">
                    <div class="suggestion-title" x-text="suggestion.title"></div>
                    <div class="suggestion-description" x-text="suggestion.description"></div>
                  </div>
                  <div class="suggestion-type" x-text="suggestion.type"></div>
                </div>
              </template>
            </div>
          </div>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content">
        <div class="help-container">
          <!-- Search Section -->
          <div class="search-section">
            <div class="search-title">How can we help you?</div>
            <input 
              type="text" 
              class="search-input" 
              placeholder="Search for help articles, tutorials, and documentation..."
              x-model="searchQuery"
            >
            <button class="btn btn-primary" @click="searchHelp">
              <span class="material-symbols-rounded">search</span>
              Search
            </button>
          </div>

          <!-- Help Categories -->
          <div class="help-categories">
            <div class="category-card" @click="openCategory('getting-started')">
              <div class="category-icon">
                <span class="material-symbols-rounded">rocket_launch</span>
              </div>
              <div class="category-title">Getting Started</div>
              <div class="category-description">
                Learn the basics of UmiHealthInformationSystems Pharmacy Management System
              </div>
            </div>

            <div class="category-card" @click="openCategory('user-guide')">
              <div class="category-icon">
                <span class="material-symbols-rounded">menu_book</span>
              </div>
              <div class="category-title">User Guide</div>
              <div class="category-description">
                Comprehensive guide for all system features and functions
              </div>
            </div>

            <div class="category-card" @click="openCategory('troubleshooting')">
              <div class="category-icon">
                <span class="material-symbols-rounded">build</span>
              </div>
              <div class="category-title">Troubleshooting</div>
              <div class="category-description">
                Common issues and their solutions
              </div>
            </div>

            <div class="category-card" @click="openCategory('api-docs')">
              <div class="category-icon">
                <span class="material-symbols-rounded">code</span>
              </div>
              <div class="category-title">API Documentation</div>
              <div class="category-description">
                Developer resources and API integration guides
              </div>
            </div>

            <div class="category-card" @click="openCategory('tutorials')">
              <div class="category-icon">
                <span class="material-symbols-rounded">video_library</span>
              </div>
              <div class="category-title">Video Tutorials</div>
              <div class="category-description">
                Step-by-step video guides for system features
              </div>
            </div>

            <div class="category-card" @click="openCategory('faq')">
              <div class="category-icon">
                <span class="material-symbols-rounded">help</span>
              </div>
              <div class="category-title">FAQ</div>
              <div class="category-description">
                Frequently asked questions and answers
              </div>
            </div>
          </div>

          <!-- Contact Section -->
          <div class="contact-section">
            <div class="contact-title">Still need help?</div>
            <div class="contact-info">
              <div class="contact-item">
                <span class="material-symbols-rounded">email</span>
                <span>support@UmiHealthInformationSystems.zm</span>
              </div>
              <div class="contact-item">
                <span class="material-symbols-rounded">phone</span>
                <span>+260 977 123 456</span>
              </div>
              <div class="contact-item">
                <span class="material-symbols-rounded">schedule</span>
                <span>Mon-Fri, 8AM-5PM CAT</span>
              </div>
            </div>
            <button class="btn btn-primary" @click="openSupport" style="margin-top: 1.5rem;">
              <span class="material-symbols-rounded">support_agent</span>
              Contact Support
            </button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    function searchComponent() {
      return {
        // Initialize backend integration
        const pageIntegration = new PageIntegrationTemplate('super-admin-help', {
            requireAuth: true,
            enableRealTime: false,
            enableCaching: true
        });
        
        return {
            ...pageIntegration,
            backendHelper: window.backendHelper,
            apiClient: window.apiClient,
            authManager: window.authManager,
            isAuthenticated: false,
            loading: false,
            error: null,
        query: '',
        showSuggestions: false,
        suggestions: [],
        allSuggestions: [
          { id: 1, title: 'Pharmacies', description: 'Manage pharmacy tenants', type: 'page', icon: 'store', url: 'pharmacies.html' },
          { id: 2, title: 'Users', description: 'User management', type: 'page', icon: 'people', url: 'users.html' },
          { id: 3, title: 'Transactions', description: 'Transaction history', type: 'page', icon: 'receipt_long', url: 'transactions.html' },
          { id: 4, title: 'Analytics', description: 'System analytics', type: 'page', icon: 'analytics', url: 'analytics.html' },
          { id: 5, title: 'Reports', description: 'Reports & insights', type: 'page', icon: 'assessment', url: 'reports.html' },
          { id: 6, title: 'Security', description: 'Security center', type: 'page', icon: 'security', url: 'security.html' },
          { id: 7, title: 'Settings', description: 'Account & system settings', type: 'page', icon: 'settings', url: 'settings.html' },
          { id: 8, title: 'Help Center', description: 'Support and documentation', type: 'page', icon: 'help_center', url: 'help.html' },
          { id: 9, title: 'System Logs', description: 'System activity logs', type: 'page', icon: 'history', url: 'logs.html' }
        ],

        handleSearch() {
          const q = (this.query || '').trim().toLowerCase();
          if (q.length < 2) {
            this.suggestions = [];
            return;
          }

          this.suggestions = this.allSuggestions
            .filter(s =>
              (s.title && s.title.toLowerCase().includes(q)) ||
              (s.description && s.description.toLowerCase().includes(q)) ||
              (s.type && s.type.toLowerCase().includes(q))
            )
            .slice(0, 8);
        },

        selectSuggestion(suggestion) {
          this.query = suggestion.title;
          this.showSuggestions = false;
          if (suggestion && suggestion.url) {
            window.location.href = suggestion.url;
          }
        },

        hideSuggestions() {
          setTimeout(() => {
            this.showSuggestions = false;
          }, 200);
        }
      }
    }

    function help() {
      return {
        userName: '',
        userEmail: '',
        mobileMenuOpen: false,
        showUserMenu: false,
        searchQuery: '',

        async init() {
            try {
                // Check authentication
                this.isAuthenticated = this.authManager?.isAuthenticated() || false;
                
                if (!this.isAuthenticated) {
                    this.error = 'Please login to access this page';
                    return;
                }
                
                // Initialize backend integration
                await this.backendHelper.initPage('super-admin-help', {
                    enableRealTime: false,
                    initialData: this.getInitialDataConfig()
                });
                
                // Load page data
                await this.loadPageData();
                
                // Set up event listeners
                this.setupEventListeners();
                
                console.log('super-admin-help page initialized with backend integration');
            } catch (error) {
                console.error('Failed to initialize super-admin-help page:', error);
                this.error = 'Failed to initialize page';
            }
        },
            if (!e.target.closest('.user-menu')) {
              this.showUserMenu = false;
            }
          });
        },

        searchHelp() {
          console.log('Searching for:', this.searchQuery);
          alert(`Search results for "${this.searchQuery}" coming soon!`);
        },

        openCategory(category) {
          console.log('Opening category:', category);
          alert(`${category.replace('-', ' ').charAt(0).toUpperCase() + category.replace('-', ' ').slice(1)} section coming soon!`);
        },

        openSupport() {
          console.log('Opening support ticket system...');
          alert('Support ticket system coming soon!');
        },

        handleLogout() {
          if (confirm('Are you sure you want to sign out?')) {
            // Clear session
            sessionStorage.clear();
            
            // Redirect to signin
            window.location.href = '../../public/signin.html';
          }
        }
      }
    }
  </script>

  <!-- Include API and Data Sync Services -->
  <script src="../shared/js/data-sync.js"></script>
  <script src="../shared/js/role-based-access.js"></script>
  <script src="../admin/js/admin-api.js"></script>
  <script src="js/super-admin-api.js"></script>

  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script></body>
</html>




<!DOCTYPE html>
<html lang="en" x-data="superAdmin()">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Super Admin Dashboard | UmiHealthInformationSystems Pharmacy Management</title>
  <link rel="icon" href="../../logo.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Glacial+Indifference:wght@400;500;600;700&family=Material+Symbols+Rounded:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/tailwind.output.css">
  <!-- Include API and Data Sync Services -->
  <script src="../shared/js/data-sync.js"></script>
  <script src="../shared/js/role-based-access.js"></script>
  <script src="../shared/js/super-admin-data-sync.js"></script>
  <script src="../shared/js/realtime-sync.js"></script>
  <script src="../admin/js/admin-api.js"></script>
  <style>
    :root {
      --color-primary-blue: #2563EB;
      --color-accent-teal: #14B8A6;
      --color-text-white: #FFFFFF;
      --color-subtle-blue: #EFF6FF;
      --font-primary: 'Inter', sans-serif;
    }
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      background: #0a0a0a;
      color: var(--color-text-white);
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 13px;
      line-height: 1.4;
      min-height: 100vh;
      position: relative;
      background-image: 
        linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
    }
    /* Custom scrollbar styles */
    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }
    /* Firefox scrollbar */
    @supports (scrollbar-width: thin) {
      * {
        scrollbar-width: thin;
        scrollbar-color: rgba(255, 255, 255, 0.2) rgba(255, 255, 255, 0.05);
      }
    }
    .dashboard-container {
      display: flex;
      min-height: 100vh;
    }
    /* Sidebar Styles */
    .sidebar {
      width: 280px;
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
      z-index: 1000;
    }
    .sidebar-header {
      padding: 1.25rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      text-align: center;
    }
    .sidebar-title {
      font-size: 1rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      color: var(--color-accent-teal);
    }
    .sidebar-search {
      display: none;
      padding: 0.75rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }
    .sidebar-search .search-container {
      width: 100%;
    }
    .sidebar-menu {
      flex: 1;
      padding: 0.75rem 0;
      overflow-y: auto;
    }
    .menu-section {
      margin-bottom: 1.5rem;
    }
    .menu-title {
      font-size: 0.625rem;
      font-weight: 600;
      text-transform: uppercase;
      opacity: 0.6;
      padding: 0 1.25rem;
      margin-bottom: 0.375rem;
      font-family: 'Glacial Indifference', sans-serif;
    }
    .menu-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1.25rem;
      color: var(--color-text-white);
      text-decoration: none;
      transition: all 0.3s ease;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.8rem;
      opacity: 0.8;
    }
    .menu-item:hover {
      background: rgba(255, 255, 255, 0.1);
      opacity: 1;
    }
    .menu-item.active {
      background: rgba(20, 184, 166, 0.2);
      border-left: 3px solid var(--color-accent-teal);
      opacity: 1;
    }
    .menu-icon {
      font-size: 1rem;
      color: var(--color-accent-teal);
    }
    .sidebar-footer {
      padding: 0.75rem 1.25rem;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }
    /* Main Content Area */
    .main-content {
      flex: 1;
      margin-left: 280px;
      display: flex;
      flex-direction: column;
    }
    /* Header Styles */
    .header {
      height: 60px;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 1.5rem;
      position: sticky;
      top: 0;
      z-index: 999;
    }
    .header-left {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }
    .header-logo {
      display: flex;
      align-items: center;
    }
    .header-logo img {
      width: 80px;
      height: 80px;
      object-fit: contain;
    }
    .header-brand {
      font-size: 1rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      color: var(--color-accent-teal);
    }
    .page-title {
      font-size: 1.25rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
    }
    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    .user-menu {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .user-menu:hover {
      background: rgba(255, 255, 255, 0.15);
    }
    .user-avatar {
      width: 35px;
      height: 35px;
      background: var(--color-accent-teal);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
    }
    .user-info {
      display: flex;
      flex-direction: column;
    }
    .user-name {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }
    .user-role {
      font-size: 0.75rem;
      opacity: 0.8;
      font-family: 'Glacial Indifference', sans-serif;
    }
    /* Search Container Styles */
    .search-container {
      position: relative;
      width: 400px;
    }
    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }
    .search-input {
      width: 100%;
      padding: 0.75rem 1rem 0.75rem 2.5rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      transition: all 0.3s ease;
    }
    .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }
    .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--color-accent-teal);
      box-shadow: 0 0 0 2px rgba(20, 184, 166, 0.2);
    }
    .search-icon {
      position: absolute;
      left: 0.75rem;
      color: rgba(255, 255, 255, 0.6);
      font-size: 1.2rem;
      pointer-events: none;
    }
    .search-suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      margin-top: 0.5rem;
      max-height: 400px;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }
    .suggestion-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    .suggestion-item:last-child {
      border-bottom: none;
    }
    .suggestion-item:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    .suggestion-icon {
      width: 40px;
      height: 40px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: var(--color-accent-teal);
    }
    .suggestion-content {
      flex: 1;
    }
    .suggestion-title {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.25rem;
    }
    .suggestion-description {
      font-size: 0.8rem;
      opacity: 0.7;
      font-family: 'Glacial Indifference', sans-serif;
    }
    .suggestion-type {
      padding: 0.25rem 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      text-transform: uppercase;
    }
    /* Content Area */
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }
    /* Dashboard Grid */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    .stat-card {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
      transition: all 0.3s ease;
    }
    .stat-card:hover {
      transform: translateY(-2px);
      background: rgba(255, 255, 255, 0.15);
    }
    .stat-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
    }
    .stat-icon {
      width: 45px;
      height: 45px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: var(--color-accent-teal);
    }
    .stat-trend {
      font-size: 0.8rem;
      font-weight: 600;
      padding: 0.25rem 0.5rem;
      border-radius: 6px;
      font-family: 'Glacial Indifference', sans-serif;
    }
    .trend-up {
      background: rgba(16, 185, 129, 0.2);
      color: #10B981;
    }
    .trend-down {
      background: rgba(244, 76, 76, 0.2);
      color: #FCA5A5;
    }
    .stat-number {
      font-size: 2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.5rem;
    }
    .stat-label {
      font-size: 0.9rem;
      opacity: 0.8;
      font-family: 'Glacial Indifference', sans-serif;
    }
    /* Quick Actions */
    .quick-actions {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 2rem;
    }
    .section-title {
      font-size: 1.25rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .actions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }
    .action-button {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      padding: 1rem;
      color: var(--color-text-white);
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      transition: all 0.3s ease;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
    }
    .action-button:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
    }
    .action-icon {
      font-size: 1.25rem;
      color: var(--color-accent-teal);
    }
    /* Recent Activity */
    .activity-feed {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
    }
    .activity-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    .activity-item:last-child {
      border-bottom: none;
    }
    .activity-icon {
      width: 35px;
      height: 35px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      color: var(--color-accent-teal);
    }
    .activity-content {
      flex: 1;
    }
    .activity-title {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.25rem;
    }
    .activity-description {
      font-size: 0.8rem;
      opacity: 0.8;
      font-family: 'Glacial Indifference', sans-serif;
    }
    .activity-time {
      font-size: 0.8rem;
      opacity: 0.6;
      font-family: 'Glacial Indifference', sans-serif;
    }
    /* Trial Status Styles */
    .trial-status-section {
      margin-bottom: 2rem;
    }
    .trial-status-card {
      background: linear-gradient(135deg, rgba(20, 184, 166, 0.1), rgba(37, 99, 235, 0.1));
      border: 1px solid rgba(20, 184, 166, 0.3);
      border-radius: 16px;
      padding: 1.5rem;
      transition: all 0.3s ease;
    }
    .trial-status-card.trial-expiring-soon {
      background: linear-gradient(135deg, rgba(251, 146, 60, 0.1), rgba(239, 68, 68, 0.1));
      border-color: rgba(251, 146, 60, 0.5);
    }
    .trial-status-card.trial-expired {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(127, 29, 29, 0.1));
      border-color: rgba(239, 68, 68, 0.5);
    }
    .trial-status-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .trial-status-icon {
      width: 48px;
      height: 48px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-accent-teal);
    }
    .trial-status-card.trial-expiring-soon .trial-status-icon {
      background: rgba(251, 146, 60, 0.2);
      color: #fb923c;
    }
    .trial-status-card.trial-expired .trial-status-icon {
      background: rgba(239, 68, 68, 0.2);
      color: #ef4444;
    }
    .trial-status-text {
      flex: 1;
    }
    .trial-status-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
      color: var(--color-text-white);
    }
    .trial-status-subtitle {
      font-size: 0.9rem;
      opacity: 0.8;
      color: var(--color-text-white);
    }
    .upgrade-button {
      background: var(--color-accent-teal);
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .upgrade-button:hover {
      background: #0d9488;
      transform: translateY(-1px);
    }
    .trial-progress-bar {
      width: 100%;
      height: 8px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 1rem;
    }
    .trial-progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--color-accent-teal), #10b981);
      border-radius: 4px;
      transition: width 0.3s ease;
    }
    .trial-status-card.trial-expiring-soon .trial-progress-fill {
      background: linear-gradient(90deg, #fb923c, #f97316);
    }
    .trial-status-card.trial-expired .trial-progress-fill {
      background: linear-gradient(90deg, #ef4444, #dc2626);
    }
    .trial-features {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    .trial-feature-badge {
      background: rgba(255, 255, 255, 0.1);
      color: var(--color-text-white);
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 500;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    /* Mobile Responsiveness */
    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      color: var(--color-text-white);
      font-size: 1.5rem;
      cursor: pointer;
    }
    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
        width: 280px;
      }
      .sidebar.open {
        transform: translateX(0);
      }
      .main-content {
        margin-left: 0;
      }
      .mobile-menu-toggle {
        display: block;
      }
      .header {
        padding: 0 1rem;
        justify-content: center;
        position: relative;
      }
      .header-left {
        gap: 1rem;
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
      }
      .header-logo {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
      }
      .header-logo img {
        width: 80px;
        height: 80px;
      }
      .page-title {
        display: none;
      }
      .header-right {
        display: none;
      }
      .sidebar-search {
        display: block;
        padding: 1rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      }
      .content {
        padding: 1rem;
      }
      .dashboard-grid {
        grid-template-columns: 1fr;
      }
      .actions-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>

    <!-- Backend Integration Libraries -->
    <script src="../../js/api-client.js"></script>
    <script src="../../js/auth-manager.js"></script>
    <script src="../shared/js/backend-integration-helper.js"></script>
    <script src="../shared/js/page-integration-template.js"></script>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" :class="{ 'open': mobileMenuOpen }">
      <div class="sidebar-header">
        <div class="sidebar-title">Umi Admin</div>
      </div>
      <!-- Mobile Search Bar -->
      <div class="sidebar-search">
        <div class="search-container" x-data="searchComponent()">
          <div class="search-input-wrapper">
            <input 
              type="text" 
              class="search-input" 
              placeholder="Search pharmacies, users, transactions..."
              x-model="query"
              @input="handleSearch"
              @focus="showSuggestions = true"
              @blur="hideSuggestions"
            >
            <span class="material-symbols-rounded search-icon">search</span>
          </div>
          <!-- Search Suggestions Dropdown -->
          <div 
            class="search-suggestions" 
            x-show="showSuggestions && suggestions.length > 0"
            x-transition
          >
            <template x-for="suggestion in suggestions" :key="suggestion.id">
              <div class="suggestion-item" @click="selectSuggestion(suggestion)">
                <div class="suggestion-icon">
                  <span class="material-symbols-rounded" x-text="suggestion.icon"></span>
                </div>
                <div class="suggestion-content">
                  <div class="suggestion-title" x-text="suggestion.title"></div>
                  <div class="suggestion-description" x-text="suggestion.description"></div>
                </div>
                <div class="suggestion-type" x-text="suggestion.type"></div>
              </div>
            </template>
          </div>
        </div>
      </div> 
      <nav class="sidebar-menu">
        <div class="menu-section">
          <div class="menu-title">Main</div>
          <a href="#" class="menu-item active" @click.prevent="setActiveMenu('dashboard')">
            <span class="material-symbols-rounded menu-icon">dashboard</span>
            Home
          </a>
          <a href="#" class="menu-item" @click.prevent="setActiveMenu('pharmacies')">
            <span class="material-symbols-rounded menu-icon">store</span>
            Pharmacies
          </a>
          <a href="#" class="menu-item" @click.prevent="setActiveMenu('users')">
            <span class="material-symbols-rounded menu-icon">people</span>
            Users
          </a>
          <a href="#" class="menu-item" @click.prevent="setActiveMenu('transactions')">
            <span class="material-symbols-rounded menu-icon">receipt_long</span>
            Transactions
          </a>
        </div>
        <div class="menu-section">
          <div class="menu-title">Management</div>
          <a href="#" class="menu-item" @click.prevent="setActiveMenu('analytics')">
            <span class="material-symbols-rounded menu-icon">analytics</span>
            Analytics
          </a>
          <a href="#" class="menu-item" @click.prevent="setActiveMenu('reports')">
            <span class="material-symbols-rounded menu-icon">assessment</span>
            Reports
          </a>
          <a href="#" class="menu-item" @click.prevent="setActiveMenu('settings')">
            <span class="material-symbols-rounded menu-icon">account_circle</span>
            Account
          </a>
          <a href="#" class="menu-item" @click.prevent="setActiveMenu('security')">
            <span class="material-symbols-rounded menu-icon">security</span>
            Security
          </a>
        </div>
        <div class="menu-section">
          <div class="menu-title">Support</div>
          <a href="#" class="menu-item" @click.prevent="setActiveMenu('help')">
            <span class="material-symbols-rounded menu-icon">help_center</span>
            Help Center
          </a>
          <a href="#" class="menu-item" @click.prevent="setActiveMenu('logs')">
            <span class="material-symbols-rounded menu-icon">history</span>
            System Logs
          </a>
        </div>
      </nav>
      <div class="sidebar-footer">
        <a href="../../public/signin.html" class="menu-item" @click.prevent="handleLogout">
          <span class="material-symbols-rounded menu-icon">logout</span>
          Sign Out
        </a>
      </div>
    </aside>
    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen">
            <span class="material-symbols-rounded">menu</span>
          </button>
          <div class="header-logo">
            <!-- Logo removed per request -->
          </div>
          <h1 class="page-title">Dashboard Overview</h1>
        </div>
        <div class="header-right">
          <div class="search-container" x-data="searchComponent()">
            <div class="search-input-wrapper">
              <input 
                type="text" 
                class="search-input" 
                placeholder="Search pharmacies, users, transactions..."
                x-model="query"
                @input="handleSearch"
                @focus="showSuggestions = true"
                @blur="hideSuggestions"
              >
              <span class="material-symbols-rounded search-icon">search</span>
            </div>
            <!-- Search Suggestions Dropdown -->
            <div 
              class="search-suggestions" 
              x-show="showSuggestions && suggestions.length > 0"
              x-transition
            >
              <template x-for="suggestion in suggestions" :key="suggestion.id">
                <div class="suggestion-item" @click="selectSuggestion(suggestion)">
                  <div class="suggestion-icon">
                    <span class="material-symbols-rounded" x-text="suggestion.icon"></span>
                  </div>
                  <div class="suggestion-content">
                    <div class="suggestion-title" x-text="suggestion.title"></div>
                    <div class="suggestion-description" x-text="suggestion.description"></div>
                  </div>
                  <div class="suggestion-type" x-text="suggestion.type"></div>
                </div>
              </template>
            </div>
          </div>
        </div>
      </header>
      <!-- Content Area -->
      <div class="content">
        <!-- Dashboard Stats Grid -->
        <div class="dashboard-grid">
          <div class="stat-card">
            <div class="stat-header">
              <div class="stat-icon">
                <span class="material-symbols-rounded">store</span>
              </div>
              <div class="stat-trend trend-up"></div>
            </div>
            <div class="stat-number" x-text="stats.pharmacies"></div>
            <div class="stat-label">Active Pharmacies</div>
          </div>
          <div class="stat-card">
            <div class="stat-header">
              <div class="stat-icon">
                <span class="material-symbols-rounded">people</span>
              </div>
              <div class="stat-trend trend-up"></div>
            </div>
            <div class="stat-number" x-text="stats.users"></div>
            <div class="stat-label">Total Users</div>
          </div>
          <div class="stat-card">
            <div class="stat-header">
              <div class="stat-icon">
                <span class="material-symbols-rounded">receipt_long</span>
              </div>
              <div class="stat-trend trend-down"></div>
            </div>
            <div class="stat-number" x-text="stats.transactions"></div>
            <div class="stat-label">Transactions Today</div>
          </div>
          <div class="stat-card">
            <div class="stat-header">
              <div class="stat-icon">
                <span class="material-symbols-rounded">trending_up</span>
              </div>
              <div class="stat-trend trend-up"></div>
            </div>
            <div class="stat-number">K<span x-text="stats.revenue"></div>
            <div class="stat-label">Revenue Today</div>
          </div>
        </div>
        <!-- Trial Status -->
        <div class="trial-status-section" x-show="trialInfo && trialInfo.isTrialAccount">
          <h2 class="section-title">
            <span class="material-symbols-rounded">timer</span>
            Trial Status
          </h2>
          <div class="trial-status-card" :class="{ 'trial-expiring-soon': trialInfo.daysRemaining <= 3, 'trial-expired': trialInfo.daysRemaining <= 0 }">
            <div class="trial-status-header">
              <div class="trial-status-icon">
                <span class="material-symbols-rounded" x-text="trialInfo.daysRemaining > 0 ? 'hourglass_top' : 'hourglass_empty'"></span>
              </div>
              <div class="trial-status-text">
                <div class="trial-status-title" x-text="trialInfo.daysRemaining > 0 ? 'Free Trial Active' : 'Trial Expired'"></div>
                <div class="trial-status-subtitle" x-text="trialInfo.daysRemaining > 0 ? `${trialInfo.daysRemaining} days remaining` : 'Upgrade to continue using UmiHealthInformationSystems'"></div>
              </div>
              <div class="trial-status-action">
                <button class="upgrade-button" @click="showSubscriptionModal = true" x-show="trialInfo.daysRemaining <= 3">
                  Upgrade Now
                </button>
              </div>
            </div>
            <div class="trial-progress-bar">
              <div class="trial-progress-fill" :style="{ width: `${Math.max(0, (trialInfo.daysRemaining / 14) * 100)}%` }"></div>
            </div>
            <div class="trial-features">
              <span class="trial-feature-badge">Full Features</span>
              <span class="trial-feature-badge">No Credit Card</span>
              <span class="trial-feature-badge">Cancel Anytime</span>
            </div>
          </div>
        </div>
        <!-- Quick Actions -->
        <div class="quick-actions">
          <h2 class="section-title">
            <span class="material-symbols-rounded">bolt</span>
            Quick Actions
          </h2>
          <div class="actions-grid">
            <a href="#" class="action-button" @click.prevent="navigateTo('add-pharmacy')">
              <span class="material-symbols-rounded action-icon">add_business</span>
              <span>Add New Pharmacy</span>
            </a>
            <a href="#" class="action-button" @click.prevent="navigateTo('user-management')">
              <span class="material-symbols-rounded action-icon">person_add</span>
              <span>Create User Account</span>
            </a>
            <a href="#" class="action-button" @click.prevent="navigateTo('system-backup')">
              <span class="material-symbols-rounded action-icon">backup</span>
              <span>System Backup</span>
            </a>
            <a href="#" class="action-button" @click.prevent="navigateTo('generate-report')">
              <span class="material-symbols-rounded action-icon">summarize</span>
              <span>Generate Report</span>
            </a>
          </div>
        </div>
        <!-- Recent Activity -->
        <div class="activity-feed">
          <h2 class="section-title">
            <span class="material-symbols-rounded">activity</span>
            Recent Activity
          </h2>
          <div id="activity-container">
            <!-- Activity items will be loaded dynamically -->
            <div class="activity-item">
              <div class="activity-icon">
                <span class="material-symbols-rounded">info</span>
              </div>
              <div class="activity-content">
                <div class="activity-title">Loading recent activity...</div>
                <div class="activity-description">Please wait while we fetch the latest system activity</div>
              </div>
              <div class="activity-time">Just now</div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
  <script>
    function searchComponent() {
      return {
        // Initialize backend integration
        const pageIntegration = new PageIntegrationTemplate('super-admin-home', {
            requireAuth: true,
            enableRealTime: true,
            enableCaching: true
        });
        
        return {
            ...pageIntegration,
            backendHelper: window.backendHelper,
            apiClient: window.apiClient,
            authManager: window.authManager,
            isAuthenticated: false,
            loading: false,
            error: null,
        query: '',
        showSuggestions: false,
        suggestions: [],
        async init() {
            try {
                // Check authentication
                this.isAuthenticated = this.authManager?.isAuthenticated() || false;
                
                if (!this.isAuthenticated) {
                    this.error = 'Please login to access this page';
                    return;
                }
                
                // Initialize backend integration
                await this.backendHelper.initPage('super-admin-home', {
                    enableRealTime: true,
                    initialData: this.getInitialDataConfig()
                });
                
                // Load page data
                await this.loadPageData();
                
                // Set up event listeners
                this.setupEventListeners();
                
                console.log('super-admin-home page initialized with backend integration');
            } catch (error) {
                console.error('Failed to initialize super-admin-home page:', error);
                this.error = 'Failed to initialize page';
            }
        },,
        async loadSearchSuggestions() {
          try {
            // Load real data for search suggestions
            const [pharmacies, users, transactions] = await Promise.all([
              window.superAdminDataSync.request('/pharmacies?pageSize=5'),
              window.superAdminDataSync.request('/users?pageSize=5'),
              window.superAdminDataSync.request('/transactions?pageSize=5')
            ]);
            
            this.suggestions = [
              ...(pharmacies?.data || []).map(p => ({
                id: p.id,
                title: p.name,
                description: p.location || 'Unknown location',
                type: 'pharmacy',
                icon: 'store'
              })),
              ...(users?.data || []).map(u => ({
                id: u.id,
                title: `${u.firstName} ${u.lastName}`,
                description: u.role || 'User',
                type: 'user',
                icon: 'person'
              })),
              ...(transactions?.data || []).map(t => ({
                id: t.id,
                title: `Transaction #${t.id}`,
                description: `${t.currency} ${t.amount} - ${t.status}`,
                type: 'transaction',
                icon: 'receipt_long'
              })),
              {
                id: 'analytics',
                title: 'System Analytics',
                description: 'View system performance metrics',
                type: 'page',
                icon: 'analytics'
              }
            ];
          } catch (error) {
            console.error('Failed to load search suggestions:', error);
            // Fallback to minimal suggestions
            this.suggestions = [
              {
                id: 'analytics',
                title: 'System Analytics',
                description: 'View system performance metrics',
                type: 'page',
                icon: 'analytics'
              }
            ];
          }
        },
        handleSearch() {
          if (this.query.length < 2) {
            this.loadSearchSuggestions();
            return;
          }
          
          // Real-time search with API
          this.performRealTimeSearch(this.query);
        },
        
        async performRealTimeSearch(query) {
          try {
            const results = await window.superAdminDataSync.request(`/search?q=${encodeURIComponent(query)}`);
            
            this.suggestions = [
              ...(results.pharmacies || []).map(p => ({
                id: p.id,
                title: p.name,
                description: p.location || 'Unknown location',
                type: 'pharmacy',
                icon: 'store'
              })),
              ...(results.users || []).map(u => ({
                id: u.id,
                title: `${u.firstName} ${u.lastName}`,
                description: u.role || 'User',
                type: 'user',
                icon: 'person'
              })),
              ...(results.transactions || []).map(t => ({
                id: t.id,
                title: `Transaction #${t.id}`,
                description: `${t.currency} ${t.amount} - ${t.status}`,
                type: 'transaction',
                icon: 'receipt_long'
              }))
            ];
          } catch (error) {
            console.error('Search failed:', error);
            // Filter existing suggestions based on query
            this.suggestions = this.suggestions.filter(s => 
              s.title.toLowerCase().includes(query.toLowerCase()) ||
              s.description.toLowerCase().includes(query.toLowerCase())
            );
          }
        },
        selectSuggestion(suggestion) {
          console.log('Selected suggestion:', suggestion);
          this.query = suggestion.title;
          this.showSuggestions = false;
          // Navigate based on suggestion type
          switch(suggestion.type) {
            case 'pharmacy':
              window.location.href = 'pharmacies.html';
              break;
            case 'user':
              window.location.href = 'users.html';
              break;
            case 'transaction':
              window.location.href = 'transactions.html';
              break;
            case 'page':
              window.location.href = suggestion.title.toLowerCase().replace(' ', '-') + '.html';
              break;
          }
        },
        hideSuggestions() {
          setTimeout(() => {
            this.showSuggestions = false;
          }, 200);
        }
      }
    }
    function superAdmin() {
      return {
        userName: '',
        userEmail: '',
        mobileMenuOpen: false,
        activeMenuItem: 'dashboard',
        showSubscriptionModal: false,
        trialInfo: null,
        loading: false,
        dashboardData: null,
        recentActivity: [],
        systemWarnings: [],
        stats: {
          totalTenants: 0,
          activeTenants: 0,
          totalUsers: 0,
          activeUsers: 0,
          totalTransactions: 0,
          totalRevenue: 0,
          criticalSecurityEvents: 0,
          pendingReports: 0,
          failedBackups: 0
        },
        init() {
          // Check if user is super admin
          const userStr = localStorage.getItem('umi_current_user');
          if (userStr) {
            const user = JSON.parse(userStr);
            if (user.role !== 'superadmin') {
              // Redirect to appropriate portal based on role
              const baseUrl = '../portals';
              if (user.role === 'admin' || user.role === 'manager') {
                window.location.href = `${baseUrl}/admin/home.html`;
              } else if (user.role === 'cashier') {
                window.location.href = `${baseUrl}/cashier/home.html`;
              } else if (user.role === 'pharmacist') {
                window.location.href = `${baseUrl}/pharmacist/home.html`;
              } else {
                window.location.href = `${baseUrl}/admin/home.html`;
              }
              return;
            }
          } else {
            // Redirect to sign-in
            window.location.href = '../../public/signin.html';
            return;
          }

          // Get user info from session
          this.userName = sessionStorage.getItem('userName') || 'Super Admin';
          this.userEmail = sessionStorage.getItem('userEmail') || 'admin@UmiHealthInformationSystems.zm';
          
          // Check authentication
          if (!window.superAdminDataSync.isAuthenticated()) {
            this.redirectToLogin();
            return;
          }
          
          // Show connection status
          this.updateConnectionStatus();
          
          // Load dashboard data
          this.loadDashboardData();
          this.loadSystemWarnings();
          
          // Set up auto-refresh
          window.superAdminDataSync.startAutoRefresh('/dashboard', (data) => {
            this.dashboardData = data;
            this.updateStats(data);
            this.updateRecentActivity(data);
          });
          
          // Set up event listeners
          window.superAdminDataSync.addEventListener('error', (message) => {
            this.showError(message);
          });
          
          window.superAdminDataSync.addEventListener('success', (message) => {
            this.showSuccess(message);
          });
          
          // Listen for connection changes
          window.addEventListener('online', () => {
            this.updateConnectionStatus();
            this.showSuccess('Connection restored');
          });
          
          window.addEventListener('offline', () => {
            this.updateConnectionStatus();
            this.showError('Connection lost - using offline mode');
          });
          
          // Close mobile menu when clicking outside
          document.addEventListener('click', (e) => {
            if (!e.target.closest('.sidebar') && !e.target.closest('.mobile-menu-toggle')) {
              this.mobileMenuOpen = false;
            }
          });
        },
        async loadDashboardData() {
          try {
            this.loading = true;
            const data = await window.superAdminDataSync.getDashboardSummary();
            this.dashboardData = data;
            this.updateStats(data);
            this.updateRecentActivity(data);
          } catch (error) {
            this.showError('Failed to load dashboard data');
            console.error('Dashboard load error:', error);
          } finally {
            this.loading = false;
          }
        },
        updateStats(data) {
          this.stats = {
            pharmacies: data.totalTenants || 0,
            users: data.totalUsers || 0,
            transactions: data.totalTransactions || 0,
            revenue: data.totalRevenue || 0
          };
        },
        updateRecentActivity(data) {
          const activityContainer = document.getElementById('activity-container');
          
          if (!data.recentLogs?.length && !data.recentSecurityEvents?.length) {
            activityContainer.innerHTML = `
              <div class="activity-item">
                <div class="activity-icon">
                  <span class="material-symbols-rounded">info</span>
                </div>
                <div class="activity-content">
                  <div class="activity-title">No recent activity</div>
                  <div class="activity-description">System is running normally</div>
                </div>
                <div class="activity-time">Just now</div>
              </div>
            `;
            return;
          }
          
          const activities = [
            ...(data.recentLogs?.map(log => ({
              type: 'log',
              message: log.message,
              timestamp: log.createdAt,
              severity: log.logLevel,
              icon: this.getSeverityIcon(log.logLevel)
            })) || []),
            ...(data.recentSecurityEvents?.map(event => ({
              type: 'security',
              message: `${event.eventType}: ${event.action || 'Unknown action'}`,
              timestamp: event.createdAt,
              severity: event.severity,
              icon: this.getSeverityIcon(event.severity)
            })) || [])
          ].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
           .slice(0, 10);
          
          activityContainer.innerHTML = activities.map(activity => `
            <div class="activity-item">
              <div class="activity-icon">
                <span class="material-symbols-rounded">${activity.icon}</span>
              </div>
              <div class="activity-content">
                <div class="activity-title">${activity.message}</div>
                <div class="activity-description">${activity.type === 'security' ? 'Security Event' : 'System Log'}</div>
              </div>
              <div class="activity-time">${this.formatDateTime(activity.timestamp)}</div>
            </div>
          `).join('');
        },
        async loadSystemWarnings() {
          try {
            const warnings = await window.superAdminDataSync.getSystemWarnings();
            this.systemWarnings = warnings;
          } catch (error) {
            console.error('Failed to load system warnings:', error);
          }
        },
        async loadTrialInfo() {
          try {
            localStorage.removeItem('auth_tokens');
            localStorage.removeItem('umi_access_token');
            localStorage.removeItem('umi_tenant_id');
            localStorage.removeItem('umi_branch_id');
            localStorage.removeItem('umi_user_id');
            // Get trial info from localStorage (set during signup)
            const storedTrialInfo = localStorage.getItem('trialInfo');
            if (storedTrialInfo) {
              this.trialInfo = JSON.parse(storedTrialInfo);
            }
          } catch (error) {
            console.error('Failed to load trial info:', error);
          }
        },
        async loadStats() {
          // This is now handled by loadDashboardData()
          await this.loadDashboardData();
        },
        async loadRecentActivity() {
          // This is now handled by loadDashboardData()
          await this.loadDashboardData();
        },
        formatNumber(num) {
          if (num >= 1000000) {
            return (num / 1000000).toFixed(1) + 'M';
          } else if (num >= 1000) {
            return (num / 1000).toFixed(1) + 'K';
          }
          return num.toString();
        },
        formatCurrency(amount) {
          return new Intl.NumberFormat('en-ZM', {
            style: 'currency',
            currency: 'ZMW'
          }).format(amount);
        },
        formatDateTime(dateString) {
          return window.superAdminDataSync.formatDateTime(dateString);
        },
        getSeverityIcon(severity) {
          const icons = {
            low: 'info',
            medium: 'warning',
            high: 'priority_high',
            critical: 'dangerous'
          };
          return icons[severity] || 'info';
        },
        getSeverityClass(severity) {
          const classes = {
            low: 'text-blue-400',
            medium: 'text-yellow-400',
            high: 'text-orange-400',
            critical: 'text-red-400'
          };
          return classes[severity] || 'text-gray-400';
        },
        showError(message) {
          // Show error toast or notification
          if (window.showToast) {
            window.showToast(message, 'error');
          } else {
            alert(message);
          }
        },
        showSuccess(message) {
          // Show success toast or notification
          if (window.showToast) {
            window.showToast(message, 'success');
          }
        },
        redirectToLogin() {
          window.location.href = '../../public/signin.html';
        },
        logout() {
          window.superAdminDataSync.clearToken();
          sessionStorage.clear();
          this.redirectToLogin();
        },
        setActiveMenuItem(item) {
          this.activeMenuItem = item;
        },
        // Navigation methods
        navigateTo(page) {
          window.location.href = `${page}.html`;
        },
        // Dashboard actions
        async refreshDashboard() {
          await this.loadDashboardData();
          await this.loadSystemWarnings();
        },
        async generateReport() {
          try {
            const reportData = {
              name: `Dashboard Report ${new Date().toISOString().split('T')[0]}`,
              type: 'dashboard',
              description: 'Automated dashboard report with system metrics and statistics'
            };
            await window.superAdminDataSync.createReport(reportData);
            this.showSuccess('Report generation started');
          } catch (error) {
            this.showError('Failed to generate report');
          }
        },
        async exportData() {
          try {
            await window.superAdminDataSync.exportSystemData('dashboard', {
              includeStats: true,
              includeAnalytics: true,
              dateRange: 'last30days'
            });
            this.showSuccess('Data export completed');
          } catch (error) {
            this.showError('Failed to export data');
          }
        },
        // System health actions
        async checkSystemHealth() {
          try {
            const health = await window.superAdminDataSync.getSystemHealth();
            console.log('System Health:', health);
            if (health.status === 'healthy') {
              this.showSuccess('System is healthy');
            } else {
              this.showError('System health issues detected');
            }
          } catch (error) {
            this.showError('Failed to check system health');
          }
        },
        // Update connection status indicator
        updateConnectionStatus() {
          const status = window.superAdminDataSync.getConnectionStatus();
          console.log('Connection status:', status);
          
          // You could update a UI indicator here if needed
          // For example, show a green dot when online, orange when using cached data
        },
        
        // Cleanup
        destroy() {
          window.superAdminDataSync.stopAllAutoRefresh();
        }
      }
    }
  </script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script></body>
</html>
<!DOCTYPE html>
<html lang="en" x-data="logs()">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>System Logs | UmiHealthInformationSystems Pharmacy Management</title>
  <link rel="icon" href="../../logo.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Glacial+Indifference:wght@400;500;600;700&family=Material+Symbols+Rounded:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/tailwind.output.css">
  <style>
    :root {
      --color-primary-blue: #2563EB;
      --color-accent-teal: #14B8A6;
      --color-text-white: #FFFFFF;
      --color-subtle-blue: #EFF6FF;
      --font-primary: 'Glacial Indifference', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: #0a0a0a;
      color: var(--color-text-white);
      font-family: 'Glacial Indifference', sans-serif;
      line-height: 1.5;
      min-height: 100vh;
      position: relative;
      background-image: 
        linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
    }

    /* Custom scrollbar styles */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* Firefox scrollbar */
    * {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.2) rgba(255, 255, 255, 0.05);
    }

    /* Fallback for browsers that don't support scrollbar styling */
    *::-webkit-scrollbar {
      width: 8px;
    }
    
    *::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }
    
    *::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }
    
    *::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .dashboard-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 280px;
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      text-align: center;
    }

    .sidebar-title {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      color: var(--color-accent-teal);
    }

    .sidebar-menu {
      flex: 1;
      padding: 1rem 0;
      overflow-y: auto;
    }

    .menu-section {
      margin-bottom: 2rem;
    }

    .menu-title {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      opacity: 0.6;
      padding: 0 1.5rem;
      margin-bottom: 0.5rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      color: var(--color-text-white);
      text-decoration: none;
      transition: all 0.3s ease;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .menu-item:hover {
      background: rgba(255, 255, 255, 0.1);
      opacity: 1;
    }

    .menu-item.active {
      background: rgba(20, 184, 166, 0.2);
      border-left: 3px solid var(--color-accent-teal);
      opacity: 1;
    }

    .menu-icon {
      font-size: 1.25rem;
      color: var(--color-accent-teal);
    }

    .sidebar-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Main Content Area */
    .main-content {
      flex: 1;
      margin-left: 280px;
      display: flex;
      flex-direction: column;
    }

    /* Header Styles */
    .header {
      height: 70px;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      position: sticky;
      top: 0;
      z-index: 999;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .header-logo {
      display: flex;
      align-items: center;
    }

    .header-logo img {
      width: 100px;
      height: 100px;
      object-fit: contain;
    }

    .page-title {
      font-size: 1.5rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .user-menu:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .user-avatar {
      width: 35px;
      height: 35px;
      background: var(--color-accent-teal);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
    }

    .user-info {
      display: flex;
      flex-direction: column;
    }

    .user-name {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .user-role {
      font-size: 0.75rem;
      opacity: 0.8;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .search-container {
      position: relative;
      width: 350px;
    }

    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .search-container .search-input {
      width: 100%;
      padding: 0.75rem 1rem 0.75rem 2.5rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      transition: all 0.3s ease;
    }

    .search-container .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-container .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--color-accent-teal);
      box-shadow: 0 0 0 2px rgba(20, 184, 166, 0.2);
    }

    .search-icon {
      position: absolute;
      left: 0.75rem;
      color: rgba(255, 255, 255, 0.6);
      font-size: 1.2rem;
      pointer-events: none;
    }

    .search-suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      margin-top: 0.5rem;
      max-height: 400px;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .suggestion-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .suggestion-item:last-child {
      border-bottom: none;
    }

    .suggestion-item:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .suggestion-icon {
      width: 40px;
      height: 40px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: var(--color-accent-teal);
    }

    .suggestion-content {
      flex: 1;
    }

    .suggestion-title {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.25rem;
    }

    .suggestion-description {
      font-size: 0.8rem;
      opacity: 0.7;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .suggestion-type {
      padding: 0.25rem 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      text-transform: uppercase;
    }

    /* Content Area */
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }

    /* Page Header */
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .page-actions {
      display: flex;
      gap: 1rem;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-size: 0.9rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
    }

    .btn-primary {
      background: var(--color-accent-teal);
      color: white;
    }

    .btn-primary:hover {
      background: #0d9486;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: var(--color-text-white);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Search and Filters */
    .filters-section {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 2rem;
    }

    .search-bar {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .search-input {
      flex: 1;
      padding: 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.5);
    }

    .filter-tags {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .filter-tag {
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.8rem;
      font-family: 'Glacial Indifference', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .filter-tag:hover,
    .filter-tag.active {
      background: var(--color-accent-teal);
      border-color: var(--color-accent-teal);
    }

    /* Logs Container */
    .logs-container {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
      max-height: 600px;
      overflow-y: auto;
    }

    .log-entry {
      padding: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      font-family: monospace;
      font-size: 0.85rem;
      line-height: 1.4;
    }

    .log-entry:last-child {
      border-bottom: none;
    }

    .log-timestamp {
      color: var(--color-accent-teal);
      font-weight: 600;
    }

    .log-level {
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-right: 0.5rem;
    }

    .log-level-info {
      background: rgba(59, 130, 246, 0.2);
      color: #93C5FD;
    }

    .log-level-warning {
      background: rgba(251, 191, 36, 0.2);
      color: #FCD34D;
    }

    .log-level-error {
      background: rgba(244, 76, 76, 0.2);
      color: #FCA5A5;
    }

    .log-level-debug {
      background: rgba(139, 92, 246, 0.2);
      color: #C4B5FD;
    }

    .log-message {
      opacity: 0.9;
    }

    /* Loading State */
    .loading-state {
      text-align: center;
      padding: 3rem;
      opacity: 0.7;
    }

    .loading-spinner {
      font-size: 2rem;
      margin-bottom: 1rem;
      color: var(--color-accent-teal);
    }

    /* Mobile Responsiveness */
    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      color: var(--color-text-white);
      font-size: 1.5rem;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .header {
        padding: 0 1rem;
      }

      .content {
        padding: 1rem;
      }

      .page-header {
        flex-direction: column;
        gap: 1rem;
        align-items: flex-start;
      }

      .search-bar {
        flex-direction: column;
      }
    }
  </style>

    <!-- Backend Integration Libraries -->
    <script src="../../js/api-client.js"></script>
    <script src="../../js/auth-manager.js"></script>
    <script src="../shared/js/backend-integration-helper.js"></script>
    <script src="../shared/js/page-integration-template.js"></script>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" :class="{ 'open': mobileMenuOpen }">
      <div class="sidebar-header">
        <div class="sidebar-title">Umi Admin</div>
      </div>
      
      <nav class="sidebar-menu">
        <div class="menu-section">
          <div class="menu-title">Main</div>
          <a href="home.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">dashboard</span>
            Home
          </a>
          <a href="pharmacies.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">store</span>
            Pharmacies
          </a>
          <a href="users.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">people</span>
            Users
          </a>
          <a href="transactions.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">receipt_long</span>
            Transactions
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Management</div>
          <a href="analytics.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">analytics</span>
            Analytics
          </a>
          <a href="reports.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">assessment</span>
            Reports
          </a>
          <a href="settings.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">account_circle</span>
            Account
          </a>
          <a href="security.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">security</span>
            Security
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Support</div>
          <a href="help.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">help_center</span>
            Help Center
          </a>
          <a href="logs.html" class="menu-item active">
            <span class="material-symbols-rounded menu-icon">history</span>
            System Logs
          </a>
        </div>
      </nav>
      
      <div class="sidebar-footer">
        <a href="../../public/signin.html" class="menu-item" @click.prevent="handleLogout">
          <span class="material-symbols-rounded menu-icon">logout</span>
          Sign Out
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen">
            <span class="material-symbols-rounded">menu</span>
          </button>
          <div class="header-logo">
            <!-- Logo removed per request -->
          </div>
          <h1 class="page-title">System Logs</h1>
        </div>
        
        <div class="header-right">
          <div class="search-container" x-data="searchComponent()">
            <div class="search-input-wrapper">
              <input 
                type="text" 
                class="search-input" 
                placeholder="Search pharmacies, users, transactions..."
                x-model="query"
                @input="handleSearch"
                @focus="showSuggestions = true"
                @blur="hideSuggestions"
              >
              <span class="material-symbols-rounded search-icon">search</span>
            </div>
            
            <!-- Search Suggestions Dropdown -->
            <div 
              class="search-suggestions" 
              x-show="showSuggestions && suggestions.length > 0"
              x-transition
            >
              <template x-for="suggestion in suggestions" :key="suggestion.id">
                <div class="suggestion-item" @click="selectSuggestion(suggestion)">
                  <div class="suggestion-icon">
                    <span class="material-symbols-rounded" x-text="suggestion.icon"></span>
                  </div>
                  <div class="suggestion-content">
                    <div class="suggestion-title" x-text="suggestion.title"></div>
                    <div class="suggestion-description" x-text="suggestion.description"></div>
                  </div>
                  <div class="suggestion-type" x-text="suggestion.type"></div>
                </div>
              </template>
            </div>
          </div>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content">
        <!-- Page Header -->
        <div class="page-header">
          <div>
            <h2 class="page-title">System Logs</h2>
            <p style="opacity: 0.8; margin-top: 0.5rem;">Monitor and analyze system activity logs</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary" @click="exportLogs">
              <span class="material-symbols-rounded">download</span>
              Export
            </button>
            <button class="btn btn-primary" @click="refreshLogs">
              <span class="material-symbols-rounded">refresh</span>
              Refresh
            </button>
          </div>
        </div>

        <!-- Search and Filters -->
        <div class="filters-section">
          <div class="search-bar">
            <input 
              type="text" 
              class="search-input" 
              placeholder="Search logs by message, user, or action..."
              x-model="searchQuery"
              @input="filterLogs"
            >
            <button class="btn btn-secondary" @click="resetFilters">
              <span class="material-symbols-rounded">refresh</span>
              Reset
            </button>
          </div>
          
          <div class="filter-tags">
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'all' }"
              @click="setFilter('all')"
            >
              All Logs
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'info' }"
              @click="setFilter('info')"
            >
              Info
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'warning' }"
              @click="setFilter('warning')"
            >
              Warnings
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'error' }"
              @click="setFilter('error')"
            >
              Errors
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'debug' }"
              @click="setFilter('debug')"
            >
              Debug
            </div>
          </div>
        </div>

        <!-- Logs Container -->
        <div class="logs-container">
          <!-- Loading State -->
          <div x-show="loading" class="loading-state">
            <div class="loading-spinner">
              <span class="material-symbols-rounded">refresh</span>
            </div>
            <div>Loading system logs...</div>
          </div>
          
          <!-- Empty State -->
          <div x-show="!loading && filteredLogs.length === 0" class="loading-state">
            <div style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;">
              <span class="material-symbols-rounded">history</span>
            </div>
            <div>No logs found</div>
            <div style="font-size: 0.9rem; opacity: 0.6; margin-top: 0.5rem;">
              Try adjusting your search or filters
            </div>
          </div>
          
          <!-- Log Entries -->
          <template x-for="log in filteredLogs" :key="log.id">
            <div class="log-entry">
              <span class="log-timestamp" x-text="log.timestamp"></span>
              <span class="log-level" :class="`log-level-${log.level}`" x-text="log.level.toUpperCase()"></span>
              <span class="log-message" x-text="log.message"></span>
            </div>
          </template>
        </div>
      </div>
    </main>
  </div>

  <script>
    function searchComponent() {
      return {
        // Initialize backend integration
        const pageIntegration = new PageIntegrationTemplate('super-admin-logs', {
            requireAuth: true,
            enableRealTime: false,
            enableCaching: true
        });
        
        return {
            ...pageIntegration,
            backendHelper: window.backendHelper,
            apiClient: window.apiClient,
            authManager: window.authManager,
            isAuthenticated: false,
            loading: false,
            error: null,
        query: '',
        showSuggestions: false,
        suggestions: [],
        allSuggestions: [
          { id: 1, title: 'Pharmacies', description: 'Manage pharmacy tenants', type: 'page', icon: 'store', url: 'pharmacies.html' },
          { id: 2, title: 'Users', description: 'User management', type: 'page', icon: 'people', url: 'users.html' },
          { id: 3, title: 'Transactions', description: 'Transaction history', type: 'page', icon: 'receipt_long', url: 'transactions.html' },
          { id: 4, title: 'Analytics', description: 'System analytics', type: 'page', icon: 'analytics', url: 'analytics.html' },
          { id: 5, title: 'Reports', description: 'Reports & insights', type: 'page', icon: 'assessment', url: 'reports.html' },
          { id: 6, title: 'Security', description: 'Security center', type: 'page', icon: 'security', url: 'security.html' },
          { id: 7, title: 'Settings', description: 'Account & system settings', type: 'page', icon: 'settings', url: 'settings.html' },
          { id: 8, title: 'Help Center', description: 'Support and documentation', type: 'page', icon: 'help_center', url: 'help.html' },
          { id: 9, title: 'System Logs', description: 'System activity logs', type: 'page', icon: 'history', url: 'logs.html' }
        ],

        handleSearch() {
          const q = (this.query || '').trim().toLowerCase();
          if (q.length < 2) {
            this.suggestions = [];
            return;
          }

          this.suggestions = this.allSuggestions
            .filter(s =>
              (s.title && s.title.toLowerCase().includes(q)) ||
              (s.description && s.description.toLowerCase().includes(q)) ||
              (s.type && s.type.toLowerCase().includes(q))
            )
            .slice(0, 8);
        },

        selectSuggestion(suggestion) {
          this.query = suggestion.title;
          this.showSuggestions = false;
          if (suggestion && suggestion.url) {
            window.location.href = suggestion.url;
          }
        },

        hideSuggestions() {
          setTimeout(() => {
            this.showSuggestions = false;
          }, 200);
        }
      }
    }

    function logs() {
      return {
        userName: '',
        userEmail: '',
        mobileMenuOpen: false,
        showUserMenu: false,
        loading: true,
        searchQuery: '',
        activeFilter: 'all',
        logs: [],
        filteredLogs: [],

        async init() {
            try {
                // Check authentication
                this.isAuthenticated = this.authManager?.isAuthenticated() || false;
                
                if (!this.isAuthenticated) {
                    this.error = 'Please login to access this page';
                    return;
                }
                
                // Initialize backend integration
                await this.backendHelper.initPage('super-admin-logs', {
                    enableRealTime: false,
                    initialData: this.getInitialDataConfig()
                });
                
                // Load page data
                await this.loadPageData();
                
                // Set up event listeners
                this.setupEventListeners();
                
                console.log('super-admin-logs page initialized with backend integration');
            } catch (error) {
                console.error('Failed to initialize super-admin-logs page:', error);
                this.error = 'Failed to initialize page';
            }
        },
            if (!e.target.closest('.user-menu')) {
              this.showUserMenu = false;
            }
          });
        },

        async loadLogs() {
          this.loading = true;
          try {
            // This would be replaced with actual API calls
            console.log('Fetching system logs from API...');
            
            // Initialize with empty array for real implementation
            this.logs = [];
            this.filteredLogs = [];
            
            // Placeholder for real API call
            // const response = await fetch('/api/logs');
            // this.logs = await response.json();
            // this.filteredLogs = [...this.logs];
            
          } catch (error) {
            console.error('Error loading logs:', error);
          } finally {
            this.loading = false;
          }
        },

        filterLogs() {
          let filtered = [...this.logs];
          
          // Apply search filter
          if (this.searchQuery) {
            const query = this.searchQuery.toLowerCase();
            filtered = filtered.filter(log => 
              log.message.toLowerCase().includes(query) ||
              log.timestamp.toLowerCase().includes(query)
            );
          }
          
          // Apply level filter
          if (this.activeFilter !== 'all') {
            filtered = filtered.filter(log => log.level === this.activeFilter);
          }
          
          this.filteredLogs = filtered;
        },

        setFilter(filter) {
          this.activeFilter = filter;
          this.filterLogs();
        },

        resetFilters() {
          this.searchQuery = '';
          this.activeFilter = 'all';
          this.filterLogs();
        },

        refreshLogs() {
          console.log('Refreshing logs...');
          this.loadLogs();
        },

        exportLogs() {
          console.log('Exporting logs...');
          alert('Log export feature coming soon!');
        },

        handleLogout() {
          if (confirm('Are you sure you want to sign out?')) {
            // Clear session
            sessionStorage.clear();
            
            // Redirect to signin
            window.location.href = '../../public/signin.html';
          }
        }
      }
    }
  </script>

  <!-- Include API and Data Sync Services -->
  <script src="../shared/js/data-sync.js"></script>
  <script src="../shared/js/role-based-access.js"></script>
  <script src="../admin/js/admin-api.js"></script>
  <script src="js/super-admin-api.js"></script>

  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script></body>
</html>




<!DOCTYPE html>
<html lang="en" x-data="pharmacies()">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Pharmacy Management | UmiHealthInformationSystems Pharmacy Management</title>
  <link rel="icon" href="../../logo.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Glacial+Indifference:wght@400;500;600;700&family=Material+Symbols+Rounded:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/tailwind.output.css">
  <style>
    :root {
      --color-primary-blue: #2563EB;
      --color-accent-teal: #14B8A6;
      --color-text-white: #FFFFFF;
      --color-subtle-blue: #EFF6FF;
      --font-primary: 'Glacial Indifference', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: #0a0a0a;
      color: var(--color-text-white);
      font-family: 'Glacial Indifference', sans-serif;
      line-height: 1.5;
      min-height: 100vh;
      position: relative;
      background-image: 
        linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
    }

    /* Custom scrollbar styles */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* Firefox scrollbar */
    @supports (scrollbar-width: thin) {
      * {
        scrollbar-width: thin;
        scrollbar-color: rgba(255, 255, 255, 0.2) rgba(255, 255, 255, 0.05);
      }
    }

    /* Fallback for browsers that don't support scrollbar styling */
    *::-webkit-scrollbar {
      width: 8px;
    }
    
    *::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }
    
    *::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }
    
    *::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .dashboard-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 280px;
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      text-align: center;
    }

    .sidebar-title {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      color: var(--color-accent-teal);
    }

    .sidebar-search {
      display: none;
      padding: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    .sidebar-search .search-container {
      width: 100%;
    }

    .sidebar-menu {
      flex: 1;
      padding: 1rem 0;
      overflow-y: auto;
    }

    .menu-section {
      margin-bottom: 2rem;
    }

    .menu-title {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      opacity: 0.6;
      padding: 0 1.5rem;
      margin-bottom: 0.5rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      color: var(--color-text-white);
      text-decoration: none;
      transition: all 0.3s ease;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .menu-item:hover {
      background: rgba(255, 255, 255, 0.1);
      opacity: 1;
    }

    .menu-item.active {
      background: rgba(20, 184, 166, 0.2);
      border-left: 3px solid var(--color-accent-teal);
      opacity: 1;
    }

    .menu-icon {
      font-size: 1.25rem;
      color: var(--color-accent-teal);
    }

    .sidebar-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Main Content Area */
    .main-content {
      flex: 1;
      margin-left: 280px;
      display: flex;
      flex-direction: column;
    }

    /* Header Styles */
    .header {
      height: 70px;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      position: sticky;
      top: 0;
      z-index: 999;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .header-logo {
      display: flex;
      align-items: center;
    }

    .header-logo img {
      width: 100px;
      height: 100px;
      object-fit: contain;
    }

    .header-brand {
      font-size: 1.25rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      color: var(--color-accent-teal);
    }

    .page-title {
      font-size: 1.5rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .user-menu:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .user-avatar {
      width: 35px;
      height: 35px;
      background: var(--color-accent-teal);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
    }

    .user-info {
      display: flex;
      flex-direction: column;
    }

    .user-name {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .user-role {
      font-size: 0.75rem;
      opacity: 0.8;
      font-family: 'Glacial Indifference', sans-serif;
    }

    /* Search Container Styles */
    .search-container {
      position: relative;
      width: 350px;
    }

    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .search-input {
      width: 100%;
      padding: 0.75rem 1rem 0.75rem 2.5rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      transition: all 0.3s ease;
    }

    .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--color-accent-teal);
      box-shadow: 0 0 0 2px rgba(20, 184, 166, 0.2);
    }

    .search-icon {
      position: absolute;
      left: 0.75rem;
      color: rgba(255, 255, 255, 0.6);
      font-size: 1.2rem;
      pointer-events: none;
    }

    .search-suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      margin-top: 0.5rem;
      max-height: 350px;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .suggestion-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .suggestion-item:last-child {
      border-bottom: none;
    }

    .suggestion-item:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .suggestion-icon {
      width: 40px;
      height: 40px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: var(--color-accent-teal);
    }

    .suggestion-content {
      flex: 1;
    }

    .suggestion-title {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.25rem;
    }

    .suggestion-description {
      font-size: 0.8rem;
      opacity: 0.7;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .suggestion-type {
      padding: 0.25rem 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      text-transform: uppercase;
    }

    /* Content Area */
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }

    /* Page Header */
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .page-actions {
      display: flex;
      gap: 1rem;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-size: 0.9rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
    }

    .btn-primary {
      background: var(--color-accent-teal);
      color: white;
    }

    .btn-primary:hover {
      background: #0d9486;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: var(--color-text-white);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Search and Filters */
    .filters-section {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 2rem;
    }

    .search-bar {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .search-input {
      flex: 1;
      padding: 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.5);
    }

    .filter-tags {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .filter-tag {
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.8rem;
      font-family: 'Glacial Indifference', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .filter-tag:hover,
    .filter-tag.active {
      background: var(--color-accent-teal);
      border-color: var(--color-accent-teal);
    }

    /* Table Styles */
    .table-container {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      overflow: hidden;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
    }

    .data-table th {
      background: rgba(255, 255, 255, 0.05);
      padding: 1rem;
      text-align: left;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .data-table td {
      padding: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .data-table tr:hover {
      background: rgba(255, 255, 255, 0.05);
    }

    .status-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .status-active {
      background: rgba(16, 185, 129, 0.2);
      color: #10B981;
    }

    .status-inactive {
      background: rgba(244, 76, 76, 0.2);
      color: #FCA5A5;
    }

    .status-pending {
      background: rgba(251, 191, 36, 0.2);
      color: #FCD34D;
    }

    .table-actions {
      display: flex;
      gap: 0.5rem;
    }

    .action-btn {
      padding: 0.5rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      color: var(--color-text-white);
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
    }

    .action-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Loading State */
    .loading-state {
      text-align: center;
      padding: 3rem;
      opacity: 0.7;
    }

    .loading-spinner {
      font-size: 2rem;
      margin-bottom: 1rem;
      color: var(--color-accent-teal);
    }

    /* Mobile Responsiveness */
    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      color: var(--color-text-white);
      font-size: 1.5rem;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
        width: 280px;
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .header {
        padding: 0 1rem;
        justify-content: center;
        position: relative;
      }

      .header-left {
        gap: 1rem;
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
      }

      .header-logo {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
      }

      .header-logo img {
        width: 80px;
        height: 80px;
      }

      .page-title {
        display: none;
      }

      .header-right {
        display: none;
      }

      .sidebar-search {
        display: block;
        padding: 1rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      }

      .content {
        padding: 1rem;
      }

      .page-header {
        flex-direction: column;
        gap: 1rem;
        align-items: flex-start;
      }

      .search-bar {
        flex-direction: column;
      }

      .table-container {
        overflow-x: auto;
      }
    }
  </style>

    <!-- Backend Integration Libraries -->
    <script src="../../js/api-client.js"></script>
    <script src="../../js/auth-manager.js"></script>
    <script src="../shared/js/backend-integration-helper.js"></script>
    <script src="../shared/js/page-integration-template.js"></script>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" :class="{ 'open': mobileMenuOpen }">
      <div class="sidebar-header">
        <div class="sidebar-title">Umi Admin</div>
      </div>
      
      <!-- Mobile Search Bar -->
      <div class="sidebar-search">
        <div class="search-container" x-data="searchComponent()">
          <div class="search-input-wrapper">
            <input 
              type="text" 
              class="search-input" 
              placeholder="Search pharmacies..."
              x-model="query"
              @input="handleSearch"
              @focus="showSuggestions = true"
              @blur="hideSuggestions"
            >
            <span class="material-symbols-rounded search-icon">search</span>
          </div>
          
          <!-- Search Suggestions Dropdown -->
          <div 
            class="search-suggestions" 
            x-show="showSuggestions && suggestions.length > 0"
            x-transition
          >
            <template x-for="suggestion in suggestions" :key="suggestion.id">
              <div class="suggestion-item" @click="selectSuggestion(suggestion)">
                <div class="suggestion-icon">
                  <span class="material-symbols-rounded" x-text="suggestion.icon"></span>
                </div>
                <div class="suggestion-content">
                  <div class="suggestion-title" x-text="suggestion.title"></div>
                  <div class="suggestion-description" x-text="suggestion.description"></div>
                </div>
                <div class="suggestion-type" x-text="suggestion.type"></div>
              </div>
            </template>
          </div>
        </div>
      </div>
      
      <nav class="sidebar-menu">
        <div class="menu-section">
          <div class="menu-title">Main</div>
          <a href="home.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">dashboard</span>
            Home
          </a>
          <a href="pharmacies.html" class="menu-item active">
            <span class="material-symbols-rounded menu-icon">store</span>
            Pharmacies
          </a>
          <a href="users.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">people</span>
            Users
          </a>
          <a href="transactions.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">receipt_long</span>
            Transactions
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Management</div>
          <a href="analytics.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">analytics</span>
            Analytics
          </a>
          <a href="reports.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">assessment</span>
            Reports
          </a>
          <a href="settings.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">account_circle</span>
            Account
          </a>
          <a href="security.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">security</span>
            Security
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Support</div>
          <a href="help.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">help_center</span>
            Help Center
          </a>
          <a href="logs.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">history</span>
            System Logs
          </a>
        </div>
      </nav>
      
      <div class="sidebar-footer">
        <a href="../../public/signin.html" class="menu-item" @click.prevent="handleLogout">
          <span class="material-symbols-rounded menu-icon">logout</span>
          Sign Out
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen">
            <span class="material-symbols-rounded">menu</span>
          </button>
          <div class="header-logo">
            <!-- Logo removed per request -->
          </div>
          <h1 class="page-title">Pharmacy Management</h1>
        </div>
        
        <div class="header-right">
          <div class="search-container" x-data="searchComponent()">
            <div class="search-input-wrapper">
              <input 
                type="text" 
                class="search-input" 
                placeholder="Search pharmacies..."
                x-model="query"
                @input="handleSearch"
                @focus="showSuggestions = true"
                @blur="hideSuggestions"
              >
              <span class="material-symbols-rounded search-icon">search</span>
            </div>
            
            <!-- Search Suggestions Dropdown -->
            <div 
              class="search-suggestions" 
              x-show="showSuggestions && suggestions.length > 0"
              x-transition
            >
              <template x-for="suggestion in suggestions" :key="suggestion.id">
                <div class="suggestion-item" @click="selectSuggestion(suggestion)">
                  <div class="suggestion-icon">
                    <span class="material-symbols-rounded" x-text="suggestion.icon"></span>
                  </div>
                  <div class="suggestion-content">
                    <div class="suggestion-title" x-text="suggestion.title"></div>
                    <div class="suggestion-description" x-text="suggestion.description"></div>
                  </div>
                  <div class="suggestion-type" x-text="suggestion.type"></div>
                </div>
              </template>
            </div>
          </div>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content">
        <!-- Page Header -->
        <div class="page-header">
          <div>
            <h2 class="page-title">Pharmacy Management</h2>
            <p style="opacity: 0.8; margin-top: 0.5rem;">Manage all registered pharmacies on the UmiHealthInformationSystems platform</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary" @click="exportPharmacies">
              <span class="material-symbols-rounded">download</span>
              Export
            </button>
            <button class="btn btn-primary" @click="showAddPharmacyModal">
              <span class="material-symbols-rounded">add</span>
              Add Pharmacy
            </button>
          </div>
        </div>

        <!-- Search and Filters -->
        <div class="filters-section">
          <div class="search-bar">
            <input 
              type="text" 
              class="search-input" 
              placeholder="Search pharmacies by name, email, or location..."
              x-model="searchQuery"
              @input="filterPharmacies"
            >
            <button class="btn btn-secondary" @click="resetFilters">
              <span class="material-symbols-rounded">refresh</span>
              Reset
            </button>
          </div>
          
          <div class="filter-tags">
            <div 
              class="filter-tag" 
              :class="{ 'active': selectedFilter === 'all' }"
              @click="setFilter('all')"
            >
              All Pharmacies
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': selectedFilter === 'active' }"
              @click="setFilter('active')"
            >
              Active
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': selectedFilter === 'inactive' }"
              @click="setFilter('inactive')"
            >
              Inactive
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': selectedFilter === 'pending' }"
              @click="setFilter('pending')"
            >
              Pending
            </div>
          </div>
        </div>

        <!-- Pharmacies Table -->
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>Pharmacy Name</th>
                <th>Location</th>
                <th>Contact</th>
                <th>License Number</th>
                <th>Status</th>
                <th>Joined Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <!-- Loading State -->
              <tr x-show="loading">
                <td colspan="7">
                  <div class="loading-state">
                    <div class="loading-spinner">
                      <span class="material-symbols-rounded">refresh</span>
                    </div>
                    <div>Loading pharmacies...</div>
                  </div>
                </td>
              </tr>
              
              <!-- Empty State -->
              <tr x-show="!loading && filteredPharmacies.length === 0">
                <td colspan="7">
                  <div class="loading-state">
                    <div style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;">
                      <span class="material-symbols-rounded">store</span>
                    </div>
                    <div>No pharmacies found</div>
                    <div style="font-size: 0.9rem; opacity: 0.6; margin-top: 0.5rem;">
                      Try adjusting your search or filters
                    </div>
                  </div>
                </td>
              </tr>
              
              <!-- Pharmacy Rows -->
              <template x-for="pharmacy in filteredPharmacies" :key="pharmacy.id">
                <tr>
                  <td>
                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                      <div style="width: 40px; height: 40px; background: rgba(20, 184, 166, 0.2); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                        <span class="material-symbols-rounded" style="color: var(--color-accent-teal);">store</span>
                      </div>
                      <div>
                        <div style="font-weight: 600;" x-text="pharmacy.name"></div>
                        <div style="font-size: 0.8rem; opacity: 0.7;" x-text="pharmacy.id"></div>
                      </div>
                    </div>
                  </td>
                  <td x-text="pharmacy.location"></td>
                  <td>
                    <div>
                      <div x-text="pharmacy.email"></div>
                      <div style="font-size: 0.8rem; opacity: 0.7;" x-text="pharmacy.phone"></div>
                    </div>
                  </td>
                  <td x-text="pharmacy.licenseNumber"></td>
                  <td>
                    <span class="status-badge" :class="`status-${pharmacy.status}`" x-text="pharmacy.status"></span>
                  </td>
                  <td x-text="pharmacy.joinedDate"></td>
                  <td>
                    <div class="table-actions">
                      <button class="action-btn" @click="viewPharmacy(pharmacy.id)" title="View Details">
                        <span class="material-symbols-rounded">visibility</span>
                      </button>
                      <button class="action-btn" @click="editPharmacy(pharmacy.id)" title="Edit">
                        <span class="material-symbols-rounded">edit</span>
                      </button>
                      <button class="action-btn" @click="togglePharmacyStatus(pharmacy.id)" :title="pharmacy.status === 'active' ? 'Deactivate' : 'Activate'">
                        <span class="material-symbols-rounded" x-text="pharmacy.status === 'active' ? 'pause_circle' : 'play_circle'"></span>
                      </button>
                    </div>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>

  <div
    x-show="isAddPharmacyModalOpen"
    x-transition
    class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4"
  >
    <div class="bg-[#0a0a0a] border border-white/10 rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto p-6">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-semibold">Add Pharmacy / Tenant</h2>
        <button class="text-white/70 hover:text-white" @click="isAddPharmacyModalOpen = false" title="Close" aria-label="Close">
          <span class="material-symbols-rounded">close</span>
        </button>
      </div>

      <div x-show="createTenantError" class="mb-3 rounded-md bg-red-900/40 border border-red-500/60 px-3 py-2 text-sm">
        <span x-text="createTenantError"></span>
      </div>

      <div x-show="createTenantSuccess" class="mb-3 rounded-md bg-emerald-900/40 border border-emerald-500/60 px-3 py-2 text-sm">
        <span x-text="createTenantSuccess"></span>
      </div>

      <form @submit.prevent="submitCreateTenant" class="space-y-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="space-y-3">
            <div>
              <label for="createTenantPharmacyName" class="block text-sm mb-1">Pharmacy Name</label>
              <input type="text" class="w-full rounded-md bg-black/40 border border-white/20 px-3 py-2 text-sm"
                     id="createTenantPharmacyName"
                     x-model="createTenantForm.pharmacyName" required>
            </div>
            <div>
              <label for="createTenantPharmacyAddress" class="block text-sm mb-1">Address</label>
              <input type="text" class="w-full rounded-md bg-black/40 border border-white/20 px-3 py-2 text-sm"
                     id="createTenantPharmacyAddress"
                     x-model="createTenantForm.pharmacyAddress">
            </div>
            <div class="grid grid-cols-2 gap-3">
              <div>
                <label for="createTenantPharmacyCity" class="block text-sm mb-1">City</label>
                <input type="text" class="w-full rounded-md bg-black/40 border border-white/20 px-3 py-2 text-sm"
                       id="createTenantPharmacyCity"
                       x-model="createTenantForm.pharmacyCity">
              </div>
              <div>
                <label for="createTenantPharmacyPostalCode" class="block text-sm mb-1">Postal Code</label>
                <input type="text" class="w-full rounded-md bg-black/40 border border-white/20 px-3 py-2 text-sm"
                       id="createTenantPharmacyPostalCode"
                       x-model="createTenantForm.pharmacyPostalCode">
              </div>
            </div>
            <div>
              <label for="createTenantLicenseNumber" class="block text-sm mb-1">License Number</label>
              <input type="text" class="w-full rounded-md bg-black/40 border border-white/20 px-3 py-2 text-sm"
                     id="createTenantLicenseNumber"
                     x-model="createTenantForm.licenseNumber">
            </div>
          </div>

          <div class="space-y-3">
            <div class="grid grid-cols-2 gap-3">
              <div>
                <label for="createTenantOwnerFirstName" class="block text-sm mb-1">Owner First Name</label>
                <input type="text" class="w-full rounded-md bg-black/40 border border-white/20 px-3 py-2 text-sm"
                       id="createTenantOwnerFirstName"
                       x-model="createTenantForm.ownerFirstName" required>
              </div>
              <div>
                <label for="createTenantOwnerLastName" class="block text-sm mb-1">Owner Last Name</label>
                <input type="text" class="w-full rounded-md bg-black/40 border border-white/20 px-3 py-2 text-sm"
                       id="createTenantOwnerLastName"
                       x-model="createTenantForm.ownerLastName" required>
              </div>
            </div>
            <div>
              <label for="createTenantOwnerEmail" class="block text-sm mb-1">Owner Email</label>
              <input type="email" class="w-full rounded-md bg-black/40 border border-white/20 px-3 py-2 text-sm"
                     id="createTenantOwnerEmail"
                     x-model="createTenantForm.email" required>
            </div>
            <div>
              <label for="createTenantOwnerPhone" class="block text-sm mb-1">Owner Phone</label>
              <input type="tel" class="w-full rounded-md bg-black/40 border border-white/20 px-3 py-2 text-sm"
                     id="createTenantOwnerPhone"
                     x-model="createTenantForm.phoneNumber">
            </div>
            <div class="grid grid-cols-2 gap-3">
              <div>
                <label for="createTenantPassword" class="block text-sm mb-1">Password</label>
                <input type="password" class="w-full rounded-md bg-black/40 border border-white/20 px-3 py-2 text-sm"
                       id="createTenantPassword"
                       x-model="createTenantForm.password" required>
              </div>
              <div>
                <label for="createTenantConfirmPassword" class="block text-sm mb-1">Confirm Password</label>
                <input type="password" class="w-full rounded-md bg-black/40 border border-white/20 px-3 py-2 text-sm"
                       id="createTenantConfirmPassword"
                       x-model="createTenantForm.confirmPassword" required>
              </div>
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 pt-2 border-t border-white/10 mt-2">
          <div>
            <label for="createTenantPlan" class="block text-sm mb-1">Plan</label>
            <select class="w-full rounded-md bg-black/40 border border-white/20 px-3 py-2 text-sm"
                    id="createTenantPlan"
                    x-model="createTenantForm.selectedPlan">
              <option value="Formula">UmiHealthInformationSystems: Formula</option>
              <option value="Active">UmiHealthInformationSystems: Active</option>
              <option value="Potency">UmiHealthInformationSystems: Potency</option>
            </select>
          </div>
          <div class="flex items-center gap-2">
            <input id="isTrialAccount" type="checkbox" class="w-4 h-4"
                   x-model="createTenantForm.isTrialAccount">
            <label for="isTrialAccount" class="text-sm">Trial account</label>
          </div>
          <div>
            <label for="createTenantTrialDays" class="block text-sm mb-1">Trial Days</label>
            <input type="number" min="1" max="365"
                   id="createTenantTrialDays"
                   class="w-full rounded-md bg-black/40 border border-white/20 px-3 py-2 text-sm"
                   x-model.number="createTenantForm.trialDurationDays">
          </div>
        </div>

        <div class="flex justify-end gap-3 pt-4">
          <button type="button"
                  class="px-4 py-2 rounded-md border border-white/20 text-sm"
                  @click="isAddPharmacyModalOpen = false">
            Cancel
          </button>
          <button type="submit"
                  class="px-4 py-2 rounded-md bg-emerald-500 text-sm font-semibold"
                  :disabled="creatingTenant"
                  aria-label="Create Tenant"
                  x-text="creatingTenant ? 'Creating...' : 'Create Tenant'">
          </button>
        </div>
      </form>
    </div>
  </div>

  <script>
    function searchComponent() {
      return {
        // Initialize backend integration
        const pageIntegration = new PageIntegrationTemplate('super-admin-pharmacies', {
            requireAuth: true,
            enableRealTime: false,
            enableCaching: true
        });
        
        return {
            ...pageIntegration,
            backendHelper: window.backendHelper,
            apiClient: window.apiClient,
            authManager: window.authManager,
            isAuthenticated: false,
            loading: false,
            error: null,
        query: '',
        showSuggestions: false,
        suggestions: [],
        
        async init() {
            try {
                // Check authentication
                this.isAuthenticated = this.authManager?.isAuthenticated() || false;
                
                if (!this.isAuthenticated) {
                    this.error = 'Please login to access this page';
                    return;
                }
                
                // Initialize backend integration
                await this.backendHelper.initPage('super-admin-pharmacies', {
                    enableRealTime: false,
                    initialData: this.getInitialDataConfig()
                });
                
                // Load page data
                await this.loadPageData();
                
                // Set up event listeners
                this.setupEventListeners();
                
                console.log('super-admin-pharmacies page initialized with backend integration');
            } catch (error) {
                console.error('Failed to initialize super-admin-pharmacies page:', error);
                this.error = 'Failed to initialize page';
            }
        },,
            {
              id: 2,
              title: 'HealthPlus Pharmacy',
              description: 'Kitwe, Zambia - Active',
              type: 'pharmacy',
              icon: 'store'
            },
            {
              id: 3,
              title: 'QuickMed Pharmacy',
              description: 'Ndola, Zambia - Pending',
              type: 'pharmacy',
              icon: 'store'
            },
            {
              id: 4,
              title: 'Add New Pharmacy',
              description: 'Create a new pharmacy account',
              type: 'action',
              icon: 'add_business'
            }
          ];
        },
        
        handleSearch() {
          if (this.query.length < 2) {
            this.suggestions = [];
            return;
          }
          
          console.log('Searching pharmacies for:', this.query);
          
          // Filter existing suggestions based on query
          this.suggestions = this.suggestions.filter(s => 
            s.title.toLowerCase().includes(this.query.toLowerCase()) ||
            s.description.toLowerCase().includes(this.query.toLowerCase())
          );
        },
        
        selectSuggestion(suggestion) {
          console.log('Selected pharmacy:', suggestion);
          this.query = suggestion.title;
          this.showSuggestions = false;
          
          if (suggestion.type === 'action') {
            // Trigger add pharmacy action
            window.location.href = 'pharmacies.html?action=add';
          }
        },
        
        hideSuggestions() {
          setTimeout(() => {
            this.showSuggestions = false;
          }, 200);
        }
      }
    }

    function pharmacies() {
      return {
        userName: '',
        userEmail: '',
        mobileMenuOpen: false,
        showUserMenu: false,
        loading: true,
        searchQuery: '',
        selectedFilter: 'all',
        pharmacies: [],
        filteredPharmacies: [],
        apiBaseUrl: (window.UmiHealthInformationSystemsAPI && window.UmiHealthInformationSystemsAPI.baseUrl) || 'https://localhost:5123',
        isAddPharmacyModalOpen: false,
        creatingTenant: false,
        createTenantError: '',
        createTenantSuccess: '',
        createTenantForm: {
          pharmacyName: '',
          ownerFirstName: '',
          ownerLastName: '',
          email: '',
          phoneNumber: '',
          pharmacyAddress: '',
          pharmacyCity: '',
          pharmacyPostalCode: '',
          licenseNumber: '',
          selectedPlan: 'Formula',
          isTrialAccount: true,
          trialDurationDays: 14,
          password: '',
          confirmPassword: ''
        },

        init() {
          // Get user info from session
          this.userName = sessionStorage.getItem('userName') || 'Super Admin';
          this.userEmail = sessionStorage.getItem('userEmail') || 'admin@UmiHealthInformationSystems.zm';
          
          // Load pharmacies data
          this.loadPharmacies();
          
          // Check for add action in URL
          if (window.location.search.includes('action=add')) {
            this.showAddPharmacyModal();
          }
          
          // Close mobile menu when clicking outside
          document.addEventListener('click', (e) => {
            if (!e.target.closest('.sidebar') && !e.target.closest('.mobile-menu-toggle')) {
              this.mobileMenuOpen = false;
            }
            if (!e.target.closest('.user-menu')) {
              this.showUserMenu = false;
            }
          });
        },

        async loadPharmacies() {
          this.loading = true;
          try {
            console.log('Fetching pharmacies from super admin API...');
            
            // Use the super admin data sync service
            const response = await window.superAdminDataSync.request('/tenants');
            
            this.pharmacies = response.data || [];
            this.filteredPharmacies = [...this.pharmacies];
            
            console.log(`Loaded ${this.pharmacies.length} pharmacies`);
            
          } catch (error) {
            console.error('Failed to load pharmacies:', error);
            this.pharmacies = [];
            this.filteredPharmacies = [];
            window.superAdminDataSync.notifyError('Failed to load pharmacies');
          } finally {
            this.loading = false;
          }
        },

        filterPharmacies() {
          let filtered = [...this.pharmacies];
          
          // Apply search filter
          if (this.searchQuery) {
            const query = this.searchQuery.toLowerCase();
            filtered = filtered.filter(pharmacy => 
              pharmacy.name.toLowerCase().includes(query) ||
              pharmacy.location.toLowerCase().includes(query) ||
              pharmacy.email.toLowerCase().includes(query)
            );
          }
          
          // Apply status filter
          if (this.selectedFilter !== 'all') {
            filtered = filtered.filter(pharmacy => pharmacy.status === this.selectedFilter);
          }
          
          this.filteredPharmacies = filtered;
        },

        setFilter(filter) {
          this.selectedFilter = filter;
          this.filterPharmacies();
        },

        // Enhanced button functions
        showAddPharmacyModal() {
          this.createTenantError = '';
          this.createTenantSuccess = '';
          this.createTenantForm.pharmacyName = '';
          this.createTenantForm.ownerFirstName = '';
          this.createTenantForm.ownerLastName = '';
          this.createTenantForm.email = '';
          this.createTenantForm.phoneNumber = '';
          this.createTenantForm.pharmacyAddress = '';
          this.createTenantForm.pharmacyCity = '';
          this.createTenantForm.pharmacyPostalCode = '';
          this.createTenantForm.licenseNumber = '';
          this.createTenantForm.password = '';
          this.createTenantForm.confirmPassword = '';
          this.createTenantForm.selectedPlan = 'Formula';
          this.createTenantForm.isTrialAccount = true;
          this.createTenantForm.trialDurationDays = 14;
          this.isAddPharmacyModalOpen = true;
        },

        getBaseUrl() {
          return this.apiBaseUrl || (window.UmiHealthInformationSystemsAPI && window.UmiHealthInformationSystemsAPI.baseUrl) || 'https://localhost:5123';
        },

        async fetchPharmacyById(id) {
          const baseUrl = this.getBaseUrl();
          const response = await fetch(`${baseUrl}/api/pharmacy/${id}`, {
            headers: await this.getAuthHeaders()
          });
          const result = await response.json();
          if (!response.ok || !result.success) {
            throw new Error(result.message || 'Failed to load pharmacy');
          }
          return result.data;
        },

        async fetchPharmacyStats(id) {
          const baseUrl = this.getBaseUrl();
          const response = await fetch(`${baseUrl}/api/pharmacy/${id}/stats`, {
            headers: await this.getAuthHeaders()
          });
          const result = await response.json();
          if (!response.ok || !result.success) {
            return null;
          }
          return result.data;
        },

        async updatePharmacy(id, payload) {
          const baseUrl = this.getBaseUrl();
          const response = await fetch(`${baseUrl}/api/pharmacy/${id}`, {
            method: 'PUT',
            headers: await this.getAuthHeaders(),
            body: JSON.stringify(payload)
          });
          const result = await response.json();
          if (!response.ok || !result.success) {
            throw new Error(result.message || 'Failed to update pharmacy');
          }
          return result.data;
        },

        editPharmacy(id) {
          this.editPharmacyAsync(id);
        },

        async editPharmacyAsync(id) {
          try {
            const current = await this.fetchPharmacyById(id);

            const name = prompt('Pharmacy name', current.name);
            if (name === null) return;

            const address = prompt('Address', current.address);
            if (address === null) return;

            const city = prompt('City', current.city);
            if (city === null) return;

            const postalCode = prompt('Postal code', current.postalCode);
            if (postalCode === null) return;

            const phone = prompt('Phone', current.phone);
            if (phone === null) return;

            const email = prompt('Email', current.email);
            if (email === null) return;

            const licenseNumber = prompt('License number', current.licenseNumber);
            if (licenseNumber === null) return;

            const payload = {
              name: (name || '').trim(),
              address: (address || '').trim(),
              city: (city || '').trim(),
              province: (current.province || current.city || city || '').trim(),
              postalCode: (postalCode || '').trim(),
              phone: (phone || '').trim(),
              email: (email || '').trim(),
              licenseNumber: (licenseNumber || '').trim(),
              isActive: current.isActive === true
            };

            await this.updatePharmacy(id, payload);
            await this.loadPharmacies();
            alert('Pharmacy updated successfully.');
          } catch (error) {
            console.error('Error editing pharmacy:', error);
            alert(error.message || 'Failed to edit pharmacy.');
          }
        },

        viewPharmacy(id) {
          this.viewPharmacyAsync(id);
        },

        async viewPharmacyAsync(id) {
          try {
            const [detailsResult, statsResult] = await Promise.allSettled([
              this.fetchPharmacyById(id),
              this.fetchPharmacyStats(id)
            ]);

            if (detailsResult.status !== 'fulfilled') {
              throw detailsResult.reason;
            }

            const p = detailsResult.value;
            const s = statsResult.status === 'fulfilled' ? statsResult.value : null;

            const lines = [
              `Name: ${p.name}`,
              `Email: ${p.email}`,
              `Phone: ${p.phone}`,
              `City: ${p.city}`,
              `Address: ${p.address}`,
              `Postal code: ${p.postalCode}`,
              `License: ${p.licenseNumber}`,
              `Status: ${p.isActive ? 'active' : 'inactive'}`
            ];

            if (s) {
              lines.push('---');
              lines.push(`Employees: ${s.totalEmployees}`);
              lines.push(`Customers: ${s.totalCustomers}`);
              lines.push(`Products: ${s.totalProducts}`);
              lines.push(`Today sales: ${s.todaySales}`);
              lines.push(`Month sales: ${s.monthSales}`);
              lines.push(`Low stock: ${s.lowStockProducts}`);
              lines.push(`Out of stock: ${s.outOfStockProducts}`);
            }

            alert(lines.join('\n'));
          } catch (error) {
            console.error('Error viewing pharmacy:', error);
            alert(error.message || 'Failed to load pharmacy details.');
          }
        },

        deletePharmacy(id) {
          if (confirm('Are you sure you want to delete this pharmacy? This action cannot be undone.')) {
            this.deletePharmacyAsync(id);
          }
        },

        async deletePharmacyAsync(id) {
          try {
            const current = await this.fetchPharmacyById(id);

            const payload = {
              name: current.name,
              address: current.address,
              city: current.city,
              province: current.province || current.city,
              postalCode: current.postalCode,
              phone: current.phone,
              email: current.email,
              licenseNumber: current.licenseNumber,
              isActive: false
            };

            await this.updatePharmacy(id, payload);
            await this.loadPharmacies();
            alert(`Pharmacy ${id} deactivated successfully.`);
          } catch (error) {
            console.error('Error deleting pharmacy:', error);
            alert(error.message || 'Failed to delete pharmacy.');
          }
        },

        togglePharmacyStatus(id) {
          this.togglePharmacyStatusAsync(id);
        },

        async togglePharmacyStatusAsync(id) {
          try {
            const current = await this.fetchPharmacyById(id);
            const nextActive = !(current.isActive === true);

            const payload = {
              name: current.name,
              address: current.address,
              city: current.city,
              province: current.province || current.city,
              postalCode: current.postalCode,
              phone: current.phone,
              email: current.email,
              licenseNumber: current.licenseNumber,
              isActive: nextActive
            };

            await this.updatePharmacy(id, payload);
            await this.loadPharmacies();
            alert(`Pharmacy ${id} ${nextActive ? 'activated' : 'deactivated'} successfully.`);
          } catch (error) {
            console.error('Error toggling pharmacy status:', error);
            alert(error.message || 'Failed to update pharmacy status.');
          }
        },

        exportPharmacies() {
          try {
            const rows = Array.isArray(this.filteredPharmacies) ? this.filteredPharmacies : [];
            const headers = ['id', 'name', 'location', 'email', 'phone', 'licenseNumber', 'status', 'joinedDate'];

            const csv = [
              headers.join(','),
              ...rows.map(r => headers.map(h => {
                const raw = r && r[h] !== undefined && r[h] !== null ? String(r[h]) : '';
                const escaped = raw.replace(/\"/g, '""');
                return `"${escaped}"`;
              }).join(','))
            ].join('\n');

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = `pharmacies_${new Date().toISOString().slice(0, 10)}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);

            URL.revokeObjectURL(url);
          } catch (error) {
            console.error('Error exporting pharmacies:', error);
            alert('Failed to export pharmacies.');
          }
        },

        importPharmacies() {
          const input = document.createElement('input');
          input.type = 'file';
          input.accept = '.csv,text/csv';

          input.onchange = async () => {
            try {
              const file = input.files && input.files[0];
              if (!file) return;

              const text = await file.text();
              const lines = text.split(/\r?\n/).filter(l => (l || '').trim().length > 0);
              if (lines.length < 2) {
                alert('CSV file is empty or missing rows.');
                return;
              }

              const parseLine = (line) => {
                const values = [];
                let current = '';
                let inQuotes = false;

                for (let i = 0; i < line.length; i++) {
                  const ch = line[i];
                  if (ch === '"') {
                    if (inQuotes && line[i + 1] === '"') {
                      current += '"';
                      i++;
                    } else {
                      inQuotes = !inQuotes;
                    }
                  } else if (ch === ',' && !inQuotes) {
                    values.push(current);
                    current = '';
                  } else {
                    current += ch;
                  }
                }
                values.push(current);
                return values.map(v => (v || '').trim());
              };

              const header = parseLine(lines[0]).map(h => h.replace(/^\"|\"$/g, '').trim());
              const indexOf = (name) => header.findIndex(h => h.toLowerCase() === name.toLowerCase());

              const required = ['name', 'address', 'city', 'province', 'postalCode', 'phone', 'email', 'licenseNumber'];
              const missing = required.filter(col => indexOf(col) === -1);
              if (missing.length > 0) {
                alert(`Missing required CSV columns: ${missing.join(', ')}`);
                return;
              }

              const baseUrl = this.getBaseUrl();
              const headers = await this.getAuthHeaders();

              let createdCount = 0;
              for (let i = 1; i < lines.length; i++) {
                const cells = parseLine(lines[i]).map(v => v.replace(/^\"|\"$/g, '').trim());
                const get = (col) => {
                  const idx = indexOf(col);
                  return idx >= 0 ? (cells[idx] || '') : '';
                };

                const payload = {
                  name: get('name'),
                  address: get('address'),
                  city: get('city'),
                  province: get('province'),
                  postalCode: get('postalCode'),
                  phone: get('phone'),
                  email: get('email'),
                  licenseNumber: get('licenseNumber')
                };

                const resp = await fetch(`${baseUrl}/api/pharmacy`, {
                  method: 'POST',
                  headers,
                  body: JSON.stringify(payload)
                });

                const result = await resp.json();
                if (resp.ok && result.success) {
                  createdCount++;
                }
              }

              await this.loadPharmacies();
              alert(`Import complete. Created ${createdCount} pharmacy(ies).`);
            } catch (error) {
              console.error('Error importing pharmacies:', error);
              alert(error.message || 'Failed to import pharmacies.');
            }
          };

          input.click();
        },

        refreshPharmacies() {
          console.log('Refreshing pharmacies data...');
          this.loadPharmacies();
        },

        resetFilters() {
          this.searchQuery = '';
          this.selectedFilter = 'all';
          this.filterPharmacies();
        },

        async submitCreateTenant() {
          this.creatingTenant = true;
          this.createTenantError = '';
          this.createTenantSuccess = '';

          if (!this.createTenantForm.pharmacyName ||
              !this.createTenantForm.ownerFirstName ||
              !this.createTenantForm.ownerLastName ||
              !this.createTenantForm.email ||
              !this.createTenantForm.password ||
              !this.createTenantForm.confirmPassword) {
            this.createTenantError = 'Please fill in all required fields.';
            this.creatingTenant = false;
            return;
          }

          if (this.createTenantForm.password !== this.createTenantForm.confirmPassword) {
            this.createTenantError = 'Passwords do not match.';
            this.creatingTenant = false;
            return;
          }

          const payload = {
            pharmacyName: this.createTenantForm.pharmacyName.trim(),
            ownerFirstName: this.createTenantForm.ownerFirstName.trim(),
            ownerLastName: this.createTenantForm.ownerLastName.trim(),
            email: this.createTenantForm.email.trim().toLowerCase(),
            password: this.createTenantForm.password,
            confirmPassword: this.createTenantForm.confirmPassword,
            phoneNumber: this.createTenantForm.phoneNumber ? this.createTenantForm.phoneNumber.trim() : null,
            pharmacyAddress: this.createTenantForm.pharmacyAddress ? this.createTenantForm.pharmacyAddress.trim() : null,
            pharmacyCity: this.createTenantForm.pharmacyCity ? this.createTenantForm.pharmacyCity.trim() : null,
            pharmacyPostalCode: this.createTenantForm.pharmacyPostalCode ? this.createTenantForm.pharmacyPostalCode.trim() : null,
            licenseNumber: this.createTenantForm.licenseNumber ? this.createTenantForm.licenseNumber.trim() : null,
            selectedPlan: this.createTenantForm.selectedPlan,
            isTrialAccount: this.createTenantForm.isTrialAccount,
            trialDurationDays: this.createTenantForm.trialDurationDays
          };

          try {
            const baseUrl = this.apiBaseUrl || (window.UmiHealthInformationSystemsApiConfig && window.UmiHealthInformationSystemsApiConfig.baseUrl) || 'https://localhost:5123';
            const response = await fetch(`${baseUrl}/api/admin/tenants`, {
              method: 'POST',
              headers: await this.getAuthHeaders(),
              body: JSON.stringify(payload)
            });
            const result = await response.json();

            if (!response.ok || !result.success) {
              this.createTenantError = result.message || 'Failed to create tenant.';
              return;
            }

            this.createTenantSuccess = result.message || 'Tenant created successfully.';

            const created = result.data && result.data.pharmacy;
            if (created) {
              const item = {
                id: created.id,
                name: created.name,
                location: created.city || '',
                email: created.email,
                phone: created.phone,
                licenseNumber: created.licenseNumber,
                status: created.isActive ? 'active' : 'inactive',
                joinedDate: created.createdAt ? new Date(created.createdAt).toLocaleDateString() : ''
              };
              this.pharmacies.push(item);
              this.filteredPharmacies = [...this.pharmacies];
            }

            this.isAddPharmacyModalOpen = false;
          } catch (error) {
            console.error('Error creating tenant:', error);
            this.createTenantError = 'An unexpected error occurred while creating tenant.';
          } finally {
            this.creatingTenant = false;
          }
        },

        async getAuthHeaders() {
          const headers = { 'Content-Type': 'application/json' };

          try {
            if (window.UmiHealthInformationSystemsAuth && typeof window.UmiHealthInformationSystemsAuth.getAuthHeaders === 'function') {
              const extra = await window.UmiHealthInformationSystemsAuth.getAuthHeaders();
              return { ...headers, ...extra };
            }
          } catch (error) {
            console.error('Error getting auth headers from UmiHealthInformationSystemsAuth:', error);
          }

          let token = '';

          if (typeof sessionStorage !== 'undefined') {
            token = sessionStorage.getItem('UmiHealthInformationSystems_auth_token') ||
                    sessionStorage.getItem('authToken') ||
                    sessionStorage.getItem('token') ||
                    token;
          }

          if (!token && typeof localStorage !== 'undefined') {
            token = localStorage.getItem('UmiHealthInformationSystems_auth_token') ||
                    localStorage.getItem('authToken') ||
                    localStorage.getItem('token') ||
                    token;
          }

          if (token) {
            headers['Authorization'] = `Bearer ${token}`;
          }

          return headers;
        },

        handleLogout() {
          if (confirm('Are you sure you want to sign out?')) {
            // Clear session
            sessionStorage.clear();
            
            // Redirect to signin
            window.location.href = '../../public/signin.html';
          }
        }
      }
    }
  </script>

  <!-- Include API and Data Sync Services -->
  <script src="../shared/js/data-sync.js"></script>
  <script src="../shared/js/role-based-access.js"></script>
  <script src="../admin/js/admin-api.js"></script>
  <script src="js/super-admin-api.js"></script>

  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script></body>
</html>




<!DOCTYPE html>
<html lang="en" x-data="reports()">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Reports & Insights | UmiHealthInformationSystems Pharmacy Management</title>
  <link rel="icon" href="../../logo.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Glacial+Indifference:wght@400;500;600;700&family=Material+Symbols+Rounded:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/tailwind.output.css">
  <style>
    :root {
      --color-primary-blue: #2563EB;
      --color-accent-teal: #14B8A6;
      --color-text-white: #FFFFFF;
      --color-subtle-blue: #EFF6FF;
      --font-primary: 'Glacial Indifference', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: #0a0a0a;
      color: var(--color-text-white);
      font-family: 'Glacial Indifference', sans-serif;
      line-height: 1.5;
      min-height: 100vh;
      position: relative;
      background-image: 
        linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
    }

    /* Custom scrollbar styles */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* Firefox scrollbar */
    * {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.2) rgba(255, 255, 255, 0.05);
    }

    /* Fallback for browsers that don't support scrollbar styling */
    *::-webkit-scrollbar {
      width: 8px;
    }
    
    *::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }
    
    *::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }
    
    *::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .dashboard-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 280px;
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      text-align: center;
    }

    .sidebar-title {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      color: var(--color-accent-teal);
    }

    .sidebar-menu {
      flex: 1;
      padding: 1rem 0;
      overflow-y: auto;
    }

    .menu-section {
      margin-bottom: 2rem;
    }

    .menu-title {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      opacity: 0.6;
      padding: 0 1.5rem;
      margin-bottom: 0.5rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      color: var(--color-text-white);
      text-decoration: none;
      transition: all 0.3s ease;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .menu-item:hover {
      background: rgba(255, 255, 255, 0.1);
      opacity: 1;
    }

    .menu-item.active {
      background: rgba(20, 184, 166, 0.2);
      border-left: 3px solid var(--color-accent-teal);
      opacity: 1;
    }

    .menu-icon {
      font-size: 1.25rem;
      color: var(--color-accent-teal);
    }

    .sidebar-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Main Content Area */
    .main-content {
      flex: 1;
      margin-left: 280px;
      display: flex;
      flex-direction: column;
    }

    /* Header Styles */
    .header {
      height: 70px;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      position: sticky;
      top: 0;
      z-index: 999;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .header-logo {
      display: flex;
      align-items: center;
    }

    .header-logo img {
      width: 100px;
      height: 100px;
      object-fit: contain;
    }

    .page-title {
      font-size: 1.5rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .user-menu:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .user-avatar {
      width: 35px;
      height: 35px;
      background: var(--color-accent-teal);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
    }

    .user-info {
      display: flex;
      flex-direction: column;
    }

    .user-name {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .user-role {
      font-size: 0.75rem;
      opacity: 0.8;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .search-container {
      position: relative;
      width: 350px;
    }

    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .search-container .search-input {
      width: 100%;
      padding: 0.75rem 1rem 0.75rem 2.5rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      transition: all 0.3s ease;
    }

    .search-container .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-container .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--color-accent-teal);
      box-shadow: 0 0 0 2px rgba(20, 184, 166, 0.2);
    }

    .search-icon {
      position: absolute;
      left: 0.75rem;
      color: rgba(255, 255, 255, 0.6);
      font-size: 1.2rem;
      pointer-events: none;
    }

    .search-suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      margin-top: 0.5rem;
      max-height: 400px;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .suggestion-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .suggestion-item:last-child {
      border-bottom: none;
    }

    .suggestion-item:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .suggestion-icon {
      width: 40px;
      height: 40px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: var(--color-accent-teal);
    }

    .suggestion-content {
      flex: 1;
    }

    .suggestion-title {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.25rem;
    }

    .suggestion-description {
      font-size: 0.8rem;
      opacity: 0.7;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .suggestion-type {
      padding: 0.25rem 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      text-transform: uppercase;
    }

    /* Content Area */
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }

    /* Reports Grid */
    .reports-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 1.5rem;
    }

    .report-card {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
      transition: all 0.3s ease;
    }

    .report-card:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-2px);
    }

    .report-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .report-icon {
      width: 50px;
      height: 50px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: var(--color-accent-teal);
    }

    .report-title {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .report-description {
      opacity: 0.8;
      margin-bottom: 1.5rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .report-actions {
      display: flex;
      gap: 1rem;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-size: 0.9rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
    }

    .btn-primary {
      background: var(--color-accent-teal);
      color: white;
    }

    .btn-primary:hover {
      background: #0d9486;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: var(--color-text-white);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Mobile Responsiveness */
    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      color: var(--color-text-white);
      font-size: 1.5rem;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .header {
        padding: 0 1rem;
      }

      .content {
        padding: 1rem;
      }

      .reports-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>

    <!-- Backend Integration Libraries -->
    <script src="../../js/api-client.js"></script>
    <script src="../../js/auth-manager.js"></script>
    <script src="../shared/js/backend-integration-helper.js"></script>
    <script src="../shared/js/page-integration-template.js"></script>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" :class="{ 'open': mobileMenuOpen }">
      <div class="sidebar-header">
        <div class="sidebar-title">Umi Admin</div>
      </div>
      
      <nav class="sidebar-menu">
        <div class="menu-section">
          <div class="menu-title">Main</div>
          <a href="home.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">dashboard</span>
            Home
          </a>
          <a href="pharmacies.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">store</span>
            Pharmacies
          </a>
          <a href="users.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">people</span>
            Users
          </a>
          <a href="transactions.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">receipt_long</span>
            Transactions
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Management</div>
          <a href="analytics.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">analytics</span>
            Analytics
          </a>
          <a href="reports.html" class="menu-item active">
            <span class="material-symbols-rounded menu-icon">assessment</span>
            Reports
          </a>
          <a href="settings.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">account_circle</span>
            Account
          </a>
          <a href="security.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">security</span>
            Security
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Support</div>
          <a href="help.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">help_center</span>
            Help Center
          </a>
          <a href="logs.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">history</span>
            System Logs
          </a>
        </div>
      </nav>
      
      <div class="sidebar-footer">
        <a href="../../public/signin.html" class="menu-item" @click.prevent="handleLogout">
          <span class="material-symbols-rounded menu-icon">logout</span>
          Sign Out
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen">
            <span class="material-symbols-rounded">menu</span>
          </button>
          <div class="header-logo">
            <!-- Logo removed per request -->
          </div>
          <h1 class="page-title">Reports & Insights</h1>
        </div>
        
        <div class="header-right">
          <div class="search-container" x-data="searchComponent()">
            <div class="search-input-wrapper">
              <input 
                type="text" 
                class="search-input" 
                placeholder="Search pharmacies, users, transactions..."
                x-model="query"
                @input="handleSearch"
                @focus="showSuggestions = true"
                @blur="hideSuggestions"
              >
              <span class="material-symbols-rounded search-icon">search</span>
            </div>
            
            <!-- Search Suggestions Dropdown -->
            <div 
              class="search-suggestions" 
              x-show="showSuggestions && suggestions.length > 0"
              x-transition
            >
              <template x-for="suggestion in suggestions" :key="suggestion.id">
                <div class="suggestion-item" @click="selectSuggestion(suggestion)">
                  <div class="suggestion-icon">
                    <span class="material-symbols-rounded" x-text="suggestion.icon"></span>
                  </div>
                  <div class="suggestion-content">
                    <div class="suggestion-title" x-text="suggestion.title"></div>
                    <div class="suggestion-description" x-text="suggestion.description"></div>
                  </div>
                  <div class="suggestion-type" x-text="suggestion.type"></div>
                </div>
              </template>
            </div>
          </div>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content">
        <div class="reports-grid">
          <div class="report-card">
            <div class="report-header">
              <div class="report-icon">
                <span class="material-symbols-rounded">payments</span>
              </div>
              <div class="report-title">Financial Report</div>
            </div>
            <div class="report-description">
              Comprehensive financial analysis including revenue, expenses, and profit margins across all pharmacies.
            </div>
            <div class="report-actions">
              <button class="btn btn-primary" @click="generateReport('financial')">
                <span class="material-symbols-rounded">summarize</span>
                Generate
              </button>
              <button class="btn btn-secondary" @click="viewReport('financial')">
                <span class="material-symbols-rounded">visibility</span>
                View
              </button>
            </div>
          </div>

          <div class="report-card">
            <div class="report-header">
              <div class="report-icon">
                <span class="material-symbols-rounded">inventory</span>
              </div>
              <div class="report-title">Inventory Report</div>
            </div>
            <div class="report-description">
              Detailed inventory analysis showing stock levels, turnover rates, and medication usage patterns.
            </div>
            <div class="report-actions">
              <button class="btn btn-primary" @click="generateReport('inventory')">
                <span class="material-symbols-rounded">summarize</span>
                Generate
              </button>
              <button class="btn btn-secondary" @click="viewReport('inventory')">
                <span class="material-symbols-rounded">visibility</span>
                View
              </button>
            </div>
          </div>

          <div class="report-card">
            <div class="report-header">
              <div class="report-icon">
                <span class="material-symbols-rounded">people</span>
              </div>
              <div class="report-title">User Activity Report</div>
            </div>
            <div class="report-description">
              Analysis of user engagement, login patterns, and activity across different user roles and pharmacies.
            </div>
            <div class="report-actions">
              <button class="btn btn-primary" @click="generateReport('users')">
                <span class="material-symbols-rounded">summarize</span>
                Generate
              </button>
              <button class="btn btn-secondary" @click="viewReport('users')">
                <span class="material-symbols-rounded">visibility</span>
                View
              </button>
            </div>
          </div>

          <div class="report-card">
            <div class="report-header">
              <div class="report-icon">
                <span class="material-symbols-rounded">receipt_long</span>
              </div>
              <div class="report-title">Transaction Report</div>
            </div>
            <div class="report-description">
              Complete transaction analysis including sales trends, payment methods, and customer behavior patterns.
            </div>
            <div class="report-actions">
              <button class="btn btn-primary" @click="generateReport('transactions')">
                <span class="material-symbols-rounded">summarize</span>
                Generate
              </button>
              <button class="btn btn-secondary" @click="viewReport('transactions')">
                <span class="material-symbols-rounded">visibility</span>
                View
              </button>
            </div>
          </div>

          <div class="report-card">
            <div class="report-header">
              <div class="report-icon">
                <span class="material-symbols-rounded">store</span>
              </div>
              <div class="report-title">Pharmacy Performance</div>
            </div>
            <div class="report-description">
              Comparative analysis of pharmacy performance metrics including revenue, customer satisfaction, and operational efficiency.
            </div>
            <div class="report-actions">
              <button class="btn btn-primary" @click="generateReport('pharmacy-performance')">
                <span class="material-symbols-rounded">summarize</span>
                Generate
              </button>
              <button class="btn btn-secondary" @click="viewReport('pharmacy-performance')">
                <span class="material-symbols-rounded">visibility</span>
                View
              </button>
            </div>
          </div>

          <div class="report-card">
            <div class="report-header">
              <div class="report-icon">
                <span class="material-symbols-rounded">medication</span>
              </div>
              <div class="report-title">Medication Usage Report</div>
            </div>
            <div class="report-description">
              Analysis of prescription patterns, medication usage trends, and compliance metrics across the platform.
            </div>
            <div class="report-actions">
              <button class="btn btn-primary" @click="generateReport('medication-usage')">
                <span class="material-symbols-rounded">summarize</span>
                Generate
              </button>
              <button class="btn btn-secondary" @click="viewReport('medication-usage')">
                <span class="material-symbols-rounded">visibility</span>
                View
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    function searchComponent() {
      return {
        // Initialize backend integration
        const pageIntegration = new PageIntegrationTemplate('super-admin-reports', {
            requireAuth: true,
            enableRealTime: false,
            enableCaching: true
        });
        
        return {
            ...pageIntegration,
            backendHelper: window.backendHelper,
            apiClient: window.apiClient,
            authManager: window.authManager,
            isAuthenticated: false,
            loading: false,
            error: null,
        query: '',
        showSuggestions: false,
        suggestions: [],
        allSuggestions: [
          { id: 1, title: 'Pharmacies', description: 'Manage pharmacy tenants', type: 'page', icon: 'store', url: 'pharmacies.html' },
          { id: 2, title: 'Users', description: 'User management', type: 'page', icon: 'people', url: 'users.html' },
          { id: 3, title: 'Transactions', description: 'Transaction history', type: 'page', icon: 'receipt_long', url: 'transactions.html' },
          { id: 4, title: 'Analytics', description: 'System analytics', type: 'page', icon: 'analytics', url: 'analytics.html' },
          { id: 5, title: 'Reports', description: 'Reports & insights', type: 'page', icon: 'assessment', url: 'reports.html' },
          { id: 6, title: 'Security', description: 'Security center', type: 'page', icon: 'security', url: 'security.html' },
          { id: 7, title: 'Settings', description: 'Account & system settings', type: 'page', icon: 'settings', url: 'settings.html' },
          { id: 8, title: 'Help Center', description: 'Support and documentation', type: 'page', icon: 'help_center', url: 'help.html' },
          { id: 9, title: 'System Logs', description: 'System activity logs', type: 'page', icon: 'history', url: 'logs.html' }
        ],

        handleSearch() {
          const q = (this.query || '').trim().toLowerCase();
          if (q.length < 2) {
            this.suggestions = [];
            return;
          }

          this.suggestions = this.allSuggestions
            .filter(s =>
              (s.title && s.title.toLowerCase().includes(q)) ||
              (s.description && s.description.toLowerCase().includes(q)) ||
              (s.type && s.type.toLowerCase().includes(q))
            )
            .slice(0, 8);
        },

        selectSuggestion(suggestion) {
          this.query = suggestion.title;
          this.showSuggestions = false;
          if (suggestion && suggestion.url) {
            window.location.href = suggestion.url;
          }
        },

        hideSuggestions() {
          setTimeout(() => {
            this.showSuggestions = false;
          }, 200);
        }
      }
    }

    function reports() {
      return {
        userName: '',
        userEmail: '',
        mobileMenuOpen: false,
        showUserMenu: false,

        async init() {
            try {
                // Check authentication
                this.isAuthenticated = this.authManager?.isAuthenticated() || false;
                
                if (!this.isAuthenticated) {
                    this.error = 'Please login to access this page';
                    return;
                }
                
                // Initialize backend integration
                await this.backendHelper.initPage('super-admin-reports', {
                    enableRealTime: false,
                    initialData: this.getInitialDataConfig()
                });
                
                // Load page data
                await this.loadPageData();
                
                // Set up event listeners
                this.setupEventListeners();
                
                console.log('super-admin-reports page initialized with backend integration');
            } catch (error) {
                console.error('Failed to initialize super-admin-reports page:', error);
                this.error = 'Failed to initialize page';
            }
        },
          
          // Close mobile menu when clicking outside
          document.addEventListener('click', (e) => {
            if (!e.target.closest('.sidebar') && !e.target.closest('.mobile-menu-toggle')) {
              this.mobileMenuOpen = false;
            }
            if (!e.target.closest('.user-menu')) {
              this.showUserMenu = false;
            }
          });
        },

        generateReport(type) {
          console.log(`Generating ${type} report...`);
          alert(`${type.charAt(0).toUpperCase() + type.slice(1)} report generation coming soon!`);
        },

        viewReport(type) {
          console.log(`Viewing ${type} report...`);
          alert(`${type.charAt(0).toUpperCase() + type.slice(1)} report viewer coming soon!`);
        },

        handleLogout() {
          if (confirm('Are you sure you want to sign out?')) {
            // Clear session
            sessionStorage.clear();
            
            // Redirect to signin
            window.location.href = '../../public/signin.html';
          }
        }
      }
    }
  </script>

  <!-- Include API and Data Sync Services -->
  <script src="../shared/js/data-sync.js"></script>
  <script src="../shared/js/role-based-access.js"></script>
  <script src="../admin/js/admin-api.js"></script>
  <script src="js/super-admin-api.js"></script>

  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script></body>
</html>




<!DOCTYPE html>
<html lang="en" x-data="security()">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Security Center | UmiHealthInformationSystems Pharmacy Management</title>
  <link rel="icon" href="../../logo.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Glacial+Indifference:wght@400;500;600;700&family=Material+Symbols+Rounded:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/tailwind.output.css">
  <style>
    :root {
      --color-primary-blue: #2563EB;
      --color-accent-teal: #14B8A6;
      --color-text-white: #FFFFFF;
      --color-subtle-blue: #EFF6FF;
      --font-primary: 'Glacial Indifference', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: #0a0a0a;
      color: var(--color-text-white);
      font-family: 'Glacial Indifference', sans-serif;
      line-height: 1.5;
      min-height: 100vh;
      position: relative;
      background-image: 
        linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
    }

    /* Custom scrollbar styles */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* Firefox scrollbar */
    * {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.2) rgba(255, 255, 255, 0.05);
    }

    /* Fallback for browsers that don't support scrollbar styling */
    *::-webkit-scrollbar {
      width: 8px;
    }
    
    *::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }
    
    *::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }
    
    *::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .dashboard-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 280px;
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      text-align: center;
    }

    .sidebar-title {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      color: var(--color-accent-teal);
    }

    .sidebar-menu {
      flex: 1;
      padding: 1rem 0;
      overflow-y: auto;
    }

    .menu-section {
      margin-bottom: 2rem;
    }

    .menu-title {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      opacity: 0.6;
      padding: 0 1.5rem;
      margin-bottom: 0.5rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      color: var(--color-text-white);
      text-decoration: none;
      transition: all 0.3s ease;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .menu-item:hover {
      background: rgba(255, 255, 255, 0.1);
      opacity: 1;
    }

    .menu-item.active {
      background: rgba(20, 184, 166, 0.2);
      border-left: 3px solid var(--color-accent-teal);
      opacity: 1;
    }

    .menu-icon {
      font-size: 1.25rem;
      color: var(--color-accent-teal);
    }

    .sidebar-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Main Content Area */
    .main-content {
      flex: 1;
      margin-left: 280px;
      display: flex;
      flex-direction: column;
    }

    /* Header Styles */
    .header {
      height: 70px;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      position: sticky;
      top: 0;
      z-index: 999;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .header-logo {
      display: flex;
      align-items: center;
    }

    .header-logo img {
      width: 100px;
      height: 100px;
      object-fit: contain;
    }

    .page-title {
      font-size: 1.5rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .user-menu:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .user-avatar {
      width: 35px;
      height: 35px;
      background: var(--color-accent-teal);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
    }

    .user-info {
      display: flex;
      flex-direction: column;
    }

    .user-name {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .user-role {
      font-size: 0.75rem;
      opacity: 0.8;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .search-container {
      position: relative;
      width: 350px;
    }

    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .search-container .search-input {
      width: 100%;
      padding: 0.75rem 1rem 0.75rem 2.5rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      transition: all 0.3s ease;
    }

    .search-container .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-container .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--color-accent-teal);
      box-shadow: 0 0 0 2px rgba(20, 184, 166, 0.2);
    }

    .search-icon {
      position: absolute;
      left: 0.75rem;
      color: rgba(255, 255, 255, 0.6);
      font-size: 1.2rem;
      pointer-events: none;
    }

    .search-suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      margin-top: 0.5rem;
      max-height: 400px;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .suggestion-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .suggestion-item:last-child {
      border-bottom: none;
    }

    .suggestion-item:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .suggestion-icon {
      width: 40px;
      height: 40px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: var(--color-accent-teal);
    }

    .suggestion-content {
      flex: 1;
    }

    .suggestion-title {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.25rem;
    }

    .suggestion-description {
      font-size: 0.8rem;
      opacity: 0.7;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .suggestion-type {
      padding: 0.25rem 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      text-transform: uppercase;
    }

    /* Content Area */
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }

    /* Security Grid */
    .security-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 1.5rem;
    }

    .security-card {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
    }

    .card-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .card-icon {
      width: 50px;
      height: 50px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      color: var(--color-accent-teal);
    }

    .card-title {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .card-description {
      opacity: 0.8;
      margin-bottom: 1.5rem;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-size: 0.9rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-primary {
      background: var(--color-accent-teal);
      color: white;
    }

    .btn-primary:hover {
      background: #0d9486;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: var(--color-text-white);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Mobile Responsiveness */
    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      color: var(--color-text-white);
      font-size: 1.5rem;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .header {
        padding: 0 1rem;
      }

      .content {
        padding: 1rem;
      }

      .security-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>

    <!-- Backend Integration Libraries -->
    <script src="../../js/api-client.js"></script>
    <script src="../../js/auth-manager.js"></script>
    <script src="../shared/js/backend-integration-helper.js"></script>
    <script src="../shared/js/page-integration-template.js"></script>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" :class="{ 'open': mobileMenuOpen }">
      <div class="sidebar-header">
        <div class="sidebar-title">Umi Admin</div>
      </div>
      
      <nav class="sidebar-menu">
        <div class="menu-section">
          <div class="menu-title">Main</div>
          <a href="home.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">dashboard</span>
            Home
          </a>
          <a href="pharmacies.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">store</span>
            Pharmacies
          </a>
          <a href="users.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">people</span>
            Users
          </a>
          <a href="transactions.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">receipt_long</span>
            Transactions
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Management</div>
          <a href="analytics.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">analytics</span>
            Analytics
          </a>
          <a href="reports.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">assessment</span>
            Reports
          </a>
          <a href="settings.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">account_circle</span>
            Account
          </a>
          <a href="security.html" class="menu-item active">
            <span class="material-symbols-rounded menu-icon">security</span>
            Security
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Support</div>
          <a href="help.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">help_center</span>
            Help Center
          </a>
          <a href="logs.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">history</span>
            System Logs
          </a>
        </div>
      </nav>
      
      <div class="sidebar-footer">
        <a href="../../public/signin.html" class="menu-item" @click.prevent="handleLogout">
          <span class="material-symbols-rounded menu-icon">logout</span>
          Sign Out
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen">
            <span class="material-symbols-rounded">menu</span>
          </button>
          <div class="header-logo">
            <!-- Logo removed per request -->
          </div>
          <h1 class="page-title">Security Center</h1>
        </div>
        
        <div class="header-right">
          <div class="search-container" x-data="searchComponent()">
            <div class="search-input-wrapper">
              <input 
                type="text" 
                class="search-input" 
                placeholder="Search pharmacies, users, transactions..."
                x-model="query"
                @input="handleSearch"
                @focus="showSuggestions = true"
                @blur="hideSuggestions"
              >
              <span class="material-symbols-rounded search-icon">search</span>
            </div>
            
            <!-- Search Suggestions Dropdown -->
            <div 
              class="search-suggestions" 
              x-show="showSuggestions && suggestions.length > 0"
              x-transition
            >
              <template x-for="suggestion in suggestions" :key="suggestion.id">
                <div class="suggestion-item" @click="selectSuggestion(suggestion)">
                  <div class="suggestion-icon">
                    <span class="material-symbols-rounded" x-text="suggestion.icon"></span>
                  </div>
                  <div class="suggestion-content">
                    <div class="suggestion-title" x-text="suggestion.title"></div>
                    <div class="suggestion-description" x-text="suggestion.description"></div>
                  </div>
                  <div class="suggestion-type" x-text="suggestion.type"></div>
                </div>
              </template>
            </div>
          </div>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content">
        <div class="security-grid">
          <div class="security-card">
            <div class="card-header">
              <div class="card-icon">
                <span class="material-symbols-rounded">password</span>
              </div>
              <div class="card-title">Password Policy</div>
            </div>
            <div class="card-description">
              Configure password requirements and security policies for all user accounts.
            </div>
            <button class="btn btn-primary" @click="configurePasswordPolicy">
              <span class="material-symbols-rounded">settings</span>
              Configure
            </button>
          </div>

          <div class="security-card">
            <div class="card-header">
              <div class="card-icon">
                <span class="material-symbols-rounded">admin_panel_settings</span>
              </div>
              <div class="card-title">Access Control</div>
            </div>
            <div class="card-description">
              Manage user permissions and access levels across the system.
            </div>
            <button class="btn btn-primary" @click="manageAccess">
              <span class="material-symbols-rounded">manage_accounts</span>
              Manage
            </button>
          </div>

          <div class="security-card">
            <div class="card-header">
              <div class="card-icon">
                <span class="material-symbols-rounded">security_update_good</span>
              </div>
              <div class="card-title">Two-Factor Authentication</div>
            </div>
            <div class="card-description">
              Enable and configure 2FA for enhanced security of user accounts.
            </div>
            <button class="btn btn-primary" @click="configure2FA">
              <span class="material-symbols-rounded">verified_user</span>
              Setup
            </button>
          </div>

          <div class="security-card">
            <div class="card-header">
              <div class="card-icon">
                <span class="material-symbols-rounded">gpp_good</span>
              </div>
              <div class="card-title">Security Audit</div>
            </div>
            <div class="card-description">
              Review security logs and audit trails for system compliance.
            </div>
            <button class="btn btn-primary" @click="runSecurityAudit">
              <span class="material-symbols-rounded">fact_check</span>
              Run Audit
            </button>
          </div>

          <div class="security-card">
            <div class="card-header">
              <div class="card-icon">
                <span class="material-symbols-rounded">block</span>
              </div>
              <div class="card-title">Blocked IPs</div>
            </div>
            <div class="card-description">
              Manage blocked IP addresses and security blacklists.
            </div>
            <button class="btn btn-primary" @click="manageBlockedIPs">
              <span class="material-symbols-rounded">list</span>
              View List
            </button>
          </div>

          <div class="security-card">
            <div class="card-header">
              <div class="card-icon">
                <span class="material-symbols-rounded">history</span>
              </div>
              <div class="card-title">Login History</div>
            </div>
            <div class="card-description">
              Monitor login attempts and detect suspicious activity patterns.
            </div>
            <button class="btn btn-primary" @click="viewLoginHistory">
              <span class="material-symbols-rounded">visibility</span>
              View History
            </button>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    function searchComponent() {
      return {
        // Initialize backend integration
        const pageIntegration = new PageIntegrationTemplate('super-admin-security', {
            requireAuth: true,
            enableRealTime: false,
            enableCaching: true
        });
        
        return {
            ...pageIntegration,
            backendHelper: window.backendHelper,
            apiClient: window.apiClient,
            authManager: window.authManager,
            isAuthenticated: false,
            loading: false,
            error: null,
        query: '',
        showSuggestions: false,
        suggestions: [],
        allSuggestions: [
          { id: 1, title: 'Pharmacies', description: 'Manage pharmacy tenants', type: 'page', icon: 'store', url: 'pharmacies.html' },
          { id: 2, title: 'Users', description: 'User management', type: 'page', icon: 'people', url: 'users.html' },
          { id: 3, title: 'Transactions', description: 'Transaction history', type: 'page', icon: 'receipt_long', url: 'transactions.html' },
          { id: 4, title: 'Analytics', description: 'System analytics', type: 'page', icon: 'analytics', url: 'analytics.html' },
          { id: 5, title: 'Reports', description: 'Reports & insights', type: 'page', icon: 'assessment', url: 'reports.html' },
          { id: 6, title: 'Security', description: 'Security center', type: 'page', icon: 'security', url: 'security.html' },
          { id: 7, title: 'Settings', description: 'Account & system settings', type: 'page', icon: 'settings', url: 'settings.html' },
          { id: 8, title: 'Help Center', description: 'Support and documentation', type: 'page', icon: 'help_center', url: 'help.html' },
          { id: 9, title: 'System Logs', description: 'System activity logs', type: 'page', icon: 'history', url: 'logs.html' }
        ],

        handleSearch() {
          const q = (this.query || '').trim().toLowerCase();
          if (q.length < 2) {
            this.suggestions = [];
            return;
          }

          this.suggestions = this.allSuggestions
            .filter(s =>
              (s.title && s.title.toLowerCase().includes(q)) ||
              (s.description && s.description.toLowerCase().includes(q)) ||
              (s.type && s.type.toLowerCase().includes(q))
            )
            .slice(0, 8);
        },

        selectSuggestion(suggestion) {
          this.query = suggestion.title;
          this.showSuggestions = false;
          if (suggestion && suggestion.url) {
            window.location.href = suggestion.url;
          }
        },

        hideSuggestions() {
          setTimeout(() => {
            this.showSuggestions = false;
          }, 200);
        }
      }
    }

    function security() {
      return {
        userName: '',
        userEmail: '',
        mobileMenuOpen: false,
        showUserMenu: false,

        async init() {
            try {
                // Check authentication
                this.isAuthenticated = this.authManager?.isAuthenticated() || false;
                
                if (!this.isAuthenticated) {
                    this.error = 'Please login to access this page';
                    return;
                }
                
                // Initialize backend integration
                await this.backendHelper.initPage('super-admin-security', {
                    enableRealTime: false,
                    initialData: this.getInitialDataConfig()
                });
                
                // Load page data
                await this.loadPageData();
                
                // Set up event listeners
                this.setupEventListeners();
                
                console.log('super-admin-security page initialized with backend integration');
            } catch (error) {
                console.error('Failed to initialize super-admin-security page:', error);
                this.error = 'Failed to initialize page';
            }
        },
            if (!e.target.closest('.user-menu')) {
              this.showUserMenu = false;
            }
          });
        },

        configurePasswordPolicy() {
          console.log('Configuring password policy...');
          alert('Password policy configuration coming soon!');
        },

        manageAccess() {
          console.log('Managing access control...');
          alert('Access control management coming soon!');
        },

        configure2FA() {
          console.log('Configuring 2FA...');
          alert('Two-factor authentication setup coming soon!');
        },

        runSecurityAudit() {
          console.log('Running security audit...');
          alert('Security audit initiated. Results will be available shortly.');
        },

        manageBlockedIPs() {
          console.log('Managing blocked IPs...');
          alert('Blocked IP management coming soon!');
        },

        viewLoginHistory() {
          console.log('Viewing login history...');
          alert('Login history viewer coming soon!');
        },

        handleLogout() {
          if (confirm('Are you sure you want to sign out?')) {
            // Clear session
            sessionStorage.clear();
            
            // Redirect to signin
            window.location.href = '../../public/signin.html';
          }
        }
      }
    }
  </script>

  <!-- Include API and Data Sync Services -->
  <script src="../shared/js/data-sync.js"></script>
  <script src="../shared/js/role-based-access.js"></script>
  <script src="../admin/js/admin-api.js"></script>
  <script src="js/super-admin-api.js"></script>

  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script></body>
</html>




<!DOCTYPE html>
<html lang="en" x-data="settings()">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>System Settings | UmiHealthInformationSystems Pharmacy Management</title>
  <link rel="icon" href="../../logo.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Glacial+Indifference:wght@400;500;600;700&family=Material+Symbols+Rounded:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Glacial+Indifference:wght@400;500;600;700&family=Material+Symbols+Rounded:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/tailwind.output.css">
  <style>
    :root {
      --color-primary-blue: #2563EB;
      --color-accent-teal: #14B8A6;
      --color-text-white: #FFFFFF;
      --color-subtle-blue: #EFF6FF;
      --font-primary: 'Glacial Indifference', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: #0a0a0a;
      color: var(--color-text-white);
      font-family: 'Glacial Indifference', sans-serif;
      line-height: 1.5;
      min-height: 100vh;
      position: relative;
      background-image: 
        linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
    }

    /* Custom scrollbar styles */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* Firefox scrollbar */
    * {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.2) rgba(255, 255, 255, 0.05);
    }

    .dashboard-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 280px;
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      text-align: center;
    }

    .sidebar-title {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      color: var(--color-accent-teal);
    }

    .sidebar-search {
      display: none;
      padding: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    .sidebar-search .search-container {
      width: 100%;
    }

    .sidebar-menu {
      flex: 1;
      padding: 1rem 0;
      overflow-y: auto;
    }

    .menu-section {
      margin-bottom: 2rem;
    }

    .menu-title {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      opacity: 0.6;
      padding: 0 1.5rem;
      margin-bottom: 0.5rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      color: var(--color-text-white);
      text-decoration: none;
      transition: all 0.3s ease;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .menu-item:hover {
      background: rgba(255, 255, 255, 0.1);
      opacity: 1;
    }

    .menu-item.active {
      background: rgba(20, 184, 166, 0.2);
      border-left: 3px solid var(--color-accent-teal);
      opacity: 1;
    }

    .menu-icon {
      font-size: 1.25rem;
      color: var(--color-accent-teal);
    }

    .sidebar-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Main Content Area */
    .main-content {
      flex: 1;
      margin-left: 280px;
      display: flex;
      flex-direction: column;
    }

    /* Header Styles */
    .header {
      height: 70px;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      position: sticky;
      top: 0;
      z-index: 999;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .header-logo {
      display: flex;
      align-items: center;
    }

    .header-logo img {
      width: 100px;
      height: 100px;
      object-fit: contain;
    }

    .page-title {
      font-size: 1.5rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .user-menu:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .user-avatar {
      width: 35px;
      height: 35px;
      background: var(--color-accent-teal);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
    }

    .user-info {
      display: flex;
      flex-direction: column;
    }

    .user-name {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .user-role {
      font-size: 0.75rem;
      opacity: 0.8;
      font-family: 'Glacial Indifference', sans-serif;
    }

    /* Search Container Styles */
    .search-container {
      position: relative;
      width: 300px;
    }

    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .search-input {
      width: 100%;
      padding: 0.75rem 1rem 0.75rem 2.5rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      transition: all 0.3s ease;
    }

    .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--color-accent-teal);
      box-shadow: 0 0 0 2px rgba(20, 184, 166, 0.2);
    }

    .search-icon {
      position: absolute;
      left: 0.75rem;
      color: rgba(255, 255, 255, 0.6);
      font-size: 1.2rem;
      pointer-events: none;
    }

    .search-suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      margin-top: 0.5rem;
      max-height: 300px;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .suggestion-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .suggestion-item:last-child {
      border-bottom: none;
    }

    .suggestion-item:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .suggestion-icon {
      width: 40px;
      height: 40px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: var(--color-accent-teal);
    }

    .suggestion-content {
      flex: 1;
    }

    .suggestion-title {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.25rem;
    }

    .suggestion-description {
      font-size: 0.8rem;
      opacity: 0.7;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .suggestion-type {
      padding: 0.25rem 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      text-transform: uppercase;
    }

    /* Tabs Container */
    .tabs-container {
      width: 100%;
    }

    .tabs-header {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 2rem;
      overflow-x: auto;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .tab-button {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      color: rgba(255, 255, 255, 0.7);
      font-size: 0.9rem;
      font-weight: 500;
      font-family: 'Glacial Indifference', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
      white-space: nowrap;
    }

    .tab-button:hover {
      background: rgba(255, 255, 255, 0.1);
      color: var(--color-text-white);
    }

    .tab-button.active {
      background: var(--color-accent-teal);
      color: white;
      border-color: var(--color-accent-teal);
    }

    .tabs-content {
      width: 100%;
    }

    .tab-panel {
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Payment Gateway Styles */
    .payment-gateway {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      margin-bottom: 1.5rem;
      overflow: hidden;
    }

    .gateway-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      background: rgba(255, 255, 255, 0.05);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .gateway-info h5 {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .gateway-status {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .gateway-status.active {
      background: rgba(16, 185, 129, 0.2);
      color: #10B981;
    }

    .gateway-status.inactive {
      background: rgba(244, 76, 76, 0.2);
      color: #FCA5A5;
    }

    .gateway-settings {
      padding: 1.5rem;
    }

    /* Form Switch */
    .form-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }

    .form-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .switch {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(255, 255, 255, 0.2);
      transition: .4s;
      border-radius: 34px;
    }

    .switch:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .switch {
      background-color: var(--color-accent-teal);
    }

    input:checked + .switch:before {
      transform: translateX(26px);
    }

    /* Roles & Permissions Styles */
    .roles-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .role-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 1.5rem;
      transition: all 0.3s ease;
    }

    .role-card:hover {
      background: rgba(255, 255, 255, 0.08);
      transform: translateY(-2px);
    }

    .role-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1rem;
    }

    .role-info h5 {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .role-count {
      font-size: 0.8rem;
      opacity: 0.7;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .role-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .role-badge.admin {
      background: rgba(59, 130, 246, 0.2);
      color: #60A5FA;
    }

    .role-badge.standard {
      background: rgba(156, 163, 175, 0.2);
      color: #9CA3AF;
    }

    .role-description {
      font-size: 0.9rem;
      opacity: 0.8;
      margin-bottom: 1rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .role-permissions {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .permission-tag {
      padding: 0.25rem 0.75rem;
      background: rgba(20, 184, 166, 0.2);
      color: var(--color-accent-teal);
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 500;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .permission-matrix {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      overflow: hidden;
    }

    .matrix-table {
      width: 100%;
      border-collapse: collapse;
    }

    .matrix-table th {
      background: rgba(255, 255, 255, 0.05);
      padding: 1rem;
      text-align: left;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .matrix-table td {
      padding: 0.75rem 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .check {
      color: #10B981;
      font-weight: bold;
    }

    .cross {
      color: #FCA5A5;
      font-weight: bold;
    }

    /* Form Groups */
    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .form-input {
      width: 100%;
      padding: 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .form-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--color-accent-teal);
    }

    .form-select {
      width: 100%;
      padding: 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .form-select option {
      background: #0a0a0a;
      color: var(--color-text-white);
    }

    .form-checkbox {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      cursor: pointer;
    }

    .form-checkbox input {
      width: 18px;
      height: 18px;
      accent-color: var(--color-accent-teal);
    }

    .form-actions {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .input-group {
      display: flex;
      gap: 0.5rem;
    }

    .input-group .form-input {
      flex: 1;
    }

    /* Content Area */
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }

    /* Settings Sections */
    .settings-container {
      display: grid;
      gap: 2rem;
    }

    .settings-section {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .section-icon {
      width: 40px;
      height: 40px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
      color: var(--color-accent-teal);
    }

    .section-title {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .section-description {
      opacity: 0.8;
      margin-bottom: 1.5rem;
    }

    /* Form Styles */
    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .form-input {
      width: 100%;
      padding: 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .form-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .form-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.5);
    }

    .form-select {
      width: 100%;
      padding: 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .form-select:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.5);
    }

    .form-select option {
      background: #0a0a0a;
      color: var(--color-text-white);
    }

    .form-checkbox {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      cursor: pointer;
    }

    .form-checkbox input[type="checkbox"] {
      width: 20px;
      height: 20px;
      accent-color: var(--color-accent-teal);
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-size: 0.9rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-primary {
      background: var(--color-accent-teal);
      color: white;
    }

    .btn-primary:hover {
      background: #0d9486;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: var(--color-text-white);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .btn-danger {
      background: rgba(244, 76, 76, 0.2);
      color: #FCA5A5;
      border: 1px solid rgba(244, 76, 76, 0.3);
    }

    .btn-danger:hover {
      background: rgba(244, 76, 76, 0.3);
    }

    /* Mobile Responsiveness */
    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      color: var(--color-text-white);
      font-size: 1.5rem;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
        width: 280px;
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .header {
        padding: 0 1rem;
        justify-content: center;
        position: relative;
      }

      .header-left {
        gap: 1rem;
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
      }

      .header-logo {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
      }

      .header-logo img {
        width: 80px;
        height: 80px;
      }

      .page-title {
        display: none;
      }

      .header-right {
        display: none;
      }

      .sidebar-search {
        display: block;
        padding: 1rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      }

      .content {
        padding: 1rem;
      }

      .tabs-header {
        flex-wrap: wrap;
        gap: 0.25rem;
      }

      .tab-button {
        padding: 0.5rem 0.75rem;
        font-size: 0.8rem;
      }

      .tab-button span {
        display: none;
      }

      .roles-grid {
        grid-template-columns: 1fr;
      }

      .payment-gateway {
        margin-bottom: 1rem;
      }

      .form-actions {
        flex-direction: column;
      }

      .permission-matrix {
        overflow-x: auto;
      }
    }
  </style>

    <!-- Backend Integration Libraries -->
    <script src="../../js/api-client.js"></script>
    <script src="../../js/auth-manager.js"></script>
    <script src="../shared/js/backend-integration-helper.js"></script>
    <script src="../shared/js/page-integration-template.js"></script>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" :class="{ 'open': mobileMenuOpen }">
      <div class="sidebar-header">
        <div class="sidebar-title">Umi Admin</div>
      </div>
      
      <!-- Mobile Search Bar -->
      <div class="sidebar-search">
        <div class="search-container" x-data="searchComponent()">
          <div class="search-input-wrapper">
            <input 
              type="text" 
              class="search-input" 
              placeholder="Search settings..."
              x-model="query"
              @input="handleSearch"
              @focus="showSuggestions = true"
              @blur="hideSuggestions"
            >
            <span class="material-symbols-rounded search-icon">search</span>
          </div>
          
          <!-- Search Suggestions Dropdown -->
          <div 
            class="search-suggestions" 
            x-show="showSuggestions && suggestions.length > 0"
            x-transition
          >
            <template x-for="suggestion in suggestions" :key="suggestion.id">
              <div class="suggestion-item" @click="selectSuggestion(suggestion)">
                <div class="suggestion-icon">
                  <span class="material-symbols-rounded" x-text="suggestion.icon"></span>
                </div>
                <div class="suggestion-content">
                  <div class="suggestion-title" x-text="suggestion.title"></div>
                  <div class="suggestion-description" x-text="suggestion.description"></div>
                </div>
                <div class="suggestion-type" x-text="suggestion.type"></div>
              </div>
            </template>
          </div>
        </div>
      </div>
      
      <nav class="sidebar-menu">
        <div class="menu-section">
          <div class="menu-title">Main</div>
          <a href="home.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">dashboard</span>
            Home
          </a>
          <a href="pharmacies.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">store</span>
            Pharmacies
          </a>
          <a href="users.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">people</span>
            Users
          </a>
          <a href="transactions.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">receipt_long</span>
            Transactions
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Management</div>
          <a href="analytics.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">analytics</span>
            Analytics
          </a>
          <a href="reports.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">assessment</span>
            Reports
          </a>
          <a href="settings.html" class="menu-item active">
            <span class="material-symbols-rounded menu-icon">account_circle</span>
            Account
          </a>
          <a href="security.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">security</span>
            Security
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Support</div>
          <a href="help.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">help_center</span>
            Help Center
          </a>
          <a href="logs.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">history</span>
            System Logs
          </a>
        </div>
      </nav>
      
      <div class="sidebar-footer">
        <a href="../../public/signin.html" class="menu-item" @click.prevent="handleLogout">
          <span class="material-symbols-rounded menu-icon">logout</span>
          Sign Out
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen">
            <span class="material-symbols-rounded">menu</span>
          </button>
          <div class="header-logo">
            <!-- Logo removed per request -->
          </div>
          <h1 class="page-title">System Settings</h1>
        </div>
        
        <div class="header-right">
          <div class="search-container" x-data="searchComponent()">
            <div class="search-input-wrapper">
              <input 
                type="text" 
                class="search-input" 
                placeholder="Search settings..."
                x-model="query"
                @input="handleSearch"
                @focus="showSuggestions = true"
                @blur="hideSuggestions"
              >
              <span class="material-symbols-rounded search-icon">search</span>
            </div>
            
            <!-- Search Suggestions Dropdown -->
            <div 
              class="search-suggestions" 
              x-show="showSuggestions && suggestions.length > 0"
              x-transition
            >
              <template x-for="suggestion in suggestions" :key="suggestion.id">
                <div class="suggestion-item" @click="selectSuggestion(suggestion)">
                  <div class="suggestion-icon">
                    <span class="material-symbols-rounded" x-text="suggestion.icon"></span>
                  </div>
                  <div class="suggestion-content">
                    <div class="suggestion-title" x-text="suggestion.title"></div>
                    <div class="suggestion-description" x-text="suggestion.description"></div>
                  </div>
                  <div class="suggestion-type" x-text="suggestion.type"></div>
                </div>
              </template>
            </div>
          </div>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content">
        <!-- Tabs Menu -->
        <div class="tabs-container">
          <div class="tabs-header">
            <button 
              class="tab-button" 
              :class="{ 'active': activeTab === 'general' }"
              @click="activeTab = 'general'"
            >
              <span class="material-symbols-rounded">settings</span>
              General
            </button>
            <button 
              class="tab-button" 
              :class="{ 'active': activeTab === 'backup' }"
              @click="activeTab = 'backup'"
            >
              <span class="material-symbols-rounded">backup</span>
              Backup
            </button>
            <button 
              class="tab-button" 
              :class="{ 'active': activeTab === 'email' }"
              @click="activeTab = 'email'"
            >
              <span class="material-symbols-rounded">email</span>
              Email
            </button>
            <button 
              class="tab-button" 
              :class="{ 'active': activeTab === 'payments' }"
              @click="activeTab = 'payments'"
            >
              <span class="material-symbols-rounded">payments</span>
              Payments
            </button>
            <button 
              class="tab-button" 
              :class="{ 'active': activeTab === 'api' }"
              @click="activeTab = 'api'"
            >
              <span class="material-symbols-rounded">api</span>
              API
            </button>
            <button 
              class="tab-button" 
              :class="{ 'active': activeTab === 'roles' }"
              @click="activeTab = 'roles'"
            >
              <span class="material-symbols-rounded">admin_panel_settings</span>
              Roles & Permissions
            </button>
            <button 
              class="tab-button" 
              :class="{ 'active': activeTab === 'security' }"
              @click="activeTab = 'security'"
            >
              <span class="material-symbols-rounded">security</span>
              Security
            </button>
            <button 
              class="tab-button" 
              :class="{ 'active': activeTab === 'maintenance' }"
              @click="activeTab = 'maintenance'"
            >
              <span class="material-symbols-rounded">build</span>
              Maintenance
            </button>
          </div>

          <div class="tabs-content">
            <!-- General Settings Tab -->
            <div class="tab-panel" x-show="activeTab === 'general'" x-transition>
              <div class="settings-section" id="general">
                <div class="section-header">
                  <div class="section-icon">
                    <span class="material-symbols-rounded">settings</span>
                  </div>
                  <div class="section-title">General Settings</div>
                </div>
                <div class="section-description">
                  Basic system configuration and preferences.
                </div>
                
                <div class="form-group">
                  <label class="form-label">System Name</label>
                  <input type="text" class="form-input" x-model="generalSettings.systemName">
                </div>
                
                <div class="form-group">
                  <label class="form-label">Default Language</label>
                  <select class="form-select" x-model="generalSettings.defaultLanguage">
                    <option value="English">English</option>
                    <option value="Bemba">Bemba</option>
                    <option value="Nyanja">Nyanja</option>
                  </select>
                </div>
                
                <div class="form-group">
                  <label class="form-label">Time Zone</label>
                  <select class="form-select" x-model="generalSettings.timeZone">
                    <option value="Africa/Lusaka">CAT - Central Africa Time</option>
                    <option value="UTC">UTC - Coordinated Universal Time</option>
                  </select>
                </div>
                
                <div class="form-group">
                  <label class="form-checkbox">
                    <input type="checkbox" x-model="generalSettings.enableSystemNotifications">
                    <span>Enable system notifications</span>
                  </label>
                </div>
                
                <button class="btn btn-primary" @click="saveGeneralSettings" :disabled="savingGeneralSettings">
                  <span class="material-symbols-rounded">save</span>
                  Save General Settings
                </button>
              </div>
            </div>

            <!-- Backup Settings Tab -->
            <div class="tab-panel" x-show="activeTab === 'backup'" x-transition>
              <div class="settings-section" id="backup">
                <div class="section-header">
                  <div class="section-icon">
                    <span class="material-symbols-rounded">backup</span>
                  </div>
                  <div class="section-title">System Backup</div>
                </div>
                <div class="section-description">
                  Configure automatic backups and data recovery options.
                </div>
                
                <div class="form-group">
                  <label class="form-label">Backup Frequency</label>
                  <select class="form-select" x-model="backupSettings.frequency">
                    <option value="Daily">Daily</option>
                    <option value="Weekly">Weekly</option>
                    <option value="Monthly">Monthly</option>
                  </select>
                </div>
                
                <div class="form-group">
                  <label class="form-label">Backup Location</label>
                  <input type="text" class="form-input" x-model="backupSettings.location">
                </div>
                
                <div class="form-group">
                  <label class="form-label">Retention Period (days)</label>
                  <input type="number" class="form-input" x-model="backupSettings.retentionDays">
                </div>
                
                <div class="form-group">
                  <label class="form-checkbox">
                    <input type="checkbox" x-model="backupSettings.enableAutoBackups">
                    <span>Enable automatic backups</span>
                  </label>
                </div>
                
                <div class="form-actions">
                  <button class="btn btn-primary" @click="saveBackupSettings">
                    <span class="material-symbols-rounded">save</span>
                    Save Backup Settings
                  </button>
                  <button class="btn btn-secondary" @click="createBackup">
                    <span class="material-symbols-rounded">backup</span>
                    Create Backup Now
                  </button>
                  <button class="btn btn-secondary" @click="restoreBackup">
                    <span class="material-symbols-rounded">restore</span>
                    Restore Backup
                  </button>
                </div>
              </div>
            </div>

            <!-- Email Settings Tab -->
            <div class="tab-panel" x-show="activeTab === 'email'" x-transition>
              <div class="settings-section" id="email">
                <div class="section-header">
                  <div class="section-icon">
                    <span class="material-symbols-rounded">email</span>
                  </div>
                  <div class="section-title">Email Configuration</div>
                </div>
                <div class="section-description">
                  Configure SMTP settings and email templates.
                </div>
                
                <div class="form-group">
                  <label class="form-label">SMTP Server</label>
                  <input type="text" class="form-input" x-model="emailSettings.smtpServer">
                </div>
                
                <div class="form-group">
                  <label class="form-label">Port</label>
                  <input type="number" class="form-input" x-model="emailSettings.port">
                </div>
                
                <div class="form-group">
                  <label class="form-label">Username</label>
                  <input type="email" class="form-input" x-model="emailSettings.username">
                </div>
                
                <div class="form-group">
                  <label class="form-label">Password</label>
                  <input type="password" class="form-input" placeholder="" x-model="emailSettings.password">
                </div>
                
                <div class="form-group">
                  <label class="form-checkbox">
                    <input type="checkbox" x-model="emailSettings.useSsl">
                    <span>Use SSL/TLS</span>
                  </label>
                </div>
                
                <div class="form-actions">
                  <button class="btn btn-primary" @click="saveEmailSettings">
                    <span class="material-symbols-rounded">save</span>
                    Save Email Settings
                  </button>
                  <button class="btn btn-secondary" @click="testEmailSettings">
                    <span class="material-symbols-rounded">send</span>
                    Send Test Email
                  </button>
                </div>
              </div>
            </div>

            <!-- Payment Gateways Tab -->
            <div class="tab-panel" x-show="activeTab === 'payments'" x-transition>
              <div class="settings-section" id="payments">
                <div class="section-header">
                  <div class="section-icon">
                    <span class="material-symbols-rounded">payments</span>
                  </div>
                  <div class="section-title">Payment Configuration</div>
                </div>
                <div class="section-description">
                  Configure multiple payment gateways and billing settings.
                </div>

                <!-- Currency Settings -->
                <h4 style="margin: 1.5rem 0 1rem; color: var(--color-accent-teal);">Currency Settings</h4>
                <div class="form-group">
                  <label class="form-label">Default Currency</label>
                  <select class="form-select" x-model="paymentSettings.defaultCurrency">
                    <option value="ZMW">ZMW - Zambian Kwacha</option>
                    <option value="USD">USD - US Dollar</option>
                    <option value="EUR">EUR - Euro</option>
                  </select>
                </div>

                <!-- Payment Gateways -->
                <h4 style="margin: 1.5rem 0 1rem; color: var(--color-accent-teal);">Payment Gateways</h4>
                
                <!-- MTN Mobile Money -->
                <div class="payment-gateway">
                  <div class="gateway-header">
                    <div class="gateway-info">
                      <h5>MTN Mobile Money</h5>
                      <span class="gateway-status active">Active</span>
                    </div>
                    <label class="form-switch">
                      <input type="checkbox" x-model="paymentSettings.mtn.enabled">
                      <span class="switch"></span>
                    </label>
                  </div>
                  <div class="gateway-settings">
                    <div class="form-group">
                      <label class="form-label">API Key</label>
                      <input type="text" class="form-input" placeholder="Enter MTN API Key" x-model="paymentSettings.mtn.apiKey">
                    </div>
                    <div class="form-group">
                      <label class="form-label">Secret Key</label>
                      <input type="password" class="form-input" placeholder="Enter MTN Secret Key" x-model="paymentSettings.mtn.secretKey">
                    </div>
                    <div class="form-group">
                      <label class="form-label">Environment</label>
                      <select class="form-select" x-model="paymentSettings.mtn.environment">
                        <option value="Sandbox">Sandbox</option>
                        <option value="Production">Production</option>
                      </select>
                    </div>
                  </div>
                </div>

                <!-- Airtel Money -->
                <div class="payment-gateway">
                  <div class="gateway-header">
                    <div class="gateway-info">
                      <h5>Airtel Money</h5>
                      <span class="gateway-status inactive">Inactive</span>
                    </div>
                    <label class="form-switch">
                      <input type="checkbox" x-model="paymentSettings.airtel.enabled">
                      <span class="switch"></span>
                    </label>
                  </div>
                  <div class="gateway-settings">
                    <div class="form-group">
                      <label class="form-label">API Key</label>
                      <input type="text" class="form-input" placeholder="Enter Airtel API Key" x-model="paymentSettings.airtel.apiKey">
                    </div>
                    <div class="form-group">
                      <label class="form-label">Secret Key</label>
                      <input type="password" class="form-input" placeholder="Enter Airtel Secret Key" x-model="paymentSettings.airtel.secretKey">
                    </div>
                    <div class="form-group">
                      <label class="form-label">Environment</label>
                      <select class="form-select" x-model="paymentSettings.airtel.environment">
                        <option value="Sandbox">Sandbox</option>
                        <option value="Production">Production</option>
                      </select>
                    </div>
                  </div>
                </div>

                <!-- Zamtel Kwacha -->
                <div class="payment-gateway">
                  <div class="gateway-header">
                    <div class="gateway-info">
                      <h5>Zamtel Kwacha</h5>
                      <span class="gateway-status inactive">Inactive</span>
                    </div>
                    <label class="form-switch">
                      <input type="checkbox" x-model="paymentSettings.zamtel.enabled">
                      <span class="switch"></span>
                    </label>
                  </div>
                  <div class="gateway-settings">
                    <div class="form-group">
                      <label class="form-label">API Key</label>
                      <input type="text" class="form-input" placeholder="Enter Zamtel API Key" x-model="paymentSettings.zamtel.apiKey">
                    </div>
                    <div class="form-group">
                      <label class="form-label">Secret Key</label>
                      <input type="password" class="form-input" placeholder="Enter Zamtel Secret Key" x-model="paymentSettings.zamtel.secretKey">
                    </div>
                    <div class="form-group">
                      <label class="form-label">Environment</label>
                      <select class="form-select" x-model="paymentSettings.zamtel.environment">
                        <option value="Sandbox">Sandbox</option>
                        <option value="Production">Production</option>
                      </select>
                    </div>
                  </div>
                </div>

                <!-- Bank Transfer -->
                <div class="payment-gateway">
                  <div class="gateway-header">
                    <div class="gateway-info">
                      <h5>Bank Transfer</h5>
                      <span class="gateway-status active">Active</span>
                    </div>
                    <label class="form-switch">
                      <input type="checkbox" x-model="paymentSettings.bank.enabled">
                      <span class="switch"></span>
                    </label>
                  </div>
                  <div class="gateway-settings">
                    <div class="form-group">
                      <label class="form-label">Bank Name</label>
                      <input type="text" class="form-input" x-model="paymentSettings.bank.bankName">
                    </div>
                    <div class="form-group">
                      <label class="form-label">Account Number</label>
                      <input type="text" class="form-input" placeholder="Enter bank account number" x-model="paymentSettings.bank.accountNumber">
                    </div>
                    <div class="form-group">
                      <label class="form-label">Account Name</label>
                      <input type="text" class="form-input" placeholder="Enter account name" x-model="paymentSettings.bank.accountName">
                    </div>
                  </div>
                </div>

                <div class="form-actions">
                  <button class="btn btn-primary" @click="savePaymentSettings">
                    <span class="material-symbols-rounded">save</span>
                    Save Payment Settings
                  </button>
                  <button class="btn btn-secondary" @click="testPaymentGateways">
                    <span class="material-symbols-rounded">credit_card</span>
                    Test Gateways
                  </button>
                </div>
              </div>
            </div>

            <!-- API Settings Tab -->
            <div class="tab-panel" x-show="activeTab === 'api'" x-transition>
              <div class="settings-section" id="api">
                <div class="section-header">
                  <div class="section-icon">
                    <span class="material-symbols-rounded">api</span>
                  </div>
                  <div class="section-title">API Configuration</div>
                </div>
                <div class="section-description">
                  Configure API keys, webhooks, and rate limiting.
                </div>
                
                <div class="form-group">
                  <label class="form-label">API Key</label>
                  <div class="input-group">
                    <input type="text" class="form-input" x-model="apiSettings.apiKey" readonly>
                    <button class="btn btn-secondary" @click="regenerateApiKey">
                      <span class="material-symbols-rounded">refresh</span>
                      Regenerate
                    </button>
                  </div>
                </div>
                
                <div class="form-group">
                  <label class="form-label">Rate Limit (requests per minute)</label>
                  <input type="number" class="form-input" x-model="apiSettings.rateLimit">
                </div>
                
                <div class="form-group">
                  <label class="form-label">Webhook URL</label>
                  <input type="url" class="form-input" placeholder="https://your-domain.com/webhook" x-model="apiSettings.webhookUrl">
                </div>
                
                <div class="form-group">
                  <label class="form-checkbox">
                    <input type="checkbox" x-model="apiSettings.enableApiAccess">
                    <span>Enable API access</span>
                  </label>
                </div>
                
                <div class="form-actions">
                  <button class="btn btn-primary" @click="saveApiSettings">
                    <span class="material-symbols-rounded">save</span>
                    Save API Settings
                  </button>
                  <button class="btn btn-secondary" @click="regenerateApiKey">
                    <span class="material-symbols-rounded">refresh</span>
                    Regenerate API Key
                  </button>
                </div>
              </div>
            </div>

            <!-- Roles & Permissions Tab -->
            <div class="tab-panel" x-show="activeTab === 'roles'" x-transition>
              <div class="settings-section" id="roles">
                <div class="section-header">
                  <div class="section-icon">
                    <span class="material-symbols-rounded">admin_panel_settings</span>
                  </div>
                  <div class="section-title">Roles & Permissions</div>
                </div>
                <div class="section-description">
                  Manage user roles and assign permissions.
                </div>

                <!-- Roles Management -->
                <h4 style="margin: 1.5rem 0 1rem; color: var(--color-accent-teal);">System Roles</h4>
                
                <div class="roles-grid">
                  <!-- Super Admin Role -->
                  <div class="role-card">
                    <div class="role-header">
                      <div class="role-info">
                        <h5>Super Admin</h5>
                        <span class="role-count">2 users</span>
                      </div>
                      <span class="role-badge admin">System</span>
                    </div>
                    <div class="role-description">
                      Full system access with all permissions
                    </div>
                    <div class="role-permissions">
                      <span class="permission-tag">All Access</span>
                    </div>
                  </div>

                  <!-- Admin Role -->
                  <div class="role-card">
                    <div class="role-header">
                      <div class="role-info">
                        <h5>Admin</h5>
                        <span class="role-count">5 users</span>
                      </div>
                      <span class="role-badge admin">Management</span>
                    </div>
                    <div class="role-description">
                      Manage pharmacies, users, and transactions
                    </div>
                    <div class="role-permissions">
                      <span class="permission-tag">Pharmacies</span>
                      <span class="permission-tag">Users</span>
                      <span class="permission-tag">Reports</span>
                    </div>
                  </div>

                  <!-- Manager Role -->
                  <div class="role-card">
                    <div class="role-header">
                      <div class="role-info">
                        <h5>Manager</h5>
                        <span class="role-count">12 users</span>
                      </div>
                      <span class="role-badge standard">Staff</span>
                    </div>
                    <div class="role-description">
                      Manage pharmacy operations and inventory
                    </div>
                    <div class="role-permissions">
                      <span class="permission-tag">Inventory</span>
                      <span class="permission-tag">Sales</span>
                      <span class="permission-tag">Reports</span>
                    </div>
                  </div>

                  <!-- Cashier Role -->
                  <div class="role-card">
                    <div class="role-header">
                      <div class="role-info">
                        <h5>Cashier</h5>
                        <span class="role-count">28 users</span>
                      </div>
                      <span class="role-badge standard">Staff</span>
                    </div>
                    <div class="role-description">
                      Process sales and manage daily transactions
                    </div>
                    <div class="role-permissions">
                      <span class="permission-tag">Sales</span>
                      <span class="permission-tag">Customer Info</span>
                    </div>
                  </div>
                </div>

                <!-- Permission Matrix -->
                <h4 style="margin: 2rem 0 1rem; color: var(--color-accent-teal);">Permission Matrix</h4>
                <div class="permission-matrix">
                  <table class="matrix-table">
                    <thead>
                      <tr>
                        <th>Permission</th>
                        <th>Super Admin</th>
                        <th>Admin</th>
                        <th>Manager</th>
                        <th>Cashier</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>Dashboard</td>
                        <td><span class="check"></span></td>
                        <td><span class="check"></span></td>
                        <td><span class="check"></span></td>
                        <td><span class="check"></span></td>
                      </tr>
                      <tr>
                        <td>Pharmacies</td>
                        <td><span class="check"></span></td>
                        <td><span class="check"></span></td>
                        <td><span class="check"></span></td>
                        <td><span class="check"></span></td>
                      </tr>
                      <tr>
                        <td>Users</td>
                        <td><span class="check"></span></td>
                        <td><span class="check"></span></td>
                        <td><span class="check"></span></td>
                        <td><span class="cross"></span></td>
                      </tr>
                      <tr>
                        <td>Transactions</td>
                        <td><span class="check"></span></td>
                        <td><span class="check"></span></td>
                        <td><span class="check"></span></td>
                        <td><span class="check"></span></td>
                      </tr>
                      <tr>
                        <td>Reports</td>
                        <td><span class="check"></span></td>
                        <td><span class="check"></span></td>
                        <td><span class="check"></span></td>
                        <td><span class="cross"></span></td>
                      </tr>
                      <tr>
                        <td>Settings</td>
                        <td><span class="check"></span></td>
                        <td><span class="cross"></span></td>
                        <td><span class="cross"></span></td>
                        <td><span class="cross"></span></td>
                      </tr>
                      <tr>
                        <td>Security</td>
                        <td><span class="check"></span></td>
                        <td><span class="cross"></span></td>
                        <td><span class="cross"></span></td>
                        <td><span class="cross"></span></td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <div class="form-actions">
                  <button class="btn btn-primary" @click="saveRoleSettings">
                    <span class="material-symbols-rounded">save</span>
                    Save Role Settings
                  </button>
                  <button class="btn btn-secondary" @click="createRole">
                    <span class="material-symbols-rounded">add</span>
                    Create New Role
                  </button>
                </div>
              </div>
            </div>

            <!-- Security Settings Tab -->
            <div class="tab-panel" x-show="activeTab === 'security'" x-transition>
              <div class="settings-section" id="security">
                <div class="section-header">
                  <div class="section-icon">
                    <span class="material-symbols-rounded">security</span>
                  </div>
                  <div class="section-title">Security Configuration</div>
                </div>
                <div class="section-description">
                  Configure security policies and access control.
                </div>
                
                <div class="form-group">
                  <label class="form-label">Session Timeout (minutes)</label>
                  <input type="number" class="form-input" x-model="securitySettings.sessionTimeoutMinutes">
                </div>
                
                <div class="form-group">
                  <label class="form-label">Password Policy</label>
                  <select class="form-select" x-model="securitySettings.passwordPolicy">
                    <option value="Strong (8+ chars, uppercase, numbers, symbols)">Strong (8+ chars, uppercase, numbers, symbols)</option>
                    <option value="Medium (6+ chars, uppercase, numbers)">Medium (6+ chars, uppercase, numbers)</option>
                    <option value="Basic (6+ characters)">Basic (6+ characters)</option>
                  </select>
                </div>
                
                <div class="form-group">
                  <label class="form-label">Maximum Login Attempts</label>
                  <input type="number" class="form-input" x-model="securitySettings.maxLoginAttempts">
                </div>
                
                <div class="form-group">
                  <label class="form-checkbox">
                    <input type="checkbox" x-model="securitySettings.enableTwoFactorAuth">
                    <span>Enable two-factor authentication</span>
                  </label>
                </div>
                
                <div class="form-group">
                  <label class="form-checkbox">
                    <input type="checkbox" x-model="securitySettings.requirePasswordChange">
                    <span>Require password change every 90 days</span>
                  </label>
                </div>
                
                <div class="form-actions">
                  <button class="btn btn-primary" @click="saveSecuritySettings">
                    <span class="material-symbols-rounded">save</span>
                    Save Security Settings
                  </button>
                  <button class="btn btn-secondary" @click="testSecuritySettings">
                    <span class="material-symbols-rounded">security</span>
                    Test Security
                  </button>
                </div>
              </div>
            </div>

            <!-- Maintenance Tab -->
            <div class="tab-panel" x-show="activeTab === 'maintenance'" x-transition>
              <div class="settings-section" id="maintenance">
                <div class="section-header">
                  <div class="section-icon">
                    <span class="material-symbols-rounded">build</span>
                  </div>
                  <div class="section-title">System Maintenance</div>
                </div>
                <div class="section-description">
                  Configure maintenance tasks and system cleanup.
                </div>
                
                <div class="form-group">
                  <label class="form-label">Maintenance Window</label>
                  <select class="form-select" x-model="maintenanceSettings.maintenanceWindow">
                    <option value="02:00 - 04:00 CAT">02:00 - 04:00 CAT</option>
                    <option value="00:00 - 02:00 CAT">00:00 - 02:00 CAT</option>
                    <option value="04:00 - 06:00 CAT">04:00 - 06:00 CAT</option>
                  </select>
                </div>
                
                <div class="form-group">
                  <label class="form-label">Log Retention (days)</label>
                  <input type="number" class="form-input" x-model="maintenanceSettings.logRetentionDays">
                </div>
                
                <div class="form-group">
                  <label class="form-checkbox">
                    <input type="checkbox" x-model="maintenanceSettings.enableAutoCleanup">
                    <span>Enable automatic cleanup</span>
                  </label>
                </div>
                
                <div class="form-group">
                  <label class="form-checkbox">
                    <input type="checkbox" x-model="maintenanceSettings.enableSystemMonitoring">
                    <span>Enable system monitoring</span>
                  </label>
                </div>
                
                <div class="form-actions">
                  <button class="btn btn-primary" @click="saveMaintenanceSettings">
                    <span class="material-symbols-rounded">save</span>
                    Save Maintenance Settings
                  </button>
                  <button class="btn btn-secondary" @click="runMaintenance">
                    <span class="material-symbols-rounded">build</span>
                    Run Maintenance Now
                  </button>
                  <button class="btn btn-secondary" @click="clearCache">
                    <span class="material-symbols-rounded">delete_sweep</span>
                    Clear Cache
                  </button>
                  <button class="btn btn-secondary" @click="optimizeDatabase">
                    <span class="material-symbols-rounded">tune</span>
                    Optimize Database
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

        </div>
      </div>
    </main>
  </div>

  <script>
    function searchComponent() {
      return {
        // Initialize backend integration
        const pageIntegration = new PageIntegrationTemplate('super-admin-settings', {
            requireAuth: true,
            enableRealTime: false,
            enableCaching: true
        });
        
        return {
            ...pageIntegration,
            backendHelper: window.backendHelper,
            apiClient: window.apiClient,
            authManager: window.authManager,
            isAuthenticated: false,
            loading: false,
            error: null,
        query: '',
        showSuggestions: false,
        suggestions: [],
        
        async init() {
            try {
                // Check authentication
                this.isAuthenticated = this.authManager?.isAuthenticated() || false;
                
                if (!this.isAuthenticated) {
                    this.error = 'Please login to access this page';
                    return;
                }
                
                // Initialize backend integration
                await this.backendHelper.initPage('super-admin-settings', {
                    enableRealTime: false,
                    initialData: this.getInitialDataConfig()
                });
                
                // Load page data
                await this.loadPageData();
                
                // Set up event listeners
                this.setupEventListeners();
                
                console.log('super-admin-settings page initialized with backend integration');
            } catch (error) {
                console.error('Failed to initialize super-admin-settings page:', error);
                this.error = 'Failed to initialize page';
            }
        },,
            {
              id: 2,
              title: 'System Backup',
              description: 'Backup configuration and management',
              type: 'setting',
              icon: 'backup'
            },
            {
              id: 3,
              title: 'Email Configuration',
              description: 'SMTP and email settings',
              type: 'setting',
              icon: 'email'
            },
            {
              id: 4,
              title: 'API Configuration',
              description: 'API keys and webhooks',
              type: 'setting',
              icon: 'api'
            },
            {
              id: 5,
              title: 'Payment Settings',
              description: 'Payment gateway configuration',
              type: 'setting',
              icon: 'payments'
            },
            {
              id: 6,
              title: 'Security Settings',
              description: 'Security policies and access control',
              type: 'setting',
              icon: 'security'
            }
          ];
        },
        
        handleSearch() {
          if (this.query.length < 2) {
            this.suggestions = [];
            return;
          }
          
          console.log('Searching settings for:', this.query);
          
          // Filter existing suggestions based on query
          this.suggestions = this.suggestions.filter(s => 
            s.title.toLowerCase().includes(this.query.toLowerCase()) ||
            s.description.toLowerCase().includes(this.query.toLowerCase())
          );
        },
        
        selectSuggestion(suggestion) {
          console.log('Selected setting:', suggestion);
          this.query = suggestion.title;
          this.showSuggestions = false;
          
          // Scroll to the selected setting section
          const element = document.getElementById(suggestion.title.toLowerCase().replace(' ', '-'));
          if (element) {
            element.scrollIntoView({ behavior: 'smooth' });
          }
        },
        
        hideSuggestions() {
          setTimeout(() => {
            this.showSuggestions = false;
          }, 200);
        }
      }
    }

    function settings() {
      return {
        userName: '',
        userEmail: '',
        mobileMenuOpen: false,
        showUserMenu: false,
        activeTab: 'general',
        generalSettings: {
          systemName: 'UmiHealthInformationSystems Pharmacy Management',
          defaultLanguage: 'English',
          timeZone: 'Africa/Lusaka',
          enableSystemNotifications: true
        },
        savingGeneralSettings: false,

        backupSettings: {
          frequency: 'Daily',
          location: '/backups/UmiHealthInformationSystems',
          retentionDays: 30,
          enableAutoBackups: true
        },

        emailSettings: {
          smtpServer: 'smtp.gmail.com',
          port: 587,
          username: 'noreply@UmiHealthInformationSystems.zm',
          password: '',
          useSsl: true
        },

        paymentSettings: {
          defaultCurrency: 'ZMW',
          mtn: {
            enabled: true,
            apiKey: '',
            secretKey: '',
            environment: 'Sandbox'
          },
          airtel: {
            enabled: false,
            apiKey: '',
            secretKey: '',
            environment: 'Sandbox'
          },
          zamtel: {
            enabled: false,
            apiKey: '',
            secretKey: '',
            environment: 'Sandbox'
          },
          bank: {
            enabled: true,
            bankName: 'Zanaco',
            accountNumber: '',
            accountName: ''
          }
        },

        apiSettings: {
          apiKey: 'UmiHealthInformationSystems_prod_2024_abc123xyz',
          rateLimit: 1000,
          webhookUrl: '',
          enableApiAccess: true
        },

        securitySettings: {
          sessionTimeoutMinutes: 30,
          passwordPolicy: 'Strong (8+ chars, uppercase, numbers, symbols)',
          maxLoginAttempts: 5,
          enableTwoFactorAuth: true,
          requirePasswordChange: true
        },

        maintenanceSettings: {
          maintenanceWindow: '02:00 - 04:00 CAT',
          logRetentionDays: 90,
          enableAutoCleanup: true,
          enableSystemMonitoring: true
        },

        async init() {
          // Get user info from session
          this.userName = sessionStorage.getItem('userName') || 'Super Admin';
          this.userEmail = sessionStorage.getItem('userEmail') || 'admin@UmiHealthInformationSystems.zm';
          
          // Check for backup anchor in URL
          if (window.location.hash === '#backup') {
            setTimeout(() => {
              document.getElementById('backup').scrollIntoView({ behavior: 'smooth' });
            }, 100);
          }
          
          // Close mobile menu when clicking outside
          document.addEventListener('click', (e) => {
            if (!e.target.closest('.sidebar') && !e.target.closest('.mobile-menu-toggle')) {
              this.mobileMenuOpen = false;
            }
            if (!e.target.closest('.user-menu')) {
              this.showUserMenu = false;
            }
          });

          await Promise.all([
            this.loadGeneralSettings(),
            this.loadBackupSettings(),
            this.loadEmailSettings(),
            this.loadPaymentSettings(),
            this.loadApiSettings(),
            this.loadSecuritySettings(),
            this.loadMaintenanceSettings()
          ]);
        },

        getAuthToken() {
          return localStorage.getItem('UmiHealthInformationSystems_auth_token') || localStorage.getItem('authToken');
        },

        parseBoolean(raw) {
          return raw === true || raw === 'true' || raw === 1 || raw === '1';
        },

        async getCategorySettingsMap(category) {
          try {
            if (!window.UmiHealthInformationSystemsAPI) {
              return {};
            }

            const token = this.getAuthToken();
            if (!token) {
              return {};
            }

            const response = await window.UmiHealthInformationSystemsAPI.get(`/api/setting/category/${encodeURIComponent(category)}`);

            if (!response || response.success !== true || !Array.isArray(response.data)) {
              return {};
            }

            const map = {};
            response.data.forEach(item => {
              const key = item?.key ?? item?.Key;
              const value = item?.value ?? item?.Value;
              if (key) {
                map[key] = value;
              }
            });

            return map;
          } catch (error) {
            return {};
          }
        },

        async saveSettingsBatch(category, updates) {
          if (!window.UmiHealthInformationSystemsAPI) {
            this.showError('API client not available.');
            return false;
          }

          const token = this.getAuthToken();
          if (!token) {
            this.showError('You are not authenticated. Please sign in again.');
            return false;
          }

          const requests = updates.map(update => window.UmiHealthInformationSystemsAPI.put(`/api/setting/${update.key}`, {
            value: update.value,
            category
          }));

          const results = await Promise.allSettled(requests);

          const failures = results.filter(result =>
            result.status !== 'fulfilled' || !result.value || result.value.success !== true
          );

          if (failures.length > 0) {
            const rejected = failures.find(failure => failure.status === 'rejected');
            const message = rejected?.reason?.message || `Failed to save ${category.toLowerCase()} settings.`;
            this.showError(message);
            return false;
          }

          return true;
        },

        async loadGeneralSettings() {
          try {
            if (!window.UmiHealthInformationSystemsAPI) {
              return;
            }

            const token = this.getAuthToken();
            if (!token) {
              return;
            }

            const [appNameResult, timeZoneResult, languageResult, notificationsResult] = await Promise.allSettled([
              window.UmiHealthInformationSystemsAPI.get('/api/setting/application_name'),
              window.UmiHealthInformationSystemsAPI.get('/api/setting/timezone'),
              window.UmiHealthInformationSystemsAPI.get('/api/setting/default_language'),
              window.UmiHealthInformationSystemsAPI.get('/api/setting/enable_push_notifications')
            ]);

            if (appNameResult.status === 'fulfilled' && appNameResult.value?.success && appNameResult.value.data?.value !== undefined) {
              this.generalSettings.systemName = appNameResult.value.data.value || this.generalSettings.systemName;
            }

            if (timeZoneResult.status === 'fulfilled' && timeZoneResult.value?.success && timeZoneResult.value.data?.value) {
              this.generalSettings.timeZone = timeZoneResult.value.data.value;
            }

            if (languageResult.status === 'fulfilled' && languageResult.value?.success && languageResult.value.data?.value) {
              this.generalSettings.defaultLanguage = languageResult.value.data.value;
            }

            if (notificationsResult.status === 'fulfilled' && notificationsResult.value?.success && notificationsResult.value.data?.value !== undefined) {
              const raw = notificationsResult.value.data.value;
              this.generalSettings.enableSystemNotifications = raw === true || raw === 'true' || raw === 1 || raw === '1';
            }
          } catch (error) {
            console.warn('Failed to load general settings', error);
          }
        },

        async loadBackupSettings() {
          try {
            const map = await this.getCategorySettingsMap('Backup');

            if (map.backup_frequency) {
              this.backupSettings.frequency = map.backup_frequency;
            }
            if (map.backup_location) {
              this.backupSettings.location = map.backup_location;
            }
            if (map.backup_retention_days && !isNaN(parseInt(map.backup_retention_days, 10))) {
              this.backupSettings.retentionDays = parseInt(map.backup_retention_days, 10);
            }
            if (map.backup_auto_enabled !== undefined) {
              this.backupSettings.enableAutoBackups = this.parseBoolean(map.backup_auto_enabled);
            }
          } catch (error) {
            console.warn('Failed to load backup settings', error);
          }
        },

        async loadEmailSettings() {
          try {
            const map = await this.getCategorySettingsMap('Email');

            if (map.smtp_server) {
              this.emailSettings.smtpServer = map.smtp_server;
            }
            if (map.smtp_port && !isNaN(parseInt(map.smtp_port, 10))) {
              this.emailSettings.port = parseInt(map.smtp_port, 10);
            }
            if (map.smtp_username) {
              this.emailSettings.username = map.smtp_username;
            }
            if (map.smtp_password !== undefined) {
              this.emailSettings.password = map.smtp_password;
            }
            if (map.smtp_use_ssl !== undefined) {
              this.emailSettings.useSsl = this.parseBoolean(map.smtp_use_ssl);
            }
          } catch (error) {
            console.warn('Failed to load email settings', error);
          }
        },

        async loadPaymentSettings() {
          try {
            const map = await this.getCategorySettingsMap('Payments');

            if (map.default_currency) {
              this.paymentSettings.defaultCurrency = map.default_currency;
            }

            if (map.mtn_enabled !== undefined) {
              this.paymentSettings.mtn.enabled = this.parseBoolean(map.mtn_enabled);
            }
            if (map.mtn_api_key !== undefined) {
              this.paymentSettings.mtn.apiKey = map.mtn_api_key;
            }
            if (map.mtn_secret_key !== undefined) {
              this.paymentSettings.mtn.secretKey = map.mtn_secret_key;
            }
            if (map.mtn_environment) {
              this.paymentSettings.mtn.environment = map.mtn_environment;
            }

            if (map.airtel_enabled !== undefined) {
              this.paymentSettings.airtel.enabled = this.parseBoolean(map.airtel_enabled);
            }
            if (map.airtel_api_key !== undefined) {
              this.paymentSettings.airtel.apiKey = map.airtel_api_key;
            }
            if (map.airtel_secret_key !== undefined) {
              this.paymentSettings.airtel.secretKey = map.airtel_secret_key;
            }
            if (map.airtel_environment) {
              this.paymentSettings.airtel.environment = map.airtel_environment;
            }

            if (map.zamtel_enabled !== undefined) {
              this.paymentSettings.zamtel.enabled = this.parseBoolean(map.zamtel_enabled);
            }
            if (map.zamtel_api_key !== undefined) {
              this.paymentSettings.zamtel.apiKey = map.zamtel_api_key;
            }
            if (map.zamtel_secret_key !== undefined) {
              this.paymentSettings.zamtel.secretKey = map.zamtel_secret_key;
            }
            if (map.zamtel_environment) {
              this.paymentSettings.zamtel.environment = map.zamtel_environment;
            }

            if (map.bank_transfer_enabled !== undefined) {
              this.paymentSettings.bank.enabled = this.parseBoolean(map.bank_transfer_enabled);
            }
            if (map.bank_name !== undefined) {
              this.paymentSettings.bank.bankName = map.bank_name;
            }
            if (map.bank_account_number !== undefined) {
              this.paymentSettings.bank.accountNumber = map.bank_account_number;
            }
            if (map.bank_account_name !== undefined) {
              this.paymentSettings.bank.accountName = map.bank_account_name;
            }
          } catch (error) {
            console.warn('Failed to load payment settings', error);
          }
        },

        async loadApiSettings() {
          try {
            const map = await this.getCategorySettingsMap('API');

            if (map.api_key) {
              this.apiSettings.apiKey = map.api_key;
            }
            if (map.api_rate_limit && !isNaN(parseInt(map.api_rate_limit, 10))) {
              this.apiSettings.rateLimit = parseInt(map.api_rate_limit, 10);
            }
            if (map.api_webhook_url !== undefined) {
              this.apiSettings.webhookUrl = map.api_webhook_url;
            }
            if (map.api_enabled !== undefined) {
              this.apiSettings.enableApiAccess = this.parseBoolean(map.api_enabled);
            }
          } catch (error) {
            console.warn('Failed to load API settings', error);
          }
        },

        async loadSecuritySettings() {
          try {
            const map = await this.getCategorySettingsMap('Security');

            if (map.session_timeout_minutes && !isNaN(parseInt(map.session_timeout_minutes, 10))) {
              this.securitySettings.sessionTimeoutMinutes = parseInt(map.session_timeout_minutes, 10);
            }
            if (map.password_policy) {
              this.securitySettings.passwordPolicy = map.password_policy;
            }
            if (map.max_login_attempts && !isNaN(parseInt(map.max_login_attempts, 10))) {
              this.securitySettings.maxLoginAttempts = parseInt(map.max_login_attempts, 10);
            }
            if (map.enable_two_factor_auth !== undefined) {
              this.securitySettings.enableTwoFactorAuth = this.parseBoolean(map.enable_two_factor_auth);
            }
            if (map.require_password_change !== undefined) {
              this.securitySettings.requirePasswordChange = this.parseBoolean(map.require_password_change);
            }
          } catch (error) {
            console.warn('Failed to load security settings', error);
          }
        },

        async loadMaintenanceSettings() {
          try {
            const map = await this.getCategorySettingsMap('Maintenance');

            if (map.maintenance_window) {
              this.maintenanceSettings.maintenanceWindow = map.maintenance_window;
            }
            if (map.log_retention_days && !isNaN(parseInt(map.log_retention_days, 10))) {
              this.maintenanceSettings.logRetentionDays = parseInt(map.log_retention_days, 10);
            }
            if (map.enable_auto_cleanup !== undefined) {
              this.maintenanceSettings.enableAutoCleanup = this.parseBoolean(map.enable_auto_cleanup);
            }
            if (map.enable_system_monitoring !== undefined) {
              this.maintenanceSettings.enableSystemMonitoring = this.parseBoolean(map.enable_system_monitoring);
            }
          } catch (error) {
            console.warn('Failed to load maintenance settings', error);
          }
        },

        // General Settings Functions
        async saveGeneralSettings() {
          try {
            this.savingGeneralSettings = true;

            if (!window.UmiHealthInformationSystemsAPI) {
              this.showError('API client not available.');
              return;
            }

            if (!this.generalSettings.systemName || !this.generalSettings.systemName.trim()) {
              this.showError('System name is required.');
              return;
            }

            const updates = [
              window.UmiHealthInformationSystemsAPI.put('/api/setting/application_name', {
                value: this.generalSettings.systemName.trim(),
                category: 'General'
              }),
              window.UmiHealthInformationSystemsAPI.put('/api/setting/timezone', {
                value: this.generalSettings.timeZone,
                category: 'General'
              }),
              window.UmiHealthInformationSystemsAPI.put('/api/setting/default_language', {
                value: this.generalSettings.defaultLanguage,
                category: 'General'
              }),
              window.UmiHealthInformationSystemsAPI.put('/api/setting/enable_push_notifications', {
                value: this.generalSettings.enableSystemNotifications ? 'true' : 'false',
                category: 'Notifications'
              })
            ];

            const results = await Promise.allSettled(updates);

            const failures = results.filter(result =>
              result.status !== 'fulfilled' || !result.value || result.value.success !== true
            );

            if (failures.length > 0) {
              const rejected = failures.find(failure => failure.status === 'rejected');
              const message = rejected?.reason?.message || 'Failed to save general settings.';
              this.showError(message);
              return;
            }

            this.showSuccess('General settings saved successfully!');
          } catch (error) {
            console.error('Error saving general settings:', error);
            this.showError(error.message || 'Failed to save general settings.');
          } finally {
            this.savingGeneralSettings = false;
          }
        },

        // Backup Settings Functions
        async saveBackupSettings() {
          try {
            const ok = await this.saveSettingsBatch('Backup', [
              { key: 'backup_frequency', value: this.backupSettings.frequency },
              { key: 'backup_location', value: (this.backupSettings.location || '').trim() },
              { key: 'backup_retention_days', value: String(this.backupSettings.retentionDays ?? 30) },
              { key: 'backup_auto_enabled', value: this.backupSettings.enableAutoBackups ? 'true' : 'false' }
            ]);

            if (!ok) {
              return;
            }

            this.showSuccess('Backup settings saved successfully!');
          } catch (error) {
            console.error('Error saving backup settings:', error);
            this.showError(error.message || 'Failed to save backup settings.');
          }
        },

        async createBackup() {
          console.log('Creating system backup...');
          if (!confirm('Are you sure you want to create a system backup? This may take several minutes.')) {
            return;
          }

          try {
            const ok = await this.saveSettingsBatch('Backup', [
              { key: 'backup_manual_request', value: new Date().toISOString() }
            ]);
            if (!ok) {
              return;
            }
            this.showInfo('System backup initiated. You will be notified when complete.');
          } catch (error) {
            console.error('Error initiating backup:', error);
            this.showError(error.message || 'Failed to initiate backup.');
          }
        },

        async restoreBackup() {
          console.log('Restoring system backup...');
          if (!confirm('WARNING: Restoring a backup will overwrite current data. Are you sure you want to continue?')) {
            return;
          }

          try {
            const ok = await this.saveSettingsBatch('Backup', [
              { key: 'backup_restore_request', value: new Date().toISOString() }
            ]);
            if (!ok) {
              return;
            }
            this.showWarning('Backup restoration initiated. System will be temporarily unavailable.');
          } catch (error) {
            console.error('Error initiating restore:', error);
            this.showError(error.message || 'Failed to initiate backup restore.');
          }
        },

        // Email Settings Functions
        async saveEmailSettings() {
          try {
            const ok = await this.saveSettingsBatch('Email', [
              { key: 'smtp_server', value: (this.emailSettings.smtpServer || '').trim() },
              { key: 'smtp_port', value: String(this.emailSettings.port ?? 587) },
              { key: 'smtp_username', value: (this.emailSettings.username || '').trim() },
              { key: 'smtp_password', value: String(this.emailSettings.password ?? '') },
              { key: 'smtp_use_ssl', value: this.emailSettings.useSsl ? 'true' : 'false' }
            ]);

            if (!ok) {
              return;
            }

            this.showSuccess('Email settings saved successfully!');
          } catch (error) {
            console.error('Error saving email settings:', error);
            this.showError(error.message || 'Failed to save email settings.');
          }
        },

        async testEmailSettings() {
          console.log('Sending test email...');
          try {
            const ok = await this.saveSettingsBatch('Email', [
              { key: 'email_test_request', value: new Date().toISOString() }
            ]);

            if (!ok) {
              return;
            }

            this.showInfo('Test email request sent for ' + this.userEmail);
          } catch (error) {
            console.error('Error sending test email request:', error);
            this.showError(error.message || 'Failed to send test email request.');
          }
        },

        // Payment Settings Functions
        async savePaymentSettings() {
          try {
            const ok = await this.saveSettingsBatch('Payments', [
              { key: 'default_currency', value: String(this.paymentSettings.defaultCurrency ?? 'ZMW') },
              { key: 'mtn_enabled', value: this.paymentSettings.mtn.enabled ? 'true' : 'false' },
              { key: 'mtn_api_key', value: String(this.paymentSettings.mtn.apiKey ?? '') },
              { key: 'mtn_secret_key', value: String(this.paymentSettings.mtn.secretKey ?? '') },
              { key: 'mtn_environment', value: String(this.paymentSettings.mtn.environment ?? 'Sandbox') },
              { key: 'airtel_enabled', value: this.paymentSettings.airtel.enabled ? 'true' : 'false' },
              { key: 'airtel_api_key', value: String(this.paymentSettings.airtel.apiKey ?? '') },
              { key: 'airtel_secret_key', value: String(this.paymentSettings.airtel.secretKey ?? '') },
              { key: 'airtel_environment', value: String(this.paymentSettings.airtel.environment ?? 'Sandbox') },
              { key: 'zamtel_enabled', value: this.paymentSettings.zamtel.enabled ? 'true' : 'false' },
              { key: 'zamtel_api_key', value: String(this.paymentSettings.zamtel.apiKey ?? '') },
              { key: 'zamtel_secret_key', value: String(this.paymentSettings.zamtel.secretKey ?? '') },
              { key: 'zamtel_environment', value: String(this.paymentSettings.zamtel.environment ?? 'Sandbox') },
              { key: 'bank_transfer_enabled', value: this.paymentSettings.bank.enabled ? 'true' : 'false' },
              { key: 'bank_name', value: String(this.paymentSettings.bank.bankName ?? '') },
              { key: 'bank_account_number', value: String(this.paymentSettings.bank.accountNumber ?? '') },
              { key: 'bank_account_name', value: String(this.paymentSettings.bank.accountName ?? '') }
            ]);

            if (!ok) {
              return;
            }

            this.showSuccess('Payment settings saved successfully!');
          } catch (error) {
            console.error('Error saving payment settings:', error);
            this.showError(error.message || 'Failed to save payment settings.');
          }
        },

        async testPaymentGateways() {
          console.log('Testing payment gateways...');
          try {
            const ok = await this.saveSettingsBatch('Payments', [
              { key: 'payments_test_request', value: new Date().toISOString() }
            ]);

            if (!ok) {
              return;
            }

            this.showInfo('Payment gateway test request initiated. Check logs for results.');
          } catch (error) {
            console.error('Error initiating payment gateway test:', error);
            this.showError(error.message || 'Failed to initiate payment gateway test.');
          }
        },

        // API Settings Functions
        async saveApiSettings() {
          try {
            const ok = await this.saveSettingsBatch('API', [
              { key: 'api_key', value: String(this.apiSettings.apiKey ?? '') },
              { key: 'api_rate_limit', value: String(this.apiSettings.rateLimit ?? 1000) },
              { key: 'api_webhook_url', value: String(this.apiSettings.webhookUrl ?? '') },
              { key: 'api_enabled', value: this.apiSettings.enableApiAccess ? 'true' : 'false' }
            ]);

            if (!ok) {
              return;
            }

            this.showSuccess('API settings saved successfully!');
          } catch (error) {
            console.error('Error saving API settings:', error);
            this.showError(error.message || 'Failed to save API settings.');
          }
        },

        async regenerateApiKey() {
          console.log('Regenerating API key...');
          if (!confirm('Are you sure you want to regenerate the API key? This will invalidate the current key.')) {
            return;
          }

          const randomPart = Math.random().toString(36).slice(2, 12);
          this.apiSettings.apiKey = `UmiHealthInformationSystems_${Date.now()}_${randomPart}`;

          await this.saveApiSettings();
        },

        // Roles & Permissions Functions
        async saveRoleSettings() {
          try {
            if (!window.UmiHealthInformationSystemsAPI) {
              this.showError('API client not available.');
              return;
            }

            const token = this.getAuthToken();
            if (!token) {
              this.showError('You are not authenticated. Please sign in again.');
              return;
            }

            const response = await window.UmiHealthInformationSystemsAPI.get('/api/settings/roles');
            if (!response || response.success !== true) {
              this.showError(response?.message || 'Failed to load roles.');
              return;
            }

            this.showSuccess('Role settings synced successfully!');
          } catch (error) {
            console.error('Error syncing roles:', error);
            this.showError(error.message || 'Failed to sync role settings.');
          }
        },

        createRole() {
          console.log('Creating new role...');
          alert('Create role modal coming soon!');
        },

        // Security Settings Functions
        async saveSecuritySettings() {
          try {
            const ok = await this.saveSettingsBatch('Security', [
              { key: 'session_timeout_minutes', value: String(this.securitySettings.sessionTimeoutMinutes ?? 30) },
              { key: 'password_policy', value: String(this.securitySettings.passwordPolicy ?? '') },
              { key: 'max_login_attempts', value: String(this.securitySettings.maxLoginAttempts ?? 5) },
              { key: 'enable_two_factor_auth', value: this.securitySettings.enableTwoFactorAuth ? 'true' : 'false' },
              { key: 'require_password_change', value: this.securitySettings.requirePasswordChange ? 'true' : 'false' }
            ]);

            if (!ok) {
              return;
            }

            this.showSuccess('Security settings saved successfully!');
          } catch (error) {
            console.error('Error saving security settings:', error);
            this.showError(error.message || 'Failed to save security settings.');
          }
        },

        async testSecuritySettings() {
          console.log('Testing security settings...');
          try {
            const ok = await this.saveSettingsBatch('Security', [
              { key: 'security_test_request', value: new Date().toISOString() }
            ]);

            if (!ok) {
              return;
            }

            this.showInfo('Security test request initiated. Check logs for results.');
          } catch (error) {
            console.error('Error initiating security test:', error);
            this.showError(error.message || 'Failed to initiate security test.');
          }
        },

        // System Maintenance Functions
        async saveMaintenanceSettings() {
          try {
            const ok = await this.saveSettingsBatch('Maintenance', [
              { key: 'maintenance_window', value: String(this.maintenanceSettings.maintenanceWindow ?? '') },
              { key: 'log_retention_days', value: String(this.maintenanceSettings.logRetentionDays ?? 90) },
              { key: 'enable_auto_cleanup', value: this.maintenanceSettings.enableAutoCleanup ? 'true' : 'false' },
              { key: 'enable_system_monitoring', value: this.maintenanceSettings.enableSystemMonitoring ? 'true' : 'false' }
            ]);

            if (!ok) {
              return;
            }

            this.showSuccess('Maintenance settings saved successfully!');
          } catch (error) {
            console.error('Error saving maintenance settings:', error);
            this.showError(error.message || 'Failed to save maintenance settings.');
          }
        },

        async runMaintenance() {
          console.log('Running system maintenance...');
          if (!confirm('System maintenance will temporarily affect performance. Continue?')) {
            return;
          }

          try {
            const ok = await this.saveSettingsBatch('Maintenance', [
              { key: 'maintenance_run_request', value: new Date().toISOString() }
            ]);

            if (!ok) {
              return;
            }

            this.showInfo('System maintenance started. You will be notified when complete.');
          } catch (error) {
            console.error('Error initiating maintenance:', error);
            this.showError(error.message || 'Failed to start maintenance.');
          }
        },

        async clearCache() {
          console.log('Clearing system cache...');
          if (!confirm('Clearing cache may temporarily affect performance. Continue?')) {
            return;
          }

          try {
            const ok = await this.saveSettingsBatch('Maintenance', [
              { key: 'maintenance_clear_cache_request', value: new Date().toISOString() }
            ]);

            if (!ok) {
              return;
            }

            this.showSuccess('System cache clear request recorded successfully.');
          } catch (error) {
            console.error('Error recording cache clear:', error);
            this.showError(error.message || 'Failed to clear cache.');
          }
        },

        async optimizeDatabase() {
          console.log('Optimizing database...');
          if (!confirm('Database optimization will temporarily affect system availability. Continue?')) {
            return;
          }

          try {
            const ok = await this.saveSettingsBatch('Maintenance', [
              { key: 'maintenance_optimize_db_request', value: new Date().toISOString() }
            ]);

            if (!ok) {
              return;
            }

            this.showInfo('Database optimization started. This may take several minutes.');
          } catch (error) {
            console.error('Error recording database optimization:', error);
            this.showError(error.message || 'Failed to optimize database.');
          }
        },

        // Utility Functions
        showSuccess(message) {
          console.log('SUCCESS:', message);
          alert(' ' + message);
        },

        showInfo(message) {
          console.log('INFO:', message);
          alert(' ' + message);
        },

        showWarning(message) {
          console.log('WARNING:', message);
          alert(' ' + message);
        },

        showError(message) {
          console.log('ERROR:', message);
          alert(' ' + message);
        },

        handleLogout() {
          if (confirm('Are you sure you want to sign out?')) {
            // Clear session
            sessionStorage.clear();
            
            // Redirect to signin
            window.location.href = '../../public/signin.html';
          }
        }
      }
    }
  </script>

  <!-- Include API and Data Sync Services -->
  <script src="../shared/js/data-sync.js"></script>
  <script src="../shared/js/role-based-access.js"></script>
  <script src="../admin/js/admin-api.js"></script>
  <script src="js/super-admin-api.js"></script>

  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script></body>
</html>




<!DOCTYPE html>
<html lang="en" x-data="transactions()">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Transaction History | UmiHealthInformationSystems Pharmacy Management</title>
  <link rel="icon" href="../../logo.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Glacial+Indifference:wght@400;500;600;700&family=Material+Symbols+Rounded:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/tailwind.output.css">
  <!-- Include API and Data Sync Services -->
  <script src="../shared/js/data-sync.js"></script>
  <script src="../shared/js/role-based-access.js"></script>
  <script src="../shared/js/super-admin-data-sync.js"></script>
  <script src="../shared/js/realtime-sync.js"></script>
  <script src="../admin/js/admin-api.js"></script>
  <style>
    :root {
      --color-primary-blue: #2563EB;
      --color-accent-teal: #14B8A6;
      --color-text-white: #FFFFFF;
      --color-subtle-blue: #EFF6FF;
      --font-primary: 'Glacial Indifference', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: #0a0a0a;
      color: var(--color-text-white);
      font-family: 'Glacial Indifference', sans-serif;
      line-height: 1.5;
      min-height: 100vh;
      position: relative;
      background-image: 
        linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
    }

    /* Custom scrollbar styles */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* Firefox scrollbar */
    * {
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.2) rgba(255, 255, 255, 0.05);
    }

    /* Fallback for browsers that don't support scrollbar styling */
    *::-webkit-scrollbar {
      width: 8px;
    }
    
    *::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }
    
    *::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }
    
    *::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .dashboard-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 280px;
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      text-align: center;
    }

    .sidebar-title {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      color: var(--color-accent-teal);
    }

    .sidebar-menu {
      flex: 1;
      padding: 1rem 0;
      overflow-y: auto;
    }

    .menu-section {
      margin-bottom: 2rem;
    }

    .menu-title {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      opacity: 0.6;
      padding: 0 1.5rem;
      margin-bottom: 0.5rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      color: var(--color-text-white);
      text-decoration: none;
      transition: all 0.3s ease;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .menu-item:hover {
      background: rgba(255, 255, 255, 0.1);
      opacity: 1;
    }

    .menu-item.active {
      background: rgba(20, 184, 166, 0.2);
      border-left: 3px solid var(--color-accent-teal);
      opacity: 1;
    }

    .menu-icon {
      font-size: 1.25rem;
      color: var(--color-accent-teal);
    }

    .sidebar-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Main Content Area */
    .main-content {
      flex: 1;
      margin-left: 280px;
      display: flex;
      flex-direction: column;
    }

    /* Header Styles */
    .header {
      height: 70px;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      position: sticky;
      top: 0;
      z-index: 999;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .header-logo {
      display: flex;
      align-items: center;
    }

    .header-logo img {
      width: 100px;
      height: 100px;
      object-fit: contain;
    }

    .page-title {
      font-size: 1.5rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .user-menu:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .user-avatar {
      width: 35px;
      height: 35px;
      background: var(--color-accent-teal);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
    }

    .user-info {
      display: flex;
      flex-direction: column;
    }

    .user-name {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .user-role {
      font-size: 0.75rem;
      opacity: 0.8;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .search-container {
      position: relative;
      width: 350px;
    }

    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .search-container .search-input {
      width: 100%;
      padding: 0.75rem 1rem 0.75rem 2.5rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      transition: all 0.3s ease;
    }

    .search-container .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-container .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--color-accent-teal);
      box-shadow: 0 0 0 2px rgba(20, 184, 166, 0.2);
    }

    .search-icon {
      position: absolute;
      left: 0.75rem;
      color: rgba(255, 255, 255, 0.6);
      font-size: 1.2rem;
      pointer-events: none;
    }

    .search-suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      margin-top: 0.5rem;
      max-height: 400px;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .suggestion-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .suggestion-item:last-child {
      border-bottom: none;
    }

    .suggestion-item:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .suggestion-icon {
      width: 40px;
      height: 40px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: var(--color-accent-teal);
    }

    .suggestion-content {
      flex: 1;
    }

    .suggestion-title {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.25rem;
    }

    .suggestion-description {
      font-size: 0.8rem;
      opacity: 0.7;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .suggestion-type {
      padding: 0.25rem 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      text-transform: uppercase;
    }

    /* Content Area */
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }

    /* Page Header */
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .page-actions {
      display: flex;
      gap: 1rem;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-size: 0.9rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
    }

    .btn-primary {
      background: var(--color-accent-teal);
      color: white;
    }

    .btn-primary:hover {
      background: #0d9486;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: var(--color-text-white);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Search and Filters */
    .filters-section {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 2rem;
    }

    .search-bar {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .search-input {
      flex: 1;
      padding: 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.5);
    }

    .date-filters {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .date-input {
      flex: 1;
      padding: 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .date-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.5);
    }

    .filter-tags {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .filter-tag {
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.8rem;
      font-family: 'Glacial Indifference', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .filter-tag:hover,
    .filter-tag.active {
      background: var(--color-accent-teal);
      border-color: var(--color-accent-teal);
    }

    /* Table Styles */
    .table-container {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      overflow: hidden;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
    }

    .data-table th {
      background: rgba(255, 255, 255, 0.05);
      padding: 1rem;
      text-align: left;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .data-table td {
      padding: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .data-table tr:hover {
      background: rgba(255, 255, 255, 0.05);
    }

    .status-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .status-completed {
      background: rgba(16, 185, 129, 0.2);
      color: #10B981;
    }

    .status-pending {
      background: rgba(251, 191, 36, 0.2);
      color: #FCD34D;
    }

    .status-failed {
      background: rgba(244, 76, 76, 0.2);
      color: #FCA5A5;
    }

    .status-refunded {
      background: rgba(139, 92, 246, 0.2);
      color: #C4B5FD;
    }

    .amount {
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .amount-positive {
      color: #10B981;
    }

    .amount-negative {
      color: #FCA5A5;
    }

    .table-actions {
      display: flex;
      gap: 0.5rem;
    }

    .action-btn {
      padding: 0.5rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      color: var(--color-text-white);
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
    }

    .action-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Loading State */
    .loading-state {
      text-align: center;
      padding: 3rem;
      opacity: 0.7;
    }

    .loading-spinner {
      font-size: 2rem;
      margin-bottom: 1rem;
      color: var(--color-accent-teal);
    }

    /* Mobile Responsiveness */
    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      color: var(--color-text-white);
      font-size: 1.5rem;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .header {
        padding: 0 1rem;
      }

      .content {
        padding: 1rem;
      }

      .page-header {
        flex-direction: column;
        gap: 1rem;
        align-items: flex-start;
      }

      .search-bar,
      .date-filters {
        flex-direction: column;
      }

      .table-container {
        overflow-x: auto;
      }
    }
  </style>

    <!-- Backend Integration Libraries -->
    <script src="../../js/api-client.js"></script>
    <script src="../../js/auth-manager.js"></script>
    <script src="../shared/js/backend-integration-helper.js"></script>
    <script src="../shared/js/page-integration-template.js"></script>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" :class="{ 'open': mobileMenuOpen }">
      <div class="sidebar-header">
        <div class="sidebar-title">Umi Admin</div>
      </div>
      
      <nav class="sidebar-menu">
        <div class="menu-section">
          <div class="menu-title">Main</div>
          <a href="home.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">dashboard</span>
            Home
          </a>
          <a href="pharmacies.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">store</span>
            Pharmacies
          </a>
          <a href="users.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">people</span>
            Users
          </a>
          <a href="transactions.html" class="menu-item active">
            <span class="material-symbols-rounded menu-icon">receipt_long</span>
            Transactions
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Management</div>
          <a href="analytics.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">analytics</span>
            Analytics
          </a>
          <a href="reports.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">assessment</span>
            Reports
          </a>
          <a href="settings.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">account_circle</span>
            Account
          </a>
          <a href="security.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">security</span>
            Security
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Support</div>
          <a href="help.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">help_center</span>
            Help Center
          </a>
          <a href="logs.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">history</span>
            System Logs
          </a>
        </div>
      </nav>
      
      <div class="sidebar-footer">
        <a href="../../public/signin.html" class="menu-item" @click.prevent="handleLogout">
          <span class="material-symbols-rounded menu-icon">logout</span>
          Sign Out
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen">
            <span class="material-symbols-rounded">menu</span>
          </button>
          <div class="header-logo">
            <!-- Logo removed per request -->
          </div>
          <h1 class="page-title">Transaction History</h1>
        </div>
        
        <div class="header-right">
          <div class="search-container" x-data="searchComponent()">
            <div class="search-input-wrapper">
              <input 
                type="text" 
                class="search-input" 
                placeholder="Search pharmacies, users, transactions..."
                x-model="query"
                @input="handleSearch"
                @focus="showSuggestions = true"
                @blur="hideSuggestions"
              >
              <span class="material-symbols-rounded search-icon">search</span>
            </div>
            
            <!-- Search Suggestions Dropdown -->
            <div 
              class="search-suggestions" 
              x-show="showSuggestions && suggestions.length > 0"
              x-transition
            >
              <template x-for="suggestion in suggestions" :key="suggestion.id">
                <div class="suggestion-item" @click="selectSuggestion(suggestion)">
                  <div class="suggestion-icon">
                    <span class="material-symbols-rounded" x-text="suggestion.icon"></span>
                  </div>
                  <div class="suggestion-content">
                    <div class="suggestion-title" x-text="suggestion.title"></div>
                    <div class="suggestion-description" x-text="suggestion.description"></div>
                  </div>
                  <div class="suggestion-type" x-text="suggestion.type"></div>
                </div>
              </template>
            </div>
          </div>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content">
        <!-- Page Header -->
        <div class="page-header">
          <div>
            <h2 class="page-title">Transaction History</h2>
            <p style="opacity: 0.8; margin-top: 0.5rem;">View and manage all transactions across the UmiHealthInformationSystems platform</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary" @click="exportTransactions">
              <span class="material-symbols-rounded">download</span>
              Export
            </button>
            <button class="btn btn-primary" @click="generateReport">
              <span class="material-symbols-rounded">summarize</span>
              Generate Report
            </button>
          </div>
        </div>

        <!-- Search and Filters -->
        <div class="filters-section">
          <div class="search-bar">
            <input 
              type="text" 
              class="search-input" 
              placeholder="Search transactions by ID, pharmacy, or patient..."
              x-model="searchQuery"
              @input="filterTransactions"
            >
            <button class="btn btn-secondary" @click="resetFilters">
              <span class="material-symbols-rounded">refresh</span>
              Reset
            </button>
          </div>
          
          <div class="date-filters">
            <input 
              type="date" 
              class="date-input" 
              placeholder="Start Date"
              x-model="startDate"
              @change="filterTransactions"
            >
            <input 
              type="date" 
              class="date-input" 
              placeholder="End Date"
              x-model="endDate"
              @change="filterTransactions"
            >
          </div>
          
          <div class="filter-tags">
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'all' }"
              @click="setFilter('all')"
            >
              All Transactions
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'completed' }"
              @click="setFilter('completed')"
            >
              Completed
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'pending' }"
              @click="setFilter('pending')"
            >
              Pending
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'failed' }"
              @click="setFilter('failed')"
            >
              Failed
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'refunded' }"
              @click="setFilter('refunded')"
            >
              Refunded
            </div>
          </div>
        </div>

        <!-- Transactions Table -->
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>Transaction ID</th>
                <th>Date & Time</th>
                <th>Pharmacy</th>
                <th>Patient</th>
                <th>Type</th>
                <th>Amount</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <!-- Loading State -->
              <tr x-show="loading">
                <td colspan="8">
                  <div class="loading-state">
                    <div class="loading-spinner">
                      <span class="material-symbols-rounded">refresh</span>
                    </div>
                    <div>Loading transactions...</div>
                  </div>
                </td>
              </tr>
              
              <!-- Empty State -->
              <tr x-show="!loading && filteredTransactions.length === 0">
                <td colspan="8">
                  <div class="loading-state">
                    <div style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;">
                      <span class="material-symbols-rounded">receipt_long</span>
                    </div>
                    <div>No transactions found</div>
                    <div style="font-size: 0.9rem; opacity: 0.6; margin-top: 0.5rem;">
                      Try adjusting your search or filters
                    </div>
                  </div>
                </td>
              </tr>
              
              <!-- Transaction Rows -->
              <template x-for="transaction in filteredTransactions" :key="transaction.id">
                <tr>
                  <td>
                    <div style="font-weight: 600; font-family: monospace;" x-text="transaction.id"></div>
                  </td>
                  <td>
                    <div>
                      <div x-text="transaction.date"></div>
                      <div style="font-size: 0.8rem; opacity: 0.7;" x-text="transaction.time"></div>
                    </div>
                  </td>
                  <td x-text="transaction.pharmacy"></td>
                  <td>
                    <div>
                      <div x-text="transaction.patient"></div>
                      <div style="font-size: 0.8rem; opacity: 0.7;" x-text="transaction.patientPhone"></div>
                    </div>
                  </td>
                  <td x-text="transaction.type"></td>
                  <td>
                    <div class="amount" :class="transaction.amount > 0 ? 'amount-positive' : 'amount-negative'" x-text="formatAmount(transaction.amount)"></div>
                  </td>
                  <td>
                    <span class="status-badge" :class="`status-${transaction.status}`" x-text="transaction.status"></span>
                  </td>
                  <td>
                    <div class="table-actions">
                      <button class="action-btn" @click="viewTransaction(transaction)" title="View Details">
                        <span class="material-symbols-rounded">visibility</span>
                      </button>
                      <button class="action-btn" @click="downloadReceipt(transaction)" title="Download Receipt">
                        <span class="material-symbols-rounded">download</span>
                      </button>
                      <button class="action-btn" @click="processRefund(transaction)" title="Process Refund" x-show="transaction.status === 'completed'">
                        <span class="material-symbols-rounded">refund</span>
                      </button>
                    </div>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>

  <script>
    function searchComponent() {
      return {
        // Initialize backend integration
        const pageIntegration = new PageIntegrationTemplate('super-admin-transactions', {
            requireAuth: true,
            enableRealTime: false,
            enableCaching: true
        });
        
        return {
            ...pageIntegration,
            backendHelper: window.backendHelper,
            apiClient: window.apiClient,
            authManager: window.authManager,
            isAuthenticated: false,
            loading: false,
            error: null,
        query: '',
        showSuggestions: false,
        suggestions: [],
        allSuggestions: [
          { id: 1, title: 'Pharmacies', description: 'Manage pharmacy tenants', type: 'page', icon: 'store', url: 'pharmacies.html' },
          { id: 2, title: 'Users', description: 'User management', type: 'page', icon: 'people', url: 'users.html' },
          { id: 3, title: 'Transactions', description: 'Transaction history', type: 'page', icon: 'receipt_long', url: 'transactions.html' },
          { id: 4, title: 'Analytics', description: 'System analytics', type: 'page', icon: 'analytics', url: 'analytics.html' },
          { id: 5, title: 'Reports', description: 'Reports & insights', type: 'page', icon: 'assessment', url: 'reports.html' },
          { id: 6, title: 'Security', description: 'Security center', type: 'page', icon: 'security', url: 'security.html' },
          { id: 7, title: 'Settings', description: 'Account & system settings', type: 'page', icon: 'settings', url: 'settings.html' },
          { id: 8, title: 'Help Center', description: 'Support and documentation', type: 'page', icon: 'help_center', url: 'help.html' },
          { id: 9, title: 'System Logs', description: 'System activity logs', type: 'page', icon: 'history', url: 'logs.html' }
        ],

        handleSearch() {
          const q = (this.query || '').trim().toLowerCase();
          if (q.length < 2) {
            this.suggestions = [];
            return;
          }

          this.suggestions = this.allSuggestions
            .filter(s =>
              (s.title && s.title.toLowerCase().includes(q)) ||
              (s.description && s.description.toLowerCase().includes(q)) ||
              (s.type && s.type.toLowerCase().includes(q))
            )
            .slice(0, 8);
        },

        selectSuggestion(suggestion) {
          this.query = suggestion.title;
          this.showSuggestions = false;
          if (suggestion && suggestion.url) {
            window.location.href = suggestion.url;
          }
        },

        hideSuggestions() {
          setTimeout(() => {
            this.showSuggestions = false;
          }, 200);
        }
      }
    }

    function transactions() {
      return {
        userName: '',
        userEmail: '',
        mobileMenuOpen: false,
        showUserMenu: false,
        loading: true,
        searchQuery: '',
        startDate: '',
        endDate: '',
        activeFilter: 'all',
        transactions: [],
        filteredTransactions: [],

        async init() {
            try {
                // Check authentication
                this.isAuthenticated = this.authManager?.isAuthenticated() || false;
                
                if (!this.isAuthenticated) {
                    this.error = 'Please login to access this page';
                    return;
                }
                
                // Initialize backend integration
                await this.backendHelper.initPage('super-admin-transactions', {
                    enableRealTime: false,
                    initialData: this.getInitialDataConfig()
                });
                
                // Load page data
                await this.loadPageData();
                
                // Set up event listeners
                this.setupEventListeners();
                
                console.log('super-admin-transactions page initialized with backend integration');
            } catch (error) {
                console.error('Failed to initialize super-admin-transactions page:', error);
                this.error = 'Failed to initialize page';
            }
        },
          
          // Load transactions
          this.loadTransactions();
          
          // Set up real-time updates
          window.superAdminDataSync.subscribe('/transactions', (data) => {
            this.loadTransactions();
          });
          
          // Set up event listeners
          window.superAdminDataSync.addEventListener('error', (message) => {
            this.showError(message);
          });
          
          window.superAdminDataSync.addEventListener('success', (message) => {
            this.showSuccess(message);
          });
          
          // Close mobile menu when clicking outside
          document.addEventListener('click', (e) => {
            if (!e.target.closest('.sidebar') && !e.target.closest('.mobile-menu-toggle')) {
              this.mobileMenuOpen = false;
            }
            if (!e.target.closest('.user-menu')) {
              this.showUserMenu = false;
            }
          });
        },

        async loadTransactions() {
          this.loading = true;
          try {
            console.log('Fetching transactions from super admin API...');
            
            // Use the super admin data sync service
            const response = await window.superAdminDataSync.request('/transactions');
            
            this.transactions = response.data || [];
            this.filteredTransactions = [...this.transactions];
            
            console.log(`Loaded ${this.transactions.length} transactions`);
            
          } catch (error) {
            console.error('Failed to load transactions:', error);
            this.transactions = [];
            this.filteredTransactions = [];
            window.superAdminDataSync.notifyError('Failed to load transactions');
          } finally {
            this.loading = false;
          }
        },

        filterTransactions() {
          let filtered = [...this.transactions];
          
          // Apply search filter
          if (this.searchQuery) {
            const query = this.searchQuery.toLowerCase();
            filtered = filtered.filter(transaction => 
              transaction.id.toLowerCase().includes(query) ||
              transaction.pharmacy.toLowerCase().includes(query) ||
              transaction.patient.toLowerCase().includes(query) ||
              transaction.patientPhone.toLowerCase().includes(query)
            );
          }
          
          // Apply date filter
          if (this.startDate) {
            filtered = filtered.filter(transaction => 
              new Date(transaction.date) >= new Date(this.startDate)
            );
          }
          
          if (this.endDate) {
            filtered = filtered.filter(transaction => 
              new Date(transaction.date) <= new Date(this.endDate)
            );
          }
          
          // Apply status filter
          if (this.activeFilter !== 'all') {
            filtered = filtered.filter(transaction => transaction.status === this.activeFilter);
          }
          
          this.filteredTransactions = filtered;
        },

        setFilter(filter) {
          this.activeFilter = filter;
          this.filterTransactions();
        },

        resetFilters() {
          this.searchQuery = '';
          this.startDate = '';
          this.endDate = '';
          this.activeFilter = 'all';
          this.filterTransactions();
        },

        formatAmount(amount) {
          return new Intl.NumberFormat('en-ZM', {
            style: 'currency',
            currency: 'ZMW'
          }).format(amount);
        },

        viewTransaction(transaction) {
          console.log('Viewing transaction:', transaction);
          // This would open a modal with transaction details
          alert(`Viewing transaction ${transaction.id} details`);
        },

        downloadReceipt(transaction) {
          console.log('Downloading receipt for:', transaction);
          // This would generate and download a PDF receipt
          alert(`Downloading receipt for transaction ${transaction.id}`);
        },

        processRefund(transaction) {
          if (confirm(`Are you sure you want to process a refund for transaction ${transaction.id}?`)) {
            console.log(`Processing refund for: ${transaction.id}`);
            // This would make an API call to process the refund
            alert(`Refund processed for transaction ${transaction.id}`);
          }
        },

        exportTransactions() {
          console.log('Exporting transaction data...');
          // This would generate and download a CSV/Excel file
          alert('Export feature coming soon!');
        },

        generateReport() {
          console.log('Generating transaction report...');
          // This would generate a comprehensive report
          alert('Report generation feature coming soon!');
        },

        handleLogout() {
          if (confirm('Are you sure you want to sign out?')) {
            // Clear session
            sessionStorage.clear();
            
            // Redirect to signin
            window.location.href = '../../public/signin.html';
          }
        }
      }
    }
  </script>

  <!-- Include API and Data Sync Services -->
  <script src="../shared/js/data-sync.js"></script>
  <script src="../shared/js/role-based-access.js"></script>
  <script src="../shared/js/super-admin-data-sync.js"></script>
  <script src="../admin/js/admin-api.js"></script>
  <script src="js/super-admin-api.js"></script>

  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script></body>
</html>




<!DOCTYPE html>
<html lang="en" x-data="users()">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>User Management | UmiHealthInformationSystems Pharmacy Management</title>
  <link rel="icon" href="../../logo.png" type="image/png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Glacial+Indifference:wght@400;500;600;700&family=Material+Symbols+Rounded:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/tailwind.output.css">
  <link rel="stylesheet" href="../../assets/css/inline-fixes.css">
  <!-- Include API and Data Sync Services -->
  <script src="../shared/js/data-sync.js"></script>
  <script src="../shared/js/role-based-access.js"></script>
  <script src="../shared/js/super-admin-data-sync.js"></script>
  <script src="../shared/js/realtime-sync.js"></script>
  <script src="../admin/js/admin-api.js"></script>
  <style>
    :root {
      --color-primary-blue: #2563EB;
      --color-accent-teal: #14B8A6;
      --color-text-white: #FFFFFF;
      --color-subtle-blue: #EFF6FF;
      --font-primary: 'Glacial Indifference', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: #0a0a0a;
      color: var(--color-text-white);
      font-family: 'Glacial Indifference', sans-serif;
      line-height: 1.5;
      min-height: 100vh;
      position: relative;
      background-image: 
        linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
    }

    /* Custom scrollbar styles */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    /* Firefox scrollbar: removed non-portable properties to improve cross-browser compatibility */

    .dashboard-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 280px;
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      flex-direction: column;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .logo-icon img {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      object-fit: contain;
    }

    .sidebar-title {
      font-size: 1.2rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      color: var(--color-accent-teal);
    }

    .sidebar-menu {
      flex: 1;
      padding: 1rem 0;
      overflow-y: auto;
    }

    .menu-section {
      margin-bottom: 2rem;
    }

    .menu-title {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      opacity: 0.6;
      padding: 0 1.5rem;
      margin-bottom: 0.5rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      color: var(--color-text-white);
      text-decoration: none;
      transition: all 0.3s ease;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .menu-item:hover {
      background: rgba(255, 255, 255, 0.1);
      opacity: 1;
    }

    .menu-item.active {
      background: rgba(20, 184, 166, 0.2);
      border-left: 3px solid var(--color-accent-teal);
      opacity: 1;
    }

    .menu-icon {
      font-size: 1.25rem;
      color: var(--color-accent-teal);
    }

    .sidebar-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* Main Content Area */
    .main-content {
      flex: 1;
      margin-left: 280px;
      display: flex;
      flex-direction: column;
    }

    /* Header Styles */
    .header {
      height: 70px;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      position: sticky;
      top: 0;
      z-index: 999;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 2rem;
    }

    .header-logo {
      display: flex;
      align-items: center;
    }

    .header-logo img {
      width: 100px;
      height: 100px;
      object-fit: contain;
    }

    .header-brand {
      font-size: 1.25rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
      color: var(--color-accent-teal);
    }

    .page-title {
      font-size: 1.5rem;
      font-weight: 700;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .user-menu:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .user-avatar {
      width: 35px;
      height: 35px;
      background: var(--color-accent-teal);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
    }

    .user-info {
      display: flex;
      flex-direction: column;
    }

    .user-name {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .user-role {
      font-size: 0.75rem;
      opacity: 0.8;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .search-container {
      position: relative;
      width: 350px;
    }

    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .search-container .search-input {
      width: 100%;
      padding: 0.75rem 1rem 0.75rem 2.5rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      transition: all 0.3s ease;
    }

    .search-container .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-container .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--color-accent-teal);
      box-shadow: 0 0 0 2px rgba(20, 184, 166, 0.2);
    }

    .search-icon {
      position: absolute;
      left: 0.75rem;
      color: rgba(255, 255, 255, 0.6);
      font-size: 1.2rem;
      pointer-events: none;
    }

    .search-suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(10, 10, 10, 0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      margin-top: 0.5rem;
      max-height: 400px;
      overflow-y: auto;
      z-index: 1000;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }

    .suggestion-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .suggestion-item:last-child {
      border-bottom: none;
    }

    .suggestion-item:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .suggestion-icon {
      width: 40px;
      height: 40px;
      background: rgba(20, 184, 166, 0.2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: var(--color-accent-teal);
    }

    .suggestion-content {
      flex: 1;
    }

    .suggestion-title {
      font-weight: 600;
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
      margin-bottom: 0.25rem;
    }

    .suggestion-description {
      font-size: 0.8rem;
      opacity: 0.7;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .suggestion-type {
      padding: 0.25rem 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      text-transform: uppercase;
    }

    /* Content Area */
    .content {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
    }

    /* Page Header */
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .page-actions {
      display: flex;
      gap: 1rem;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-size: 0.9rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
    }

    .btn-primary {
      background: var(--color-accent-teal);
      color: white;
    }

    .btn-primary:hover {
      background: #0d9486;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: var(--color-text-white);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Search and Filters */
    .filters-section {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 2rem;
    }

    .search-bar {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .search-input {
      flex: 1;
      padding: 0.75rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 12px;
      color: var(--color-text-white);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .search-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
    }

    .search-input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.5);
    }

    .filter-tags {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .filter-tag {
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      font-size: 0.8rem;
      font-family: 'Glacial Indifference', sans-serif;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .filter-tag:hover,
    .filter-tag.active {
      background: var(--color-accent-teal);
      border-color: var(--color-accent-teal);
    }

    /* Table Styles */
    .table-container {
      background: rgba(255, 255, 255, 0.1);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      overflow: hidden;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
    }

    .data-table th {
      background: rgba(255, 255, 255, 0.05);
      padding: 1rem;
      text-align: left;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 0.9rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .data-table td {
      padding: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      font-size: 0.9rem;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .data-table tr:hover {
      background: rgba(255, 255, 255, 0.05);
    }

    .role-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .role-admin {
      background: rgba(239, 68, 68, 0.2);
      color: #FCA5A5;
    }

    .role-manager {
      background: rgba(59, 130, 246, 0.2);
      color: #93C5FD;
    }

    .role-pharmacist {
      background: rgba(34, 197, 94, 0.2);
      color: #86EFAC;
    }

    .role-cashier {
      background: rgba(251, 191, 36, 0.2);
      color: #FCD34D;
    }

    .status-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .status-active {
      background: rgba(16, 185, 129, 0.2);
      color: #10B981;
    }

    .status-inactive {
      background: rgba(244, 76, 76, 0.2);
      color: #FCA5A5;
    }

    .table-actions {
      display: flex;
      gap: 0.5rem;
    }

    .action-btn {
      padding: 0.5rem;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      color: var(--color-text-white);
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
    }

    .action-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Loading State */
    .loading-state {
      text-align: center;
      padding: 3rem;
      opacity: 0.7;
    }

    .loading-spinner {
      font-size: 2rem;
      margin-bottom: 1rem;
      color: var(--color-accent-teal);
    }

    /* Mobile Responsiveness */
    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      color: var(--color-text-white);
      font-size: 1.5rem;
      cursor: pointer;
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .header {
        padding: 0 1rem;
      }

      .content {
        padding: 1rem;
      }

      .page-header {
        flex-direction: column;
        gap: 1rem;
        align-items: flex-start;
      }

      .search-bar {
        flex-direction: column;
      }

      .table-container {
        overflow-x: auto;
      }
    }
  </style>

    <!-- Backend Integration Libraries -->
    <script src="../../js/api-client.js"></script>
    <script src="../../js/auth-manager.js"></script>
    <script src="../shared/js/backend-integration-helper.js"></script>
    <script src="../shared/js/page-integration-template.js"></script>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar" :class="{ 'open': mobileMenuOpen }">
      <div class="sidebar-header">
        <div class="logo-section">
          <div class="logo-icon">
            <img src="../../umi.png" alt="Umi Health Logo">
          </div>
          <div class="sidebar-title">Umi Admin</div>
        </div>
      </div>
      
      <nav class="sidebar-menu">
        <div class="menu-section">
          <div class="menu-title">Main</div>
          <a href="home.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">dashboard</span>
            Home
          </a>
          <a href="pharmacies.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">store</span>
            Pharmacies
          </a>
          <a href="users.html" class="menu-item active">
            <span class="material-symbols-rounded menu-icon">people</span>
            Users
          </a>
          <a href="transactions.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">receipt_long</span>
            Transactions
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Management</div>
          <a href="analytics.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">analytics</span>
            Analytics
          </a>
          <a href="reports.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">assessment</span>
            Reports
          </a>
          <a href="settings.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">account_circle</span>
            Account
          </a>
          <a href="security.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">security</span>
            Security
          </a>
        </div>
        
        <div class="menu-section">
          <div class="menu-title">Support</div>
          <a href="help.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">help_center</span>
            Help Center
          </a>
          <a href="logs.html" class="menu-item">
            <span class="material-symbols-rounded menu-icon">history</span>
            System Logs
          </a>
        </div>
      </nav>
      
      <div class="sidebar-footer">
        <a href="../../public/signin.html" class="menu-item" @click.prevent="handleLogout">
          <span class="material-symbols-rounded menu-icon">logout</span>
          Sign Out
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <button class="mobile-menu-toggle" @click="mobileMenuOpen = !mobileMenuOpen">
            <span class="material-symbols-rounded">menu</span>
          </button>
          <div class="header-logo">
            <!-- Logo removed per request -->
          </div>
          <h1 class="page-title">User Management</h1>
        </div>
        
        <div class="header-right">
          <div class="search-container" x-data="searchComponent()">
            <div class="search-input-wrapper">
              <input 
                type="text" 
                class="search-input" 
                placeholder="Search pharmacies, users, transactions..."
                x-model="query"
                @input="handleSearch"
                @focus="showSuggestions = true"
                @blur="hideSuggestions"
              >
              <span class="material-symbols-rounded search-icon">search</span>
            </div>
            
            <!-- Search Suggestions Dropdown -->
            <div 
              class="search-suggestions" 
              x-show="showSuggestions && suggestions.length > 0"
              x-transition
            >
              <template x-for="suggestion in suggestions" :key="suggestion.id">
                <div class="suggestion-item" @click="selectSuggestion(suggestion)">
                  <div class="suggestion-icon">
                    <span class="material-symbols-rounded" x-text="suggestion.icon"></span>
                  </div>
                  <div class="suggestion-content">
                    <div class="suggestion-title" x-text="suggestion.title"></div>
                    <div class="suggestion-description" x-text="suggestion.description"></div>
                  </div>
                  <div class="suggestion-type" x-text="suggestion.type"></div>
                </div>
              </template>
            </div>
          </div>
        </div>
      </header>

      <!-- Content Area -->
      <div class="content">
        <!-- Page Header -->
        <div class="page-header">
          <div>
            <h2 class="page-title">User Management</h2>
            <p class="muted-sub">Manage all user accounts across the UmiHealthInformationSystems platform</p>
          </div>
          <div class="page-actions">
            <button class="btn btn-secondary" @click="exportUsers">
              <span class="material-symbols-rounded">download</span>
              Export
            </button>
            <button class="btn btn-primary" @click="createUser">
              <span class="material-symbols-rounded">person_add</span>
              Create User
            </button>
          </div>
        </div>

        <!-- Search and Filters -->
        <div class="filters-section">
          <div class="search-bar">
            <input 
              type="text" 
              class="search-input" 
              placeholder="Search users by name, email, or pharmacy..."
              x-model="searchQuery"
              @input="filterUsers"
            >
            <button class="btn btn-secondary" @click="resetFilters">
              <span class="material-symbols-rounded">refresh</span>
              Reset
            </button>
          </div>
          
          <div class="filter-tags">
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'all' }"
              @click="setFilter('all')"
            >
              All Users
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'admin' }"
              @click="setFilter('admin')"
            >
              Admins
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'manager' }"
              @click="setFilter('manager')"
            >
              Managers
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'pharmacist' }"
              @click="setFilter('pharmacist')"
            >
              Pharmacists
            </div>
            <div 
              class="filter-tag" 
              :class="{ 'active': activeFilter === 'cashier' }"
              @click="setFilter('cashier')"
            >
              Cashiers
            </div>
          </div>
        </div>

        <!-- Users Table -->
        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>User</th>
                <th>Role</th>
                <th>Pharmacy</th>
                <th>Contact</th>
                <th>Status</th>
                <th>Last Login</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <!-- Loading State -->
              <tr x-show="loading">
                <td colspan="7">
                  <div class="loading-state">
                    <div class="loading-spinner">
                      <span class="material-symbols-rounded">refresh</span>
                    </div>
                    <div>Loading users...</div>
                  </div>
                </td>
              </tr>
              
              <!-- Empty State -->
              <tr x-show="!loading && filteredUsers.length === 0">
                <td colspan="7">
                  <div class="loading-state">
                    <div class="large-muted">
                      <span class="material-symbols-rounded">people</span>
                    </div>
                    <div>No users found</div>
                    <div class="small-muted">
                      Try adjusting your search or filters
                    </div>
                  </div>
                </td>
              </tr>
              
              <!-- User Rows -->
              <template x-for="user in filteredUsers" :key="user.id">
                <tr>
                  <td>
                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                      <div style="width: 40px; height: 40px; background: rgba(20, 184, 166, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <span class="material-symbols-rounded" style="color: var(--color-accent-teal);">person</span>
                      </div>
                      <div>
                        <div style="font-weight: 600;" x-text="user.name"></div>
                        <div style="font-size: 0.8rem; opacity: 0.7;" x-text="user.email"></div>
                      </div>
                    </div>
                  </td>
                  <td>
                    <span class="role-badge" :class="`role-${user.role}`" x-text="user.role"></span>
                  </td>
                  <td x-text="user.pharmacy"></td>
                  <td>
                    <div>
                      <div x-text="user.phone"></div>
                      <div style="font-size: 0.8rem; opacity: 0.7;" x-text="user.email"></div>
                    </div>
                  </td>
                  <td>
                    <span class="status-badge" :class="`status-${user.status}`" x-text="user.status"></span>
                  </td>
                  <td x-text="user.lastLogin"></td>
                  <td>
                    <div class="table-actions">
                      <button class="action-btn" @click="viewUser(user)" title="View Details">
                        <span class="material-symbols-rounded">visibility</span>
                      </button>
                      <button class="action-btn" @click="editUser(user)" title="Edit">
                        <span class="material-symbols-rounded">edit</span>
                      </button>
                      <button class="action-btn" @click="resetPassword(user)" title="Reset Password">
                        <span class="material-symbols-rounded">lock_reset</span>
                      </button>
                      <button class="action-btn" @click="toggleUserStatus(user)" :title="user.status === 'active' ? 'Deactivate' : 'Activate'">
                        <span class="material-symbols-rounded" x-text="user.status === 'active' ? 'person_off' : 'person'"></span>
                      </button>
                    </div>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>

  <script>
    function searchComponent() {
      return {
        // Initialize backend integration
        init() {
            const pageIntegration = new PageIntegrationTemplate('super-admin-users', {
                requireAuth: true,
                enableRealTime: false,
                enableCaching: true
            });
            
            Object.assign(this, pageIntegration);
            
            this.backendHelper = window.backendHelper;
            this.apiClient = window.apiClient;
            this.authManager = window.authManager;
            this.isAuthenticated = false;
            this.loading = false;
            this.error = null;
            this.query = '';
            this.showSuggestions = false;
            this.suggestions = [];
            this.allSuggestions = [
              { id: 1, title: 'Pharmacies', description: 'Manage pharmacy tenants', type: 'page', icon: 'store', url: 'pharmacies.html' },
              { id: 2, title: 'Users', description: 'User management', type: 'page', icon: 'people', url: 'users.html' },
              { id: 3, title: 'Transactions', description: 'Transaction history', type: 'page', icon: 'receipt_long', url: 'transactions.html' },
              { id: 4, title: 'Analytics', description: 'System analytics', type: 'page', icon: 'analytics', url: 'analytics.html' },
              { id: 5, title: 'Reports', description: 'Reports & insights', type: 'page', icon: 'assessment', url: 'reports.html' },
              { id: 6, title: 'Security', description: 'Security center', type: 'page', icon: 'security', url: 'security.html' },
              { id: 7, title: 'Settings', description: 'Account & system settings', type: 'page', icon: 'settings', url: 'settings.html' },
              { id: 8, title: 'Help Center', description: 'Support and documentation', type: 'page', icon: 'help_center', url: 'help.html' },
              { id: 9, title: 'System Logs', description: 'System activity logs', type: 'page', icon: 'history', url: 'logs.html' }
            ];
        },

        handleSearch() {
          const q = (this.query || '').trim().toLowerCase();
          if (q.length < 2) {
            this.suggestions = [];
            return;
          }

          this.suggestions = this.allSuggestions
            .filter(s =>
              (s.title && s.title.toLowerCase().includes(q)) ||
              (s.description && s.description.toLowerCase().includes(q)) ||
              (s.type && s.type.toLowerCase().includes(q))
            )
            .slice(0, 8);
        },

        selectSuggestion(suggestion) {
          this.query = suggestion.title;
          this.showSuggestions = false;
          if (suggestion && suggestion.url) {
            window.location.href = suggestion.url;
          }
        },

        hideSuggestions() {
          setTimeout(() => {
            this.showSuggestions = false;
          }, 200);
        }
      }
    }

    function users() {
      return {
        userName: '',
        userEmail: '',
        mobileMenuOpen: false,
        showUserMenu: false,
        loading: true,
        searchQuery: '',
        activeFilter: 'all',
        users: [],
        filteredUsers: [],

        async init() {
            try {
                // Check authentication
                this.isAuthenticated = this.authManager?.isAuthenticated() || false;
                
                if (!this.isAuthenticated) {
                    this.error = 'Please login to access this page';
                    return;
                }
                
                // Initialize backend integration
                await this.backendHelper.initPage('super-admin-users', {
                    enableRealTime: false,
                    initialData: this.getInitialDataConfig()
                });
                
                // Load page data
                await this.loadPageData();
                
                // Set up event listeners
                this.setupEventListeners();
                
                console.log('super-admin-users page initialized with backend integration');
            } catch (error) {
                console.error('Failed to initialize super-admin-users page:', error);
                this.error = 'Failed to initialize page';
            }
        },

        async init() {
            try {
                // Check authentication
                this.isAuthenticated = this.authManager?.isAuthenticated() || false;
                
                if (!this.isAuthenticated) {
                    this.error = 'Please login to access this page';
                    return;
                }
                
                // Initialize backend integration
                await this.backendHelper.initPage('super-admin-users', {
                    enableRealTime: false,
                    initialData: this.getInitialDataConfig()
                });
                
                // Load page data
                await this.loadPageData();
                
                // Set up event listeners
                this.setupEventListeners();
                
                console.log('super-admin-users page initialized with backend integration');
            } catch (error) {
                console.error('Failed to initialize super-admin-users page:', error);
                this.error = 'Failed to initialize page';
            }
            
            // Load users
            this.loadUsers();
            
            // Set up real-time updates
            window.superAdminDataSync.subscribe('/users', (data) => {
                this.loadUsers();
            });
            
            // Check for create action in URL
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('action') === 'create') {
                this.createUser();
            }
            
            // Set up event listeners
            window.superAdminDataSync.addEventListener('error', (message) => {
                this.showError(message);
            });
            
            window.superAdminDataSync.addEventListener('success', (message) => {
                this.showSuccess(message);
            });
            
            // Close mobile menu when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.sidebar') && !e.target.closest('.mobile-menu-toggle')) {
                    this.mobileMenuOpen = false;
                }
                if (!e.target.closest('.user-menu')) {
                    this.showUserMenu = false;
                }
            });
        },

        async loadUsers() {
          this.loading = true;
          try {
            const data = await window.superAdminDataSync.getSuperAdminUsers(1, 50, this.searchQuery);
            this.users = data.data || [];
            this.filteredUsers = this.users;
            console.log(`Loaded ${this.users.length} users`);
          } catch (error) {
            console.error('Failed to load users:', error);
            window.superAdminDataSync.notifyError('Failed to load users');
            this.users = [];
            this.filteredUsers = [];
          } finally {
            this.loading = false;
          }
        },

        // User management methods
        async createUser() {
          const userData = {
            email: prompt('Enter user email:'),
            password: prompt('Enter temporary password:'),
            firstName: prompt('Enter first name:'),
            lastName: prompt('Enter last name:'),
            role: 'superadmin'
          };

          if (userData.email && userData.password && userData.firstName && userData.lastName) {
            try {
              await window.superAdminDataSync.createSuperAdminUser(userData);
              this.showSuccess('User created successfully');
              this.loadUsers();
            } catch (error) {
              this.showError('Failed to create user');
            }
          }
        },

        async editUser(userId) {
          try {
            const user = await window.superAdminDataSync.getSuperAdminUserById(userId);
            // Open edit modal or form
            console.log('Edit user:', user);
          } catch (error) {
            this.showError('Failed to load user details');
          }
        },

        async toggleUserStatus(userId) {
          if (confirm('Are you sure you want to toggle this user\'s status?')) {
            try {
              await window.superAdminDataSync.toggleSuperAdminUserStatus(userId);
              this.showSuccess('User status updated');
              this.loadUsers();
            } catch (error) {
              this.showError('Failed to update user status');
            }
          }
        },

        async resetUserPassword(userId) {
          if (confirm('Are you sure you want to reset this user\'s password?')) {
            try {
              const result = await window.superAdminDataSync.resetSuperAdminUserPassword(userId);
              alert(`New password: ${result.password}`);
              this.showSuccess('Password reset successful');
            } catch (error) {
              this.showError('Failed to reset password');
            }
          }
        },

        async deleteUser(userId) {
          if (confirm('Are you sure you want to delete this user? This action cannot be undone.')) {
            try {
              await window.superAdminDataSync.deleteSuperAdminUser(userId);
              this.showSuccess('User deleted successfully');
              this.loadUsers();
            } catch (error) {
              this.showError('Failed to delete user');
            }
          }
        },

        filterUsers() {
          if (this.activeFilter === 'all') {
            this.filteredUsers = this.users;
          } else {
            this.filteredUsers = this.users.filter(user => user.status === this.activeFilter);
          }
        },

        searchUsers() {
          if (this.searchQuery.trim() === '') {
            this.filteredUsers = this.users;
          } else {
            this.filteredUsers = this.users.filter(user => 
              user.firstName.toLowerCase().includes(this.searchQuery.toLowerCase()) ||
              user.lastName.toLowerCase().includes(this.searchQuery.toLowerCase()) ||
              user.email.toLowerCase().includes(this.searchQuery.toLowerCase())
            );
          }
        },

        showError(message) {
          if (window.showToast) {
            window.showToast(message, 'error');
          } else {
            alert(message);
          }
        },

        showSuccess(message) {
          if (window.showToast) {
            window.showToast(message, 'success');
          }
        },

        formatDateTime(dateString) {
          return window.superAdminDataSync.formatDateTime(dateString);
        }
      }
    }
  </script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script></body>
</html>
